{"article_publication_date": "01-26-2011", "fulltext": "\n Vector Addition System Reachability Problem A Short Self-Contained Proof J\u00e9r\u00f4me Leroux LaBRI, Universit\u00e9 \nde Bordeaux, CNRS leroux@labri.fr Abstract The reachability problem for Vector Addition Systems (VASs) \nis a central problem of net theory. The general problem is known de\u00adcidable by algorithms exclusively \nbased on the classical Kosaraju\u00adLambert-Mayr-Sacerdote-Tenney decomposition (KLMTS decom\u00adposition). Recently \nfrom this decomposition, we deduced that a .\u00adnal con.guration is not reachable from an initial one if \nand only if there exists a Presburger inductive invariant that contains the ini\u00adtial con.guration but \nnot the .nal one. Since we can decide if a Preburger formula denotes an inductive invariant, we deduce \nfrom this result that there exist checkable certi.cates of non-reachability in the Presburger arithmetic. \nIn particular, there exists a simple al\u00adgorithm for deciding the general VAS reachability problem based \non two semi-algorithms. A .rst one that tries to prove the reacha\u00adbility by enumerating .nite sequences \nof actions and a second one that tries to prove the non-reachability by enumerating Presburger formulas. \nIn this paper we provide the .rst proof of the VAS reach\u00adability problem that is not based on the KLMST \ndecomposition. The proof is based on the notion of production relations inspired from Hauschildt that \ndirectly provides the existence of Presburger inductive invariants. Categories and Subject Descriptors \nD.2.4 [Software Engineer\u00ading]: Formal methods; D.2.2 [Design Tools and Techniques]: Petri nets General \nTerms Theory, Veri.cation Keywords VAS, Petri, Presburger, Reachability 1. Introduction Vector Addition \nSystems (VASs) or equivalently Petri Nets are one of the most popular formal methods for the representation \nand the analysis of parallel processes [EN94]. The reachability problem is central since many computational \nproblems (even outside the par\u00adallel processes) reduce to the reachability problem. Sacerdote and Tenney \nprovided in [ST77] a partial proof of decidability of this problem. The proof was completed in 1981 by \nMayr [May81] and simpli.ed by Kosaraju [Kos82] from [ST77, May81]. Ten years later [Lam92], Lambert provided \na more simpli.ed version based on [Kos82]. This last proof still remains dif.cult and the upper\u00adbound \ncomplexity of the corresponding algorithm is just known Permission to make digital or hard copies of \nall or part of this work for personal or classroom use is granted without fee provided that copies are \nnot made or distributed for pro.t or commercial advantage and that copies bear this notice and the full \ncitation on the .rst page. To copy otherwise, to republish, to post on servers or to redistribute to \nlists, requires prior speci.c permission and/or a fee. POPL 11, January 26 28, 2011, Austin, Texas, USA. \nCopyright c &#38;#169; 2011 ACM 978-1-4503-0490-0/11/01. . . $10.00 non-primitive recursive. Nowadays, \nthe exact complexity of the reachability problem for VASs is still an open-problem. Even an el\u00adementary \nupper-bound complexity is open. In fact, the known gen\u00aderal reachability algorithms are exclusively based \non the Kosaraju\u00adLambert-Mayr-Sacerdote-Tenney (KLMST) decomposition. Recently [Ler09] we proved thanks \nto the KLMST decomposi\u00adtion that Parikh images of languages accepted by VASs are semi\u00adpseudo-linear, \na class that extends the Presburger sets. An applica\u00adtion of this result was provided; we proved that \na .nal con.gura\u00adtion is not reachable from an initial one if and only if there exists a forward inductive \ninvariant de.nable in the Presburger arithmetic that contains the initial con.guration but not the .nal \none. Since we can decide if a Presburger formula denotes a forward inductive invariant, we deduce that \nthere exist checkable certi.cates of non\u00adreachability in the Presburger arithmetic. In particular, there \nexists a simple algorithm for deciding the general VAS reachability prob\u00adlem based on two semi-algorithms. \nA .rst one that tries to prove the reachability by enumerating .nite sequences of actions and a second \none that tries to prove the non-reachability by enumerating Presburger formulas. In this paper we provide \na new proof of the reachability prob\u00adlem that is not based on the KLMST decomposition. The proof is based \non the production relations inspired by Hauschildt [Hau90] and it provides directly that reachability \nsets are Lambert sets,a class of sets introduced in this paper that extend the class of Pres\u00adburger sets \nand contained in the class of semi-pseudo-linear sets. In particular this paper provides a more precise \ncharacterization of the reachability sets of VASs. Outline of the paper: Section 2 provides notations \nand classical de.nitions. Section 3 and Section 4 introduce classes of sets used in the sequel : polytope \nconic sets and vector spaces in the .rst one and polytope periodic sets, Presburger sets, Lambert sets, \nand Petri sets in the second one. Section 5 and Section 6 show that it suf.cient to prove that the reachability \nrelation of a Vector Addition system is a Petri relation in order to deduce the existence of forward \ninductive invariants de.nable in the Presburger arithmetic proving the non-reachability. In Section 7 \nwe introduce the class of Vector Addition Systems and the central notion of production relations. We \nshow in the next Section 8 that these relations are polytope periodic. In Section 9 we prove that the \nreachability relation of a Vector Addition System is a Petri relation. Finally in Section 10 we combine \nall the previous results to deduce the decidability of the Vector Addition System reachability problem \nbased on Presburger inductive invariants. 2. Notations We introduce in this section notations and classical \nde.nitions used in this paper.  We denote by N, N>0, Z, Q, Q=0, Q>0 the set of natural num\u00adbers, positive \nintegers, integers, rational numbers, non negative ra\u00adtional numbers, and positive rational numbers. \nVectors and sets of vectors are denoted in bold face. The ith component of a vector v . Qd is denoted \nby v(i). We introduce ||v||8 = max1=i=d |v(i)|where |v(i)| is the absolute value of v(i). The total order \n= over Q is extended component-wise into an order = over the set of vectors Qd. The addition function \n+ is also extended component-wise over Qd. Given two sets V1, V2 . Qd we denote by V1 + V2 the set {v1 \n+ v2 | (v1, v2) . V1 \u00d7 V2}, and we denote by V1 - V2 the set {v1 - v2 | (v1, v2) . V1 \u00d7 V2}. In the same \nway given T . Q and V . Qd we let T V = {tv | (t, v) . T \u00d7 V}. We also denote by v1 + V2 and V1 + v2 \nthe sets {v1} + V2 and V1 +{v2}, and we denote by tV and T v the sets {t}V and T {v}. In the sequel, \nan empty sum of sets included in Qd denotes the set reduced to the zero vector {0}. A (binary) relation \nR over Qd is a subset R . Qd \u00d7 Qd. The composition of two relations R and S is the relation denoted by \nR . S and de.ned as usual by the following equality: [n o R . S =(x, z) . Qd \u00d7 Qd | (x, y) . R . (y, \nz) . S y.Qd The re.exive and transitive closure of a relation R is denoted by R *. In this paper, notions \nintroduced over the sets are transposed over the relations by identifying Qd \u00d7 Qd with Q2d . An order \nc over a set S is said to be well if for every sequence (sn)n.N of elements sn . S we can extract a sub-sequence \nthat is non-decreasing for c, i.e. there exists a strictly increasing sequence (nk)k.N of natural numbers \nin (N, =) such that (snk )k.N is non decreasing for c.A minimal element of an ordered set (S, c) is an \nelement s . S such that for every t . T the relation t c s implies s = t. Given a set Y . S we denote \nby minc(Y ) the set of minimal elements of the ordered set (Y, c). Let us recall that if (S, c) is well \nordered then X = minc(Y ) is .nite and for every y . Y there exists x . X such that x c y. Let us consider \nan order c over a set S. We introduce the component-wise extension of c over the set of vectors Sd de.ned \nby s c t if s(i) c t(i) for every i .{1,...,d}. Lemma 2.1 (Dickson s Lemma). The ordered set (Sd , c) \nis well for every well ordered set (S, c). Example 2.2. The set (N, =) is well ordered. Hence (Nd , =) \nis also well ordered. The set (Z, =) is not well ordered. 3. Polytope Conic Sets In this section we introduce \nthe polytope conic sets and we provide a characterization of this class based on the vector spaces. A \nconic set is a set C . Qd such that 0 . C, C + C . C and such that Q=0C . C. A conic set C is said to \nbe .nitely generated if there exists a .nite sequence c1,..., ck of vectors cj . C such that C = Q=0c1 \n+ \u00b7\u00b7\u00b7 + Q=0ck. De.nition 3.1. A conic set C is said to be polytope if it is de.nable in FO (Q, +, =, \n0, 1). v Example 3.2. The conic set C = {c . Q2 2c(2)} is =0 | c(1) = not polytope. Example 3.3. The \nconic set C = {(0, 0)}. Q2 >0 is polytope but it is not .nitely generated. A vector space is a set V \n. Qd such that 0 . V, V + V . V and such that QV . V. Let X . Qd. The following set is a vector space \ncalled the vector space generated by X. () k X V = .j xj | k . Nand (.j , xj ) . Q\u00d7 Xj=1 Observe that \nthis vector space is the minimal for the inclusion vec\u00adtor space that contains X. Note that the vector \nspace V generated by a conic set C satis.es the equality V = C - C. Let us recall that every vector space \nV is generated by a .nite set X with at most d vectors. The rank rank(V) of a vector space V is the minimal \nnatural number r .{0,...,d} such that there exists a .nite set X with r vectors that generates V. Note \nthat rank(V) = rank(W) for every vector spaces V . W. Moreover if V is strictly included in W then rank(V) \n< rank(W). The (topological) closure of a set X . Qd is the set X of vectors r . Qd such that for every \nE . Q>0 there exists x . X satisfying ||r - x||8 <E. A set X is said to be closed if X = X. Note that \nX is closed and this set is the minimal for the inclusion closed set that contains X. Let us recall that \na vector space V is closed and the closure of a conic set is a conic set. Since the classical topological \ninterior of a conic set C is empty when the vector space generated by C is not equal to Qd (the conic \nset is degenerated), we introduce the notion of interior of C relatively to the vector space V = C - \nC. More precisely, a vector c . C is said to be in the interior of C if there exists E . Q>0 such that \nc + v . C for every v . C - C satisfying ||v||8 <E. We denote by int(C) the set of interior vectors of \nC. Let us recall that int(C) is non empty for every conic set C, and C1 = C2 if and only if int(C1) = \nint(C2) for every conic sets C1, C2. The following lemma characterizes the .nitely generated cones. It \nproves that .nitely generated conic sets are polytope. Lemma 3.4. Let V . Qd be a vector space. A conic \nset C . V is .nitely generated if and only if there exists a sequence (hj )1=j=k of vectors hj . V\\{0} \nsuch that: () kd \\X C = v . V | hj (i)v(i) = 0 j=1 i=1 Moreover in this case the following equality holds \nif and only if V is the vector space generated by C: () kd \\X int(C)= v . V | hj (i)v(i) > 0 j=1 i=1 \nProof. This is a classical result of duality [Sch87]. Theorem 3.5. A conic set C . Qd is polytope if \nand only if the conic set C n V is .nitely generated for every vector space V . Qd . Proof. Let us .rst \nconsider a polytope conic set C . Qd, let V be a vector space, and let us prove that X is .nitely generated \nwhere X = C n V. Since V is generated by a .nite set, we deduce that V and in particular X are de.nable \nin FO (Q, +, =, 0, 1). Since this logic admits quanti.cation elimination we deduce that there exists \na quanti.er free formula in this logic that denotes X. Hence there exists a .nite sequence (Aj )1=j=k \nof .nite sets Sk Aj . Qd \u00d7{>, =} \u00d7 Qsuch that X = Xj where: j=1 () d \\X Xj = x . Qd | h(i)x(i)#b (h,#,b).Aj \ni=1  We can assume without loss of generality that Xj is non empty. Let us introduce the following set \nRj : () d \\X Rj = x . Qd | h(i)x(i) = 0 (h,#,b).Aj i=1 Lemma 3.4 shows that Rj is .nitely generated. \nIn particular R = Pk j=1 Rj is .nitely generated. Thanks to Lemma 3.4, we deduce that R is closed. We \nare going to prove that X = R. Let us .rst consider x . X. For every n . N we have nx . X since X is \na conic set. Hence there exists j .{1,...,k} such that nx . Xj for an in.nite number of n . N. We deduce \nthat x . Rj . Thus X . R and we have proved that X . R by minimality of the closure of X. For the converse \ninclusion, let r . R. There exists a Pk sequence (rj )1=j=k of vectors rj . Rj such that r = j=1 rj . \nSince Xj is non empty, there exists xj . Xj . As rj . Rj we Pk deduce that xj + Q=0rj . Xj . Hence x \n+ Q=0rj . X Pkj=1 where x = j=1 xj . In particular x + Q=0r . X. We deduce that for every E . Q>0 we \nhave Ex + r . X. Therefore r . X. We have proved the other inclusion. Thus X = R is .nitely generated. \nConversely, we prove by induction over r that the conic sets C . Qd such that rank(C - C) = r and such \nthat the conic set C n V is .nitely generated for every vector space V . Qd are polytope. The case r \n=0 is immediate since in this case C = {0}. Let us assume the induction proved for an integer r . Nand \nlet us consider a conic set C . Qd such that rank(C - C) = r +1 and such that the conic set C n V is \n.nitely generated for every vector space V . Qd. We introduce the vector space W = C - C. Since C = C \nn V with V = Qd, we deduce that C is .nitely generated. Lemma 3.4 shows that there exists a .nite sequence \n(hj )1=j=k of vectors hj . W\\{0} such that the following equality holds: () kd \\X C = x . W | hj (i)x(i) \n= 0 j=1 i=1 Since int(C) = int(C) we get the following equality: () kd \\X int(C)= x . W | hj (i)x(i) \n> 0 j=1 i=1 In particular int(C) is de.nable in FO (Q, +, =, 0, 1). As int(C) . C . C we deduce the following \ndecomposition where Wj = {w . W | Pd hj (i)w(i)=0}: i=1 k [ C = int(C)(C n Wj ) j=1 Observe that hj . \nW\\Wj and in particular Wj is strictly in\u00adcluded in W. Thus rank(Wj ) < rank(W) = r +1. Note that Cj = \nC n Wj is a conic set such that rank(Cj - Cj ) = rank(Wj ) = r and such that Cj n V is a .nitely generated \nconic set for every vector space V. Thus by induction Cj is de.nable in FO (Q, +, =, 0, 1). We deduce \nthat C is polytope. We have proved the induction. 4. Presburger Sets, Lambert Sets, And Petri Sets In \nthis section we introduce the Presburger sets, Lambert Sets, and Petri Sets. A periodic set is a subset \nP . Zd such that 0 . P and such that P + P . P. A periodic set P is said to be .nitely generated if there \nexists a .nite sequence p1,..., pk of vectors pj . P such that P = Np1 +\u00b7\u00b7\u00b7+Npk. A subset S . Zd is called \na Presburger p(2) p(2) = p(1) p(1) Figure 1. A polytope periodic set. set if it can be denoted by a \nformula in the Presburger arithmetic FO (Z, +, =, 0, 1). Let us recall [GS66] that a subset S . Zd is \nPresburger if and only if it is a .nite union of sets b + P where b . Zd and P . Zd is a .nitely generated \nperiodic set. The class of Lambert sets is obtained by weakening the .niteness property of the periodic \nsets P. De.nition 4.1. A periodic set P is said to be polytope if the conic set Q=0P is polytope. Remark \n4.2. Every .nitely generated periodic set P is polytope since in this case Q=0P is a .nitely generated \nconic set and in particular a polytope conic set. v Example 4.3. The periodic set P = {p . N2 | p(1) \n= 2p(2)}is not polytope. N2 p(1) = 2p(2) - 1} is represented in Figure 1. Observe that Q=0P = {0}.{c \n. Q2 >0 | p(2) = p(1)} is a polytope conic set. Thus P is a polytope periodic set. Example 4.4. The periodic \nset P = {p .| p(2) = The following lemma shows that the class of polytope periodic sets is stable by \n.nite intersections. Lemma 4.5. We have (Q=0P1) n (Q=0P2)= Q=0(P1 n P2) for every periodic sets P1, P2 \n. Zd . Proof. Observe that P1 . Q=0P1 and P2 . Q=0P2. Hence P1 n P2 . C where C =(Q=0P1) n (Q=0P2). As \nC is a conic set we deduce that Q=0(P1 nP2) . C. For the converse inclusion. Let c . C. Since c . Q=0P1, \nthere exists .1 . Q=0 such that c . .1P1. Symmetrically there exists .2 . Q=0 such that c . .2P2. Let \nn1,n2 . N>0 such that n1.1 . Nand n2.2 . N. Let n = n1n2 and observe that nc . n2(n1.1)P1 . P1 since \nP1 is a periodic set. Symmetrically nc . P2. We have proved that nc . P1 n P2. Thus c . Q=0(P1 n P2) \nand we get the other inclusion. Lambert sets and Petri sets are central in this paper. De.nition 4.6. \nA Lambert set L . Zd is a .nite union of sets b + P where b . Zd and P . Zd is a polytope periodic set. \nDe.nition 4.7. A Petri set is a subset X . Zd such that X n S is a Lambert set for every Presburger set \nS . Zd . Example 4.8. Let us consider the periodic set P = {(0, 0)}. {(2n , 1) | n . N}. ((1, 2) + N2). \nObserve that Q=0P is the polytope conic set {(0, 0)}. Q2 >0. We deduce that P is a Lambert set. Note \nthat P is not a Petri set since P n (N\u00d7{1})= {(2n , 1) |n . N} is not a Lambert set. The class of Petri \nsets is between the class of Presburger sets and the class of Lambert sets. The previous Example 4.8 \nshows that the class of Petri sets is strictly included in the class of Lambert sets. The strict inclusion \nof the class of Presburger sets into the class of Petri sets will be a direct consequence of a stronger \nresult proved in this paper. In fact the reachability relation of a Vector Addition System is proved \nto be a Petri relation and we know that in general such a relation is not Presburger.  5. Linearizations \nThe linearization of a periodic set P . Zd is the periodic set lin(P) de.ned by the following equality: \nlin(P)=(P - P) n Q=0P Lemma 5.1. The linearization of a polytope periodic set is .nitely generated. Proof. \nLet V be the vector space generated by P and let us in\u00adtroduce the conic set C = Q=0P. Note that Q=0P \n. V and since V is closed we get C . V. As Q=0P is a polytope conic set we deduce that C is .nitely generated. \nHence there exists c1,..., ck . C such that C = Q=0c1 + \u00b7\u00b7\u00b7 + Q=0ck. As cj . C . V = Q=0P - Q=0P, by \nreplacing cj by a vector in N>0cj we can assume that cj . P - P for every j .{1,...,k}. We introduce \nthe following set R: () k X R = r . P - P | r = .j cj .j . Q 0 = .j < 1j=1 We observe that every vector \nr . R satis.es ||r||8 = s where s = Pk ||cj ||8. Hence R . {-s, . . . , s}d and we deduce that j=1 R \nis .nite. Let L be the periodic set generated by the .nite set R . {c1,..., ck}. Since this .nite set \nis included in lin(P) we de\u00adduce that L . lin(P). Let us prove the converse inclusion. Let x . lin(P). \nSince x . C, there exists a sequence (\u00b5j )1=j=k of Pk rational elements \u00b5j . Q=0 such that x = j=1 \u00b5j \ncj . Let us introduce nj . N such that .j = \u00b5j - nj satis.es 0 = .j < 1. Pk Pk Let r = .j cj . As r = \nx - nj cj we get r . P - P. j=1 j=1 Pk Thus r . R. From x = r + j=1 nj cj we get x . L. We have proved \nthat lin(P)= L is .nitely generated. We observe that if the intersection (b1 + P1) n (b2 + P2) is empty \nwhere b1, b2 . Zd and P1, P2 . Zd are two polytope periodic sets then the intersection (b1 +lin(P1))n(b2 \n+lin(P2)) may be non empty. In this section we show that a dimension is strictly decreasing. Let us .rst \nintroduce our de.nition of dimension. The dimen\u00adsion dim(X) of a non-empty set X . Zd is the minimal \ninte\u00adger r .{0,...,d} such that there exists k . N>0, a sequence (bj )1=j=k of vectors bj . Zd, and a \nsequence (Vj )1=j=k of vector spaces Vj . Qd such that rank(Vj ) = r and such that Sk X . j=1 bj + Vj \n. The dimension of the empty set is de.ned by dim(\u00d8)= -1. In the reminder of this section we prove the \nfollowing Theo\u00adrem 5.2. All other results or de.nitions introduced in this section are not used in the \nsequel. Theorem 5.2. Let b1, b2 . Zd and let P1, P2 be two polytope periodic sets such that the intersection \n(b1 + P1) n (b2 + P2) is empty. The intersection X =(b1 + lin(P1)) n (b2 + lin(P2)) satis.es: dim(X) \n< max{dim(b1 + P1), dim(b2 + P2)} We .rst characterize the dimension of a periodic set. Lemma 5.3. Let \nV be the vector space generated by a periodic set P. Then rank(V) = dim(P). Proof. Let P be a periodic \nset and let us .rst prove by induction Sk over k . that P . implies that there exists N>0 j=1 Vj j .{1,...,k} \nsuch that P . Vj for every sequence (Vj )1=j=k of vector spaces Vj . Qd. The case k =1 is immediate. \nAssume the property proved for an integer k . N>0 and let us assume Sk+1 that P . j=1 Vj . If P . Vk+1 \nthe property is proved. So we can assume that there exists p . P\\Vk+1. Let us prove that Sk P . j=1 Vj \n. We consider x . P. Observe that if x . Vk+1 Sk then x . j=1 Vj . So we can assume that x . Vk+1. We \nobserve that p + nx . P for every n . N since the set P is periodic. We deduce that there exists j .{1,...,k \n+1} such that p + nx . Vj . Naturally this integer j depends on n. However, since {1,...,k +1} is .nite \nwhereas N is in.nite, there exists j .{1,...,k +1} and n<n' in N such that p + nx and ' p + nx are both \nin Vj . As Vj is a vector space, we deduce that '' n(p + nx) - n(p + nx) is in Vj . Hence p . Vj . As \np . Vk+1 we deduce that j = k +1. As Vj is a vector space we deduce that ' (p + nx) - (p + nx) . Vj . \nHence x . Vj . We have proved that Sk Sk x . Vj . Thus P . Vj and by induction there exists j=1 j=1 j \n.{1,...,k} such that P . Vj . We have proved the induction. Now, let us prove the lemma. We consider \na periodic set P and we let V be the vector space generated by this set. Since P . V we deduce that dim(P) \n= rank(V). For the converse Sk inclusion, since P is non empty we deduce that P . j=1 bj +Vj where k \n. N>0, bj . Zd and Vj . Qd is a vector space such that rank(Vj ) = dim(P). Let us consider the set J \n= {j . S {1,...,k}| bj . Vj } and let us prove that P . Vj . Let j.J p . P and n . N. Since np . P there \nexists j .{1,...,k}such that np . bj + Vj . Hence there exists j .{1,...,k} ' and n<n' in N such that \nnp and np are both in bj + Vj . ' As Vj is a vector space we deduce that np - np . Vj . Thus p . Vj . \nMoreover as bj . np- Vj . Vj we deduce that j . J. S We have prove the inclusion P . j.J Vj . From the \nprevious paragraph we deduce that there exists j . J such that P . Vj . By minimality of the vector space \ngenerated by P we get V . Vj . Hence rank(V) = rank(Vj ). Since rank(Vj ) = dim(P) we have proved the \ninequality rank(V) = dim(P). Next we prove a separation property. Lemma 5.4. Let C= and C= be two .nitely \ngenerated conic sets that generates the same vector space V and such that the vector space generated \nby C= n C= is strictly included in V. Then there exists a vector h . V\\{0} such that for every # . {=, \n=}, we have: () d X C# . v . V | h(i)v(i)#0 i=1 Proof. Lemma 3.4 shows that there exists two .nite sets \nH=, H= included in V\\{0} such that: () d \\X C# = v . V | h(i)v(i) = 0 h.H# i=1 () d \\X int(C#)= v . V \n| h(i)v(i) > 0 h.H# i=1 Assume by contradiction that the intersection int(C=) n int(C=) is non empty \nand let c be a vector in this set. Observe that there exists E . Q>0 such that c + v . C= n C= for every \nv . V such that ||v||8 <E. We deduce that the vector space generated by C= n C= contains V and we get \na contradiction.  We deduce that the following intersection is empty where H = H= . H= () d \\X v . V \n| h(i)v(i) > 0 h.H i=1 The Farkas s lemma [Sch87] shows that there exists a non- P zero function f : \nH . Q=0 such that h.H f(h)h = 0. Let PP us introduce a = f(h)h and b = f(h)h. h.H= h.H\\H= Assume by contradiction \nthat a = 0. Since a + b = 0 we deduce that b = 0. As f is not the zero function, there exists h . H such \nthat f(h)=0. Note that either h . H= or h . H\\H=. In the .rst case we deduce that int(C=) is empty and \nin the second case we deduce that int(C=) is empty. Since both cases are impossible we get a contradiction. \nThus a = 0. For every c . int(C=) we have Pd Pd a(i)c(i) = 0. Since the set {c . Qd | a(i)c(i) = 0} i=1 \ni=1 is closed we deduce that for every c . int(C=)= C= the same inequality holds. Now let us consider \nc . int(C=). In this case Pd Pd b(i)c(i) = 0. Since a + b = 0 we get a(i)c(i) = 0. i=1 i=1 We deduce \nthat this inequality holds for every c . C=. Remark 5.5. The previous Lemma 5.4 is wrong if we remove \nthe .nitely generated condition on the conic sets C= and C=. In fact v let us consider the conic sets \nC= = {x . Q2 2x(2)} =0 | x(1) = v and C= = {x . Q2 | x(2) = 2x(2)}. Observe that =0 C= n C= = {0}. Hence \nthe vector space generated by the intersection is strictly included in Q2. However there does not exist \na vector a . Q2\\{0} satisfying the separation property required by Lemma 5.4. This problem can be overcome \nby introducing the vector spaces of Rd. We do not introduce this extension to simplify the presentation. \nWe can now provide a proof of Theorem 5.2. We consider two vectors b1, b2 . Zd and two periodic sets \nP1, P2 . Zd such that (b1 + P1) n (b2 + P2)= \u00d8. We introduce the intersection X =(b1 + lin(P1)) n (b2 \n+ lin(P2)). Observe that if X is empty the theorem is proved. So we can assume that there exists a vector \nb in this intersection. Let us denote by V1 and V2 the vector spaces generated by P1 and P2. Lemma 5.3 \nshows that rank(Vj ) = dim(Pj ) and from dim(bj + Pj ) = dim(Pj ) we deduce that dim(bj +Pj ) = rank(Vj \n). As X is included in b+V where V = V1 n V2, we deduce that if V is strictly included in Vj for one \nj .{1, 2} then dim(X) = rank(V) < rank(Vj )= dim(bj + Pj ) and the theorem is proved. So we can assume \nthat V1 = V2 = V. Let us consider the conic sets C1 = Q=0P1 and C2 = Q=0P2. Since P1 and P2 are polytope \nperiodic sets, we deduce that C1 and C2 are .nitely generated conic sets. Note that C1, C2 . V. We introduce \nthe intersection C = C1 n C2. Assume by contradiction that the vector space generated by C is equal to \nV. Let us consider a vector c in the interior of C. The characterization given by Lemma 3.4 shows that \nin this case int(C) = int(C1) n int(C2). Since int(Cj ) = int(Q=0Pj ) we deduce that c . (Q=0P1) n (Q=0P2). \nLemma 4.5 shows that c . Q=0(P1 n P2). By replacing c be a vector in N>0c we can assume that c . P1 n \nP2. Let us prove that there exists k1 . N such that b + k1c . b1 + P1. From b . b1 + lin(P1) we deduce \nthat there exists ' '' p1, p1 . P1 such that b = b1 + p1 - p1. Since -p1 is in the vector space generated \nby C and c is in the interior of C, there exists n1 . N large enough such that n1c +(-p1' ) . C1. Hence \n' ''' there exists n1 . N>0 such that n1n1c - n1p1 . P1. Thus ''' ' n1n1c-p1 . (n1 -1)p1 +P1 . P1. Hence \nb+k1c . b1 + P1 with k1 = n1n1' . Symmetrically we deduce that there exists k2 . N such that b + k2c \n. b2 + P2. We have proved that b +(k1 + k2)c . (b1 + P1) n (b2 + P2) and we get a contradiction since \nthis intersection is supposed to be empty. We deduce that the vector space generated by C is strictly \nincluded in V. Lemma 5.4 shows that there exists a vector h . V\\{0} such that: () d X C1 . v . V | h(i)v(i) \n= 0 i=1 () d X C2 . v . V | h(i)v(i) = 0 i=1 By replacing h by a vector in N>0h we can assume that h \n. Zd . Now let us consider x . X. Since x - b1 . C1 we deduce Pd that i=1 h(i)(x(i) - b1(i)) = 0 and \nsince x - b2 . C2 Pd we deduce that h(i)(x(i) - b2(i)) = 0. We introduce the Pdi=1 Pd integers z1 = h(i)b1(i) \nand z2 = h(i)b2(i). We i=1 i=1 have proved that X can be decomposed into a .nite union of slices S X \n= zz2 =z1 Xz where: () d X Xz = x . X | h(i)x(i)= z i=1 Let us prove that dim(Xz) < rank(V). If Xz is \nempty the relation is immediate. If Xz is non empty let us consider x . Xz and observe that Xz . x + \nW where: () d X W = v . V | a(i)v(i)=0 i=1 Note that h . V\\W. We deduce that W is strictly included in \nV and in particular rank(W) < rank(V). Hence dim(Xz) < rank(V). S From X = zz2 =z1 Xz and dim(Xz) < rank(V) \nfor every z, we deduce that dim(X) < rank(V) and the theorem is proved. 6. Presburger Invariants Given \na relation R over Zd and two sets X, Y . Zd we introduce the forward image postR(X) and the backward \nimage preR(Y) de.ned by the following equalities: (S postR(X)= {y . Zd | (x, y) . R} Sx.X preR(Y)= {x \n. Zd | (x, y) . R} y.Y We say that a set X . Zd is a forward invariant for R if postR(X) . X and we say \nthat a set Y . Zd is a backward invariant for R if preR(Y) . Y. In the reminder of this section we prove \nthe following Theorem 6.1. All other results or de.nitions introduced in this section are not used in \nthe sequel. Theorem 6.1. Let R * be a re.exive and transitive Petri relation over Zd and let X, Y . Zd \nbe two Presburger sets such that R * n (X \u00d7 Y) is empty. There exists a partition of Zd into a Presburger \nforward invariant that contains X and a Presburger backward invariant that contains Y. We .rst prove \nthe following lemma. Lemma 6.2. The sets postR(X) and preR(Y) are Petri sets for every Petri relation \nR . Zd \u00d7 Zd and for every Presburger sets X, Y . Zd Proof. Let us .rst prove that postR(X) is a Petri \nset. We consider a Presburger set S . Zd. Observe that X \u00d7 S is a Presburger relation. Since R is a Petri \nrelation we deduce that R n (X \u00d7 S) is a Lambert relation. Hence this set can be decomposed into a .nite \n Sk union j=1(aj , bj )+Rj with k . N, (aj , bj ) . Zd \u00d7Zd and Rj is a polytope periodic relation. We \ndeduce that postR(X) n S = Sk bj + Pj where Pj = {v . Zd |.(u, v) . Rj }. Since Rj j=1 is a periodic \nrelation we deduce that Pj is a periodic set. Moreover since Q=0Rj is polytope we deduce that Cj = {v \n. Qd |.(u, v) . Q=0Rj } is polytope. Let us prove that Q=0Pj = Cj . By construction we have Pj . Cj . \nSince Cj is conic we deduce that Q=0Pj . Cj . For the converse inclusion let v . Cj . There exists u \n. Qd such that (u, v) . Q=0Rj . Hence there exists . . Q=0 such that (u, v) . .Rj . Let us consider n \n. N>0 such that n.j . N and observe that (nu,nv) . (n.)Rj . Rj since Rj is periodic. Thus nv . Pj and \nwe have proved that v . Q=0Pj . Hence Q=0Pj = Cj is a polytope conic set and we have proved that postR(X) \nn S is a Lambert set for every Presburger set S . Zd. Hence postR(X) is a Petri set. From preR(Y) = postR-1 \n(Y) with R-1 = {(y, x) | (x, y) . R}we deduce that preR(Y) is a Petri set. Now, let us prove Theorem \n6.1. We consider a re.exive and transitive Petri relation R *. We introduce the notion of separators. \nA separator is a couple (X, Y) of Presburger sets such that the in\u00adtersection R * n (X \u00d7 Y) is empty. \nSince R * is re.exive observe that XnY is empty. The Presburger set D = Zd\\(X.Y) is called the domain \nof (X, Y). Let us observe that a separator (X, Y) with an empty domain is a partition of Zd such that \nX is a Presburger forward invariant and Y is a Presburger backward invariant. In par\u00adticular Theorem \n6.1 is obtained thanks to the following Lemma 6.3 with an immediate induction. Lemma 6.3. Let (X0, Y0) \nbe a separator with a non-empty do\u00admain D0. There exists a separator (X, Y) with a domain D such that \nX0 . X, Y0 . Y and dim(D) < dim(D0). Proof. We .rst observe that a couple (X, Y) of Presburger sets is \na separator if and only if postR* (X) n preR* (Y)= \u00d8 if and only if postR* (X) n Y = \u00d8 if and only if \npreR* (Y) n X = \u00d8. Since R * is a Petri relation we deduce that postR* (X0) is a Petri set. As D0 is \na Presburger set, we deduce that postR* (X0) n Sk D0 is a Lambert set. Hence postR* (X0) n D0 = j=1 bj \n+ Pj where bj . Zd and Pj . Zd is a polytope periodic set. We introduce the following Presburger set: \nk [ S = bj + lin(Pj ) j=1 Observe that postR* (X0) n D0 . S. We deduce that the set Y = Y0 . (D0\\S) is \nsuch that postR* (X0) n Y = \u00d8. Hence (X0, Y) is a separator. Symmetrically, since R * is a Petri relation \nwe deduce that preR* (Y) is a Petri set. As D0 is a Presburger set, we deduce that preR* (Y) n D0 is \na Lambert set. Hence preR* (Y) n D0 = S n l=1 cl + Ql where cl . Zd and Ql . Zd is a polytope periodic \nset. We introduce the following Presburger set: n [ T = cl + lin(Ql) l=1 Observe that preR* (Y) n D0 \n. T. We deduce that the set X = X0 . (D0\\T) is such that preR* (Y) n X = \u00d8. Hence (X, Y) is a separator. \nLet us introduce the domain D of (X, Y). We have the follow\u00ading equality where Zj,l =(bj + lin(Pj )) \nn (cl + lin(Ql)): [ D = D0 n ( Zj,l) 1=j=k 1=l=n As (X, Y) is a separator we deduce that postR* (X)npreR* \n(Y) is empty. As bj + Pj . postR* (X0) . postR* (X) and cl + Ql . preR* (Y) we deduce that the intersection \n(bj + Pj ) n (cl + Ql) is empty. Theorem 5.2 shows that dim(Zj,l) < max{dim(bj + Pj ), dim(cl + Ql)}. \nSince bj + Pj . D0 and cl + Ql . D0 we deduce that dim(bj + Pj ) = dim(D0) and dim(cl + Ql) = dim(D0). \nWe have proved that dim(D) < dim(D0). 7. Vector Addition Systems In this section we introduce the Vector \nAddition Systems, the pro\u00adduction relations and a well order over the set of runs of Vector Addition \nSystems. A Vector Addition System (VAS) is a .nite subset A . Zd.A marking is a vector m . Nd. The semantics \nof vector addition systems is obtained by introducing for every word w = a1 ... ak w of vectors aj . \nA the relation -. over the set of markings de.ned w by x -. y if there exists a word . = m0 ... mk of \nmarkings mj . Nd such that (x, y)=(m0, mk) and mj = mj-1 + aj for every j .{1,...,k}. The word . is unique \nand it is called the run from x to y labeled by w. The marking x is called the source of . and it is \ndenoted by src(.), and the marking y is called the target of . and it is denoted by tgt(.). The set of \nruns is denoted by O. The reachability relation is the relation denoted by -* . over the set of markings \nde.ned by x -* . y if there exists a word w . A * w w such that x -. y. In the sequel we often used the \nfact that x -. y w implies x + v -. y + v for every v . Nd . The production relation of a marking m . \nNd is the relation * ** -.m over Nd de.ned by r -s if m + r . m + s. The .m --* production relation of \na run . = m0 ... mk is the relation .. de.ned by the following composition: ** * --.\u00b7\u00b7\u00b7. - ..=.m0 .mk \nThe following Lemma 7.1 shows that -* .. is periodic for every run . as a composition of periodic relations. \nNote that in Section 8 we prove that this periodic relation is polytope. Lemma 7.1. The relation -* is \nperiodic. .m Proof. Let us assume that r1 -* s1 and r2 -* s2. Since .m .m * * r1 -s1 we deduce that r1 \n+ r2 .m s1 + r2. Moreover, .m - * * since r2 -s2 we deduce that r2 + s1 .m s2 + s1. Therefore .m - r1 \n+ r2 -* .m s1 + s2. We introduce a well order over the set of runs based on the following Lemma 7.2 Lemma \n7.2. The following inclusion holds for every run .: ** (src(.), tgt(.))+ -.. .. - Proof. Assume that \n. = m0 ... mk with mj . Nd, and let (r, s) be a couple in the production relation -* ... Since this relation \nis de.ned as a composition, there exists a sequence (vj )0=j=k+1 of vectors vj . Nd satisfying the following \nrelations with v0 = r and vk+1 = s: v0 -* v1 \u00b7\u00b7\u00b7 -* vk+1 .m0 vk .mk  We introduce the vector aj = mj \n- mj-1 for every j . ajaj {1,...,k}. Since mj-1 -. mj we deduce that mj-1 + vj -. mj + vj . Moreover, \nas vj -* vj+1, there exists a word .mj wjwj . A * such that mj + vj - . mj + vj+1. We deduce that the \nfollowing relation holds: w0a1w1...akwk m0 + v0 - --------. mk + vk+1 Therefore (m0, mk)+(v0, vk+1) is \nin the reachability relation. We introduce the order . over the set of runs de.ned by . . . ' if the \nfollowing inclusion holds: (src(. ' ), tgt(. ' ))+ -* . (src(.), tgt(.))+ -* ..l .. In the reminder of \nthis section we prove the following theorem. All other results or de.nitions introduced in this section \nare not used in the sequel. Theorem 7.3. The order . is well. The order . is proved well thanks to the \nHigmann s Lemma. We .rst recall this lemma. Let us consider an order c over a set S. We introduce the \norder c * over the set of words over S de.ned by u c * v where u = s1 ...sk with sj . S if there exists \na sequence (tj )1=j=k with tj . S and sj c tj and a sequence (wj )0=j=k of words wj . S * such that v \n= w0t1w1 ...tkwk. Lemma 7.4 (Higmann s Lemma). The ordered set (S * , c * ) is well for every well ordered \nset (S, c). We associate to every run . = m0 ... mk the word a(.)= (a1, m1) ... (ak, mk) where aj = mj \n- mj-1. Note that a(.) is a word over the alphabet S = A \u00d7 Nd. We introduce the order c ' '' over this \nalphabet by (a, m) c (a , m ' ) if a = a and m = m . Since A is a .nite set and = is a well order over \nNd, we deduce that c is a well order over S. From the Higmann s lemma, the order c * is well over S *. \nWe introduce the well order < over the set of runs de.ned by . < . ' if a(.) c * a(. ' ), src(.) = src(. \n' ) and tgt(.) = tgt(. ' ). The following lemma provides a useful characterization of this order. Lemma \n7.5. Let . = m0 ... mk be a run and let . ' be an\u00adother run. We have . < . ' if and only if there exists \na sequence (vj )0=j=k+1 of vectors in Nd such that . ' = .0 ' .... ' k where .j ' is a run from mj + \nvj to mj + vj+1. Proof. We introduce the sequence (aj )1=j=k de.ned by aj = mj - mj-1. Assume .rst that \n. < . ' . Since a(.) c * a(. ' ) we deduce that a(. ' )= w0(a1, m1' )w1 ... (ak, mk' )wk where wj . S \n* and mj ' = mj . We introduce the sequence (vj )0=j=k+1 de.ned by v0 = src(. ' ) - src(.), vk+1 = tgt(. \n' ) - tgt(.) and vj = mj ' - mj for every j .{1,...,k}. Observe that vj . Nd for every j .{0,...,k +1}. \nWe deduce that . ' can be decomposed into . ' = .0 ' .... ' k where .j ' is the run from mj +vj to mj \n+vj+1 such that a(. ' j )= wj . Conversely let (vj )0=j=k+1 be a sequence of vectors in Nd such that \n. ' = .0 ' .... ' k where . ' j is a run from mj + vj to mj + vj+1. We deduce that we have the following \nequality where mj ' = mj + vj and aj ' . A: ' '''' ''' a(. )= a(.0)(a1, m1)a(.1) ... (ak, mk)a(.k) Observe \nthat aj ' = tgt(. ' j-1) - mj ' =(mj + vj ) - (mj-1 + vj ) and in particular aj ' = aj . We deduce that \na(.) c * a(. ' ). Moreover, since src(.) = src(. ' ) and tgt(.) = tgt(. ' ) we deduce that . < . ' . \nSince < is a well order, the following lemma shows that . is a well order. We have proved Theorem 7.3. \nLemma 7.6. . < . ' implies . . . ' . Proof. Assume that . = m0 ... mk. Lemma 7.5 shows that there exists \na sequence (vj )0=j=k+1 of vectors in Nd such that . ' = . ' 0 .... ' where .j ' is a run from mj + vj \nto mj + vj+1. k ** Lemma 7.2 shows that (src(. ' j ), tgt(. ' -.-.. j ))+ ..l Hence j ** ** -.-. We deduce \nthat (v0, vk+1)+ -- (vj , vj+1)+ ..j l .mj ..l ... by composition. Since (src(. ' ), tgt(. ' )) = (src(.), \ntgt(.)) + (v0, vk+1) we get . . . ' from the previous inclusion. 8. Polytope Production Relations In \nthis section we prove that production relations are polytope (Theorem 8.1). All other results or de.nitions \nintroduced in the section are not used in the sequel. Theorem 8.1. Production relations are polytope. \nThe following lemma shows that polytope periodic relations are stable by composition. In particular it \nis suf.cient to prove that production relations -* are polytope for every marking m . Nd .m in order \nto deduce that production relations -* are polytope for .. every run .. Lemma 8.2. We have Q=0(R1 . R2)=(Q=0R1) \n. (Q=0R2) for every periodic relations over Zd . Proof. We have R1 . Q=0R1 and R2 . Q=0R2. Thus R1 .R2 \n. C where C =(Q=0R1) . (Q=0R2). As C is a conic set we get Q=0(R1 . R2) . C. For the converse inclusion, \nlet us consider (x, z) . C. There exists y . Qd such that (x, y) . Q=0R1 and (y, z) . Q=0R2. There exists \n.1,.2 . Q=0 such that (x, y) . .1R1 and (y, z) . .2R2. We introduce n1,n2 . N>0 such that n1.1 . N and \nn2.2 . N and we deduce that n(x, y) . R1 and n(y, z) . R2 with n = n1n2. Hence n(x, z) . R1 . R2. We \ndeduce that (x, z) . Q=0(R1 . R2). Theorem 3.5 shows that the conic set Q=0 -* is polytope if .m and \nonly if the following conic set is .nitely generated for every vector space V . Qd \u00d7 Qd: (Q=0 -* .m) \nn V We introduce the periodic relation -* de.ned as the inter\u00ad .m,V ** section -nV . Let us observe that \n(Q=0 .m) n V is equal .m - to Q=0 -* So, we just have to prove that the conic set .m,V . Q=0 -* is .nitely \ngenerated for every m . Nd .m,V and for ev\u00adery vector space V . Qd \u00d7 Qd . We introduce the set Om,V of \nruns . such that (src(.), tgt(.))- (m, m) is in (Nd \u00d7 Nd) n V . Note that a couple (r, s) . Nd \u00d7 Nd satis.es \nr -* s if and only if there exists a run . . Om,V such .m,V that src(.)= m + r and tgt(.)= m + s. We \nintroduce the set Qm,V of markings q that occurs in at least one run . . Om,V . In general the set Qm,V \nis in.nite. We consider the set Im,V of i .{1,...,d} such that {q(i) | q . Qm,V } is in.nite. We observe \nthat if i . Im,V there exists a sequence of markings in Qm,V such that the ith component is strictly \nincreasing. We are going to prove that there exists a sequence of markings in Qm,V such that every component \nin Im,V is strictly increasing. This property is proved by introducing the intraproductions. An intraproduction \nfor (m,V ) is a triple (r, x, s) such that x . Nd , (r, s) . (Nd \u00d7 Nd) n V and such that:  r -* -* .m \nx .m s Since -* is a periodic relation we deduce that the set of intrapro\u00ad .m ductions is stable by addition. \nIn particular m + nx occurs in at least one run of Om,V for every intraproduction (r, x, s) and for every \nn . N. Hence, if x(i) > 0 then i . Im,V . An intraproduc\u00adtion for (m,V ) is said to be total if x(i) \n> 0 for every i . Im,V . Lemma 8.3. There exists a total intraproduction for (m,V ). Proof. Since .nite \nsums of intraproductions are intraproductions, it is suf.cient to prove that for every i . Im,V there \nexists an intraproduction (r, x, s) for (m,V ) such that x(i) > 0. We .x i . I. Let us .rst prove that \nthere exists q = q ' in Qm,V such that q(i) < q ' (i). Since i . I there exists a sequence (qn)n.N of \nmarkings qn . Qm,V such that (qn(i))n.N is strictly increasing. Since (Nd , =) is well ordered, we can \nextract for this sequence a subsequence that is non decreasing for =. We have proved that there exists \nq = q ' in Qm,V such that q(i) < q ' (i). As q . Qm,V then q occurs in a run in Om,V . Hence there exists \n(r, s) . (Nd \u00d7 Nd) n V such that: m + r -* -* . q . m + s ' '' Symmetrically, as q . Qm,V there exists \n(r , s ) . (Nd\u00d7Nd)nV such that: '' ' m + r -* -* . q . m + s Let us introduce v = q ' - q. We deduce: \n** '' '' (m + r )+ r . q -. -+ r from m + r . q q +(v + r) -* -* . (m + s)+(v + r) from q . m + s. \n (m + r)+(v + s) -* -*  . q +(v + s) from m + r . q. ** ' ''' q + s -)+ s from q . m + s . . (m + s \n- Since q ' + r = q + v + r and q + v + s = q ' + s, we have proved the following relations where x = \ns + v + r: r + r ' -* -*' .m x .m s + s '' '' As (r+r , s+s ) . (Nd \u00d7Nd)nV we deduce that (r+r , x, s+s \n) is an intraproduction for (m,V ). Since x(i) > 0 we are done. Let us introduce an additional element \n8 . N and let N8 = N . {8}. A vector in Nd is called an extended marking and 8 the set I = {i .{1,...,d}| \nm(i)= 8} is called the set of relaxed components of an extended marking m. Given a .nite set I .{1,...,d} \nand a marking m . Nd, we denote by m I the extended marking de.ned by m I (i)= 8 if i . I and m I (i)= \nm(i) if i . I. Given a word w = a1 ... ak of w vectors aj . A, we extend the relation -. over the set \nof extended w markings relaxed over a set I by x -. y if there exists a word . = m0 ... mk of extended \nmarkings relaxed over I such that (x, y)=(m0, mk) and mj (i)= mj-1(i)+ aj (i) for every j .{1,...,k} \nand for every i .{1,...,d}\\I. The word . is unique and it is called the run from x to y labeled by w. \nWe introduce the .nite graph Gm,V =(Q, A,E) where Q = {q Im,V | q . Qm,V } and where E = {(p Im,V , a, \nq Im,V ) |p, q . Qm,V . q = p + a}. We introduce the periodic relation Rm,V of couples (r, s) . (Nd \u00d7Nd)nV \nsuch that r(i)= s(i)=0 for every i .{1,...,d}\\Im,V and such that there exists a cycle m,V in Gm,V on \nthe state m Ilabeled by a word a1 ... ak where Pk aj . A such that r + j=1 aj = s. Lemma 8.4. The periodic \nrelation Rm,V is Presburger. Proof. This is a classical result based on the fact that the Parikh image \nof a regular language is Presburger. Lemma 8.5. The following equality holds: -* Q=0Rm,V = Q=0 .m,V Proof. \nLet us .rst prove the inclusion .. Let (r, s) such that r -* s. In this case there exists a word w . \nA * .m,V such that w m + r -. m + s. Observe that m + nr and m + ns are in Qm,V for every n . N. Hence \nr(i) > 0 or s(i) > 0 implies i . Im,V w Im,V and we deduce that m -. m Im,V . Therefore w is the label \nof cycle in Gm,V on m Im,V . We have proved that (r, s) . Rm,V . Now let us prove the inclusion .. We \nconsider (r, s) . Rm,V . In this case (r, s) . (Nd \u00d7 Nd) n V satis.es r(i)= s(i)=0 for every i . Im,V \nand there exists a word w = a1 ... ak of vectors aj . A that labels a cycle in Gm,V on m Im,V and such \nthat Pk m+r+ j=1 aj = m+s. Let us consider a total intraproduction (r ' , x, s ' ) for (m,V ). Given \np . N and j .{0,...,k} we introduce the following vector mp,j : mp,j = m + r + px + a1 + \u00b7\u00b7\u00b7 + aj Let \nus .rst prove that there exists p . Nsuch that mp,j (i) . N for every i . Im,V and j .{0,...,k}. Let \ni . Im,V and j .{0,...,k}, since x(i) > 0, there exists pi,j . N such that mp,j (i) . Nfor every p = \npi,j . We deduce that there exists p . N such that mp,j (i) . Nfor every i . Im,V and j .{0,...,k}. Now \nwe prove that mp,j (i) . Nfor every i .{1,...,d}\\Im,V and j .{0,...,k}. Let j .{0,...,k}. Since w is \nthe label of a cycle on m Im,V , there exists an extended marking qj relaxed over Im,V such that the \nfollowing relation holds: a1...aj m,V m I----. qj We deduce that for every i .{1,...,d}\\Im,V we have \nm(i)+ a1(i)+ \u00b7\u00b7\u00b7 + aj (i)= qj (i). Since r(i)=0 and x(i)=0 we get mp,j (i) . N. We have proved that mp,j \n. Nd for every j .{0,...,k}. Since mp,j - mp,j-1 = aj we deduce that .p = mp,0 ... mp,k is a run. Note \nthat mp,0 = m + px + r and mp,k = m + px + Pk r + j=1 aj = m + px + s. We have proved that the following \nrelation holds: w m + px + r -. m + px + s .m' In particular (r, s) is in the production relation -* \nl where m = -* m + px. Since a production relation is periodic we get m ' + nr . ' '' m + ns for every \nn . N. As (pr ,px,ps ) is an intraproduction for (m,V ) we get m + pr ' -*' -*'. We deduce the . m . \nm + ps -* -* '' ' relation (m + pr )+ nr . m + nr from (m + pr ) . m ', and ** ' ''' the relation m + \nns . (m + ps -). -)+ ns from m . (m + ps We deduce that the following relation holds for every n . N: \nm + pr ' + nr . m + ps ' -* + ns Hence p(r ' , s ' )+ N(r, s) .-* -* .m,V . Thus (r, s) . Q=0 .m,V . \nFrom the inclusion Rm,V .-* we get the inclusion Q=0 .m,V -* Q=0Rm,V . Q=0 .m,V .  Lemma 8.6. The conic \nset Q=0P if .nitely generated for every Presburger periodic set P. Proof. Let us consider a Presburger \nperiodic set P. Since P is Sk Presburger then P = j=1 bj + Pj where bj . Zd and Pj . Zd is a .nitely \ngenerated periodic set. We introduce the .nitely Pk generated conic set C = j=1(Q=0bj + Cj ) where Cj \nis the .nitely generated conic set Cj = Q=0Pj . Since P . C and C is a conic set we deduce the inclusion \nQ=0P . C. As C is .nitely generated we deduce that C is closed. Hence Q=0P . C. For the other inclusion \nlet p . Pj . For every n . N we have bj + np . P. Hence n 1 bj + p . Q=0P for every n . N>0. We deduce \nthat p . Q=0P. Therefore Pj . Q=0P. We deduce that Cj . Q=0P. As Q=0bj . Q=0P . Q=0P we have proved the \ninclusion C . Q=0P. Hence the previous inclusion is in fact an 1 equality. 2 3 Now, we can prove Theorem \n8.1. Lemma 8.4 shows that 4 Rm,V is a Presburger periodic relation. Lemma 8.6 proves that 5 the conic \nset Q=0Rm,V is .nitely generated. Lemma 8.5 shows 6 7 ** that Q=0 -is .nitely generated. Hence (Q=0 \n.m) n V isa 8 .m,V - .nitely generated conic set for every vector space V . Qd \u00d7 Qd .9 Theorem 3.5 shows \nthat the conic relation Q=0 -* is polytope. .m 10 .m 11 Hence -* is a polytope periodic relation. 9. \nPetri Reachability Relations In this section we prove the following Theorem 9.1. All other results or \nde.nitions introduced in this section are not used in the sequel. Theorem 9.1. The reachability relation \nof a Vector Addition Sys\u00adtem is a Petri relation. We are interested in proving that -* . is a Petri relation. \nThis problem is equivalent to prove that -* . n((m, n)+P ) is a Lambert relation for every (m, n) . \nNd \u00d7 Nd and for every .nitely gener\u00adated periodic relation P . Nd \u00d7 Nd. We introduce the order =P over \nP de.ned by p =P p ' if p ' . p + P . Since P is .nitely gener\u00adated we deduce that =P is a well order \nover P (Dickson s Lemma). We introduce the set Om,P,n of runs . such that (src(.), tgt(.)) . (m, n)+ \nP . This set is well ordered by the relation P de\u00ad.ned by . P . ' if .. ' , (src(.), tgt(.)) - (m, n) \n=P (src(. ' ), tgt(. ' )) - (m, n). We deduce that min:P (Om,P,n) is .nite.  Lemma 9.2. The following \nequality holds: [ -* (src(.), tgt(.))+(-* .n((m, n)+P )= .. nP ) ..min\"P (Om,P,n) Proof. Let us .rst \nprove .. Let . . Om,P,n. Lemma 7.2 shows that (src(.), tgt(.))+ -* -* ..... Since (src(.), tgt(.)) . \n(m, n)+ P and P is periodic we deduce the inclusion .. Let us prove .. Let (x ' , y -* ' ) in the intersection \n.n((m, n)+ P ). There exists a run . ' . Om,P,n such that x ' = src(. ' ) and y ' = tgt(. ' ). Since \nP is a well order, there exists . . . '' min:P (Om,P,n) such that . P . We deduce that (x , y ' ) is \nin (src(.), tgt(.))+ -* , y -* ... We get (x '' ) . (src(.), tgt(.)) + ( .. nP ) and we have proved the \ninclusion .. Theorem 8.1 shows -* .. is a polytope periodic relation. Since P is a .nitely generated \nrelation we deduce that P is a polytope periodic relation. Lemma 4.5 shows that the class of polytope \nperiodic relations is stable by .nite intersections. We deduce that * -.. nP is polytope periodic relation. \nThanks to the previous lemma we deduce that -* .n((m, n)+ P ) is a Lambert relation for every (m, n) \n. Nd \u00d7 Nd and for every .nitely generated periodic -* relation P . Nd \u00d7Nd. Therefore . is a Petri relation \nand we have proved Theorem 9.1. 10. Conclusion The reachability problem for Vector Additions Systems \nconsists to decide for a triple (m, A, n) where m, n are two markings of a Vector Addition System A if \nthere exists a word w . A * such that w m -. n. The following algorithm decides this problem. Reachability \n( m , A , n ) k . 0 repeat forever for each word w . A * of length k w if m -. n return reachable for \neach Presburger formula . of length k if .(m) and \u00ac.(n) are true and .(x) . y = x + a .\u00ac.(y) unsat .a \n. A return unreachable k . k +1 The correctness is immediate and the termination is guaranteed by the \nfollowing Theorem 10.1. Theorem 10.1. For every pair of markings (m, n) in the comple\u00adment of the reachability \nrelation of a Vector Addition System, there exists a partition of the set of markings into a Presburger \nforward invariant that contains m and a Presburger backward invariant that contains n. Proof. Let us \nconsider X = {m} and Y = {n} and let R * be the reachability relation of the Vector addition system. \nTheorem 9.1 shows that R * is a Petri relation. Since R * is re.exive and transitive and such that (X \n\u00d7 Y) n R * = \u00d8, Theorem 6.1 shows that there exists a partition of the set of markings into a Presburger \nforward invariant set that contains X and a Presburger backward invariant set that contains Y. This algorithm \ndoes not require the classical KLMST decom\u00adposition. Note however that the complexity of this algorithm \nis still open. In fact, the complexity depends on the minimal size of a word w . A * such that m -w-* \n. n if m . n, and the minimal size of a Presburger formula .(x) denoting a forward invariant M such that \nm . M and n . M otherwise. We left as an open question the problem of computing lower and upper bounds \nfor these sizes. Note that the VAS exhibiting a large (Ackermann size) but .nite reacha\u00adbility set given \nin [MM81] does not directly provide an Ackermann lower-bound for these sizes since Presburger forward \ninvariants can over-approximate reachability sets. As future work we are interested in providing complexity \nbounds on formulas in FO (Q, +, =, 0, 1) denoting the polytope conic sets Q=0 -* .m. References [EN94] \nJ. Esparza and M. Nielsen. Decidability issues for petri nets \u00ad a survey. Bulletin of the European Association \nfor Theoretical Computer Science, 52:245 262, 1994. [GS66] Seymour Ginsburg and Edwin H. Spanier. Semigroups, \nPres\u00adburger formulas and languages. Paci.c Journal of Mathematics, 16(2):285 296, 1966.  [Hau90] Dirk \nHauschildt. Semilinearity of the Reachability Set is Decid\u00adable for Petri Nets. PhD thesis, University \nof Hamburg, 1990. [Kos82] S. Rao Kosaraju. Decidability of reachability in vector addition systems (preliminary \nversion). In Proceedings of the Fourteenth Annual ACM Symposium on Theory of Computing, (STOC 1982), \n5-7 May 1982, San Francisco, California, USA, pages 267 281. ACM, 1982. [Lam92] Jean Luc Lambert. A structure \nto decide reachability in petri nets. Theoretical Computer Science, 99(1):79 104, 1992. [Ler09] J\u00e9r\u00f4me \nLeroux. The general vector addition system reachability problem by Presburger inductive invariants. In \nLICS 09, pages 4 13, 2009. [May81] Ernst W. Mayr. An algorithm for the general petri net reachability \nproblem. In Conference Proceedings of the Thirteenth Annual ACM Symposium on Theory of Computation, (STOC \n1981), 11-13 May 1981, Milwaukee, Wisconsin, USA, pages 238 246. ACM, 1981. [MM81] Ernst W. Mayr and \nAlbert R. Meyer. The complexity of the .nite containment problem for petri nets. J. ACM, 28(3):561 576, \n1981. [Sch87] Alexander Schrijver. Theory of Linear and Integer Programming. John Wiley and Sons, New \nYork, 1987. [ST77] George S. Sacerdote and Richard L. Tenney. The decidability of the reachability problem \nfor vector addition systems (preliminary version). In Conference Record of the Ninth Annual ACM Sympo\u00adsium \non Theory of Computing, 2-4 May 1977, Boulder, Colorado, USA, pages 61 76. ACM, 1977.  \n\t\t\t", "proc_id": "1926385", "abstract": "<p>The reachability problem for Vector Addition Systems (VASs) is a central problem of net theory. The general problem is known decidable by algorithms exclusively based on the classical Kosaraju-Lambert-Mayr-Sacerdote-Tenney decomposition (KLMTS decomposition). Recently from this decomposition, we deduced that a final configuration is not reachable from an initial one if and only if there exists a Presburger inductive invariant that contains the initial configuration but not the final one. Since we can decide if a Preburger formula denotes an inductive invariant, we deduce from this result that there exist checkable certificates of non-reachability in the Presburger arithmetic. In particular, there exists a simple algorithm for deciding the general VAS reachability problem based on two semi-algorithms. A first one that tries to prove the reachability by enumerating finite sequences of actions and a second one that tries to prove the non-reachability by enumerating Presburger formulas. In this paper we provide the first proof of the VAS reachability problem that is not based on the KLMST decomposition. The proof is based on the notion of production relations inspired from Hauschildt that directly provides the existence of Presburger inductive invariants.</p>", "authors": [{"name": "J&#233;r&#244;me Leroux", "author_profile_id": "81100093076", "affiliation": "LaBRI, Universit&#233; de Bordeaux, CNRS, Bordeaux, France", "person_id": "P2509621", "email_address": "leroux@labri.fr", "orcid_id": ""}], "doi_number": "10.1145/1926385.1926421", "year": "2011", "article_id": "1926421", "conference": "POPL", "title": "Vector addition system reachability problem: a short self-contained proof", "url": "http://dl.acm.org/citation.cfm?id=1926421"}