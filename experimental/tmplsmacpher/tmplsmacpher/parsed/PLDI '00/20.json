{"article_publication_date": "05-01-2000", "fulltext": "\n Functional Reactive Programming from First Principles Zhanyong Wan Yale University Department of Computer \nScience P.O. Box 208285 New Haven, Connecticut 06520 zhanyong.wan@yale.edu Paul Hudak Yale University \nDepartment of Computer Science P.O. Box 208285 New Haven, Connecticut 06520 paul.hudak@yale.edu ABSTRACT \nFuntionalReativeProgramming,orFRP,isageneralframe\u00adworkforprogramminghybridsystemsinahigh\u00adlevel,delar\u00adativemanner.ThekeyideasinFRPareitsnotionsofbe\u00adhaviorsandevents.Behaviorsaretime\u00advarying,reativeval\u00adues,whileeventsaretime\u00adorderedsequenesofdisrete\u00adtime \neventourrenes.FRPistheesseneofFran,adomain\u00adspeiflanguageembeddedinHaskellforprogrammingre\u00adativeanimations,butFRPisnowalsobeingusedinvision, \nrobotisandotherontrolsystemsappliations. InthispaperweexploretheformalsemantisofFRPand howitrelatestoanimplementationbasedonstreamsthat \nrepresent(andthereforeonlyapproximate)ontinuousbe\u00adhaviors.Weshowthat,inthelimitasthesamplinginterval \ngoestozero,theimplementationisfaithfultotheformal, ontinuoussemantis,butonlywhenertainonstraintson behaviorsareobserved.Weexplorethenatureoftheseon\u00adstraints,whihvaryamongsttheFRPprimitives.Ourre\u00adsultsshowboththepowerandlimitationsofthisapproah \ntolanguagedesignandimplementation.Asanexampleof alimitation,weshowthatstreamsareinapableofrepre\u00adsentinginstantaneousprediateeventsoverbehaviors. \n 1. INTRODUCTION Howdoesoneshowthatalanguageimplementationisor\u00adret?Intheprogramminglanguageresearhommunity, \nwenormallydothisbyshowingthattheimplementationis faithful,insomeformalsense,toanabstratdenotational oroperationalsemantisofthelanguage.Indeed,ifallgoes \nwell,weanformallyderivetheimplementationfromthe semantis.Suhisthenatureof\"provablyorretompila\u00adtion.\" \nHowever,intheaseofFuntionalReativeProgamming (FRP),anovellanguageinvolvingontinuoustime\u00advarying valuesaswellasdisreteevents,thesituationisnotaslear, \nandseveralquestionsarise: Permission to make digital or hard copies of all or part of this work for personal \nor classroom use is granted without fee provided that copies are not made or distributed for pro.t or \ncommercial advantage and that copies bear this notice and the full citation on the .rst page. To copy \notherwise, or republish, to post on servers or to redistribute to lists, requires prior speci.c permission \nand/or a fee. PLDI2000, Vancouver, British Columbia, Canada. Copyright 2000 ACM 1-58113-199-2/00/0006 \n$5.00. ... 1.HowdoesoneexpresstheformalsemantisofFRP? Wepartiallyansweredthisquestioninapreviouspa\u00adper[7],andwerefnethatstrategyhere. \n2.Howdoesoneimplementontinuoustime\u00advaryingbe\u00adhaviors?Inthispaperweexploreperhapsthemost obvioustehnique,onebasedonstreamsthatrepre\u00adsentsampledbehaviors(inasignalproessingsense). \nHowever,thisrepresentationisonlyanapproximation totheontinuousvalues,whihleadstothenextques\u00adtion. 3.Inwhatsenseisanapproximatingstream\u00adbasedim\u00adplementationorretwithrespettotheformalse\u00admantis,andwhatareitslimitations(forexample,are \ntherevaluesthatannotberepresented)?Theinter\u00adationoftheseissueswiththereativeomponentof FRPmakesthisespeiallyinteresting. \nInthispaperweprovideanswerstoallofthesequestions. Speifally,wegiveadenotationalsemantistoFRP,and showthatinthelimitasthesamplingintervalgoestozero, \nastream\u00adbasedimplementationorrespondspreiselytothe formalsemantis,butonlywithsuitableonstraintsonthe \nnatureofbehaviors.Thegoodnewshereisthatmostofthe ommonthingsthatweexpresswithFRPprogramsarewell behaved,andlawsthatweexpettoholdinmathematisare \njustifed,inthelimit,whenreasoningaboutFRPprograms. Forexample,weansafelyapplymostFRPprimitives,suh asintegration,tobehaviorsthataredisontinuous(inaer\u00adtainwaytobedesribedlater),whihisritiallyimportant \ngiventhatthereativeomponentofFRPreatesdisonti\u00adnuitiesquiteoften. Thebadnewsisthat,sineFRPismathematiallyvery \nrih,manyillbehavedvaluesanbeexpressed.Asaresult, anFRPtermdoesnotalwayshaveameaningfulseman\u00adtis.Insuhaseswesaythatthetermdenotes.(and \nisthusdenotationallyequivalenttonon\u00adterminationorer\u00adror).Ofourse,thisisnotveryinformative.Evenworse, \nitispossibletowriteegregiousbehaviorsforwhiheither theimplementationdoesnotonvergewhenweinreasethe samplingrate,oritonvergestosomethingotherthanits \nsemantis.However,weareabletoidentifyasetofsu\u00c6ient onditionswhihguaranteesthefdelityoftheimplementa\u00adtion.Theseonditionsareneitherompletenordeidable \ningeneral,whihmeanstheburdenof\"goodbehavior\"is ontheprogrammer.However,itisperhapsnotsurprising givensuharihmathematiallanguage. \n 2. AN INTRODUCTION TO FRP InthissetionwegiveaverybriefintrodutiontoFRP;see [5,7]formoredetails.FRPisanexampleofanembed\u00addeddomain\u00adspeiflanguage[9].Inourasethe\"host\"is \nHaskell[11],ahigher\u00adorder,typed,polymorphi,lazyand purelyfuntionallanguage,andthusallofourexamples(as \nwellasourimplementation)areinHaskellsyntax. TherearetwokeypolymorphidatatypesinFRP:the BehaviorandtheEvent.AvalueoftypeBehaviorais \navalueoftypeathatvariesoverontinuoustime.Con\u00adstantbehaviorsinludenumbers(suhas1::Behavior Real),olors(suhasred::BehaviorColor),andoth\u00aders.Themostbasitime\u00advaryingbehavioristimeitself: \ntime::BehaviorTime,whereTimeisasynonymforReal. Moreinterestingtime\u00advaryingbehaviorsinludeanimations oftypeBehaviorPiture(whihisthekeyideabehind \nFran[5,7],alanguageforfuntionalreativeanimations), sonarreadingsoftypeBehaviorSonar,veloityvetorsof typeBehavior(Real,Real),andsoon(thelattertwoex\u00adamplesareusedinFrob[13,14],anFRP\u00adbasedlanguagefor \nontrollingrobots).(Note:Inourimplementationthetype RealisapproximatedbyFloat.) AvalueoftypeEventaisatime\u00adorderedsequeneofevent \nourrenes,eaharryingavalueoftypea.Basieventsin\u00adludeleftbuttonpressesandkeyboardpresses,represented bythevalueslbp::Event()andkey::EventChar, \nrespetively.Thedelarativereadingoflbp(andkey)is thatitisaneventsequeneontainingalloftheleftbutton presses(andkeypresses),notjustone. \nBehaviorsandeventsarebothfrst\u00adlassvaluesinFRP,and thereisarihsetofoperators(ombinators)thattheuser anusetoomposenewbehaviorsandeventsfromexisting \nones.AnFRPprogramisjustasetofmutually\u00adreursive behaviorsandevents,eahofthembuiltupfromstati(non\u00adtime\u00advarying)valuesand/orotherbehaviorsandevents. \nSupposethatwewishtogenerateaolorbehaviorwhih startsoutasred,andhangestobluewhentheleftmouse buttonispressed.InFRPwewouldwrite: \n>olor::BehaviorColor >olor=red'until'(lbp-=>blue) Thisanberead\"behaveasreduntiltheleftbuttonis pressed,thenhangetoblue.\"Weanthenuseolorto \nolorananimation,asfollows: >ball::BehaviorPiture >ball=paintolorir > >ir::BehaviorRegion >ir=translate(ostime,sintime)(irle1) \nHereirle1reatesairlewithradius1,andthetrans\u00adlationausesittorevolveabouttheenterofthesreen withperiod27seonds.Thusballisarevolvingirle \nthathangesfromredtobluewhentheleftmousebutton ispressed. Sometimesitisdesirabletohoosebetweentwodiferent \nbehaviorsbasedonuserinput.Forexample,thisversionof olor: >olor2=red'until' > (lbp-=>blue).I.(key-=>yellow) \nwillstartofasredandhangetoblueiftheleftmouse buttonispressed,ortoyellowifakeyispressed.The.I. operatoranbereadasthe\"or\"ofitseventarguments. \nThefuntionwhentransformsaBooleanbehaviorintoan eventthatoursexatly\"when\"theBooleanbehaviorbe\u00adomesTrue;thisisalledaprediateevent.Forexample: \n>olor3=red'until' > (when(time>*5)-=>blue) defnesaolorthatstartsofasredandbeomesblueafter timeisgreaterthan5. \nSometimesitisdesirableto\"lift\"anordinaryvalueorfun\u00adtiontoananalogousbehavior.Thefamilyoffuntions >liftO::a->Behaviora \n>lift1::(a->b)->(Behaviora->Behaviorb) andsoon,performsuhoerionsinFRP.SometimesHaskell overloadingpermitsustousethesamenameforliftedand \nunliftedfuntions,suhasmostofthearithmetioperators. Whenthisisnotpossible,weusetheonventionofplaing a\"*\"aftertheunliftedfuntionname.Forexample,>*in \ntheolor3exampleistheliftedversionof>. Finally,oneofthemostusefuloperationsinFRPisinte\u00adgrationofnumeribehaviorsovertime.Forexample,the \nphysialequationsthatdesribethepositionofamassun\u00addertheinfueneofanaeleratingforefanbewritten as: >s,v::BehaviorReal \n>s=sO+integralv >v=vO+integralf wheresOandvOaretheinitialpositionandveloity,respe\u00adtively.Notethesimilarityoftheseequationstothemathe\u00admatialequationsdesribingthesamephysialsystem: \n.; s(t)sJ+v(T)dT J .; v(t)vJ+Jf(T)dT Thisexampledemonstrateswellthedelarativenatureof FRP.AmajordesigngoalforFRPistofreetheprogram\u00admerfrom\"presentation\"detailsbyprovidingtheabilityto \nthinkintermsof\"modeling.\"ItisommonthatanFRP programisoniseenoughtoalsoserveasaspeifationfor theproblemitsolves. \nTherearemanyotherusefuloperationsinFRP,butwein\u00adtroduethemonlyasneededintheremainderofthepaper.  3. THE \nSEMANTIC FRAMEWORK Inthissetionwepresentthesemantiframeworkforbe\u00adhaviorsandevents.ThesemantisofeahFRPonstrut \nwillbegivenindividuallyinSetion6. FRP'snotionofontinuoustimeisdenotedbythedomain Time,whihisasynonymforthesetofrealnumbers..Let \n(Behavioru)and(Eventu)denotethesetofallFRPtermsof typeBehavioraandEventarespetively,whereaisany Haskelldatatype.Themeaningofbehaviorsandeventsis \ngivenbythefollowingsemantifuntions: ..:(Behavioru)-Time-Time-a .:(Eventu)-Time-Time-[Timexa] where[-]isthelisttypeonstrutor. \nIntuitively,themeaningofabehavior,asgivenby..,isa funtionmappingastarttimeandatimeofinteresttothe valueofthebehavioratthegiventimeofinterest.Start \ntimesrelatetothereativenatureofFRP.Forexample, in(b'until'e),ifaneventourrene(tTb')ofeauses theoverallbehaviortoswithto,wesaythatstartsat \nb'b'timet.behaviorisunawareofanyeventourrenesthat happenedbeforeitsstarttime. Themeaningofanevent,givenby.,isafuntionthat \ntakesalsoastarttimeTandatimeofinterestt,andreturns afnitelistoftime\u00adasendingourrenesoftheeventinthe interval(TTt].Thestarttimeofaneventisanalogousto \nthestarttimeofabehavior.Notethatthelowerendofthe intervalisopen,whihmeansanourrenepreiselyatthe starttimeisnotdeteted. \nNotethat,forsimpliity,wehaveomittedreal\u00adworldevents suhasuserinputandgeneralI/Ofromthissemantiframe\u00adwork.However,prediateeventssuhasdesribedinthe \nlastsetionarestillpresent,whiharesu\u00c6ienttodemon\u00adstrateallinterestingaspetsofthesemantisandimplemen\u00adtation.Nevertheless,forompleteness,wedesribehowto \nadduserinputinSetion8.  4. A STREAM IMPLEMENTATION OF FRP Ourstream\u00adbasedimplementationofFRPisinterestingin \nitsownright,butbeauseofspaelimitationsweomita detaileddisussionofithere;thebasiideaisoutlinedin[6] andelaboratedin[10]. \nTheoredatatypesinFRP,BehaviorandEvent,aregiven by: >typeBehaviora=[Time]->[a] >typeEventa=[Time]->[Maybea] \nours(indiatedasJustxforsomex),ordoesnotour (indiatedasNothing).Notethatusingthisimplementation strategyforeventsmeansthatwemustensurethatthetime \nassoiatedwitheaheventourreneatuallyappearsin thetimestream,butthisiseasilydone. Theimplementationitselfanbedividedintotwoparts:(1) \ndefnitionsofFRP'sprimitivebehaviors,events,andombi\u00adnatorsasstreamtransformers,and(2)a\"run\u00adtimesystem\" \nthatinterpretsthebehaviorsandeventsbybuildinganinf\u00adnitestreamofsampletimesandapplyingthebehavior/event \ntothestream.Thelattertaskisexplainedintheremainder ofthissetion;wereturntotheformerinSetion6. Tosimplifythepresentationoftherun\u00adtimesystem,weomit \ntheinterfaetotheoperatingsystemthatextratsevents, grabstheloktime,et.Theresultingabstratimplemen\u00adtationisapturedbythefollowingpairof\"interpreters,\" \noneforbehaviors,theotherforevents: a at:(Behavioru)-[Time]-a def a[b]]ts=last(Lbts) at[ 5C:(Eventu)-[Time]-[Timexa] \ndef 5C[[e]]ts=justValuests(Lets) where(1)wewriteL-forthevalue(whihouldbea funtion)denotedbytheHaskellterm-,(2)lastreturns \nthelastelementofalist,and(3)theauxiliaryfuntion: justValues:[Time]-[Maybeu]-[Timexa] time\u00adstampsastreamof\"Maybe\"valueswhiledroppingthe \n\"Nothing's.\"Forexample, justValues[0.0T0.1T0.2T0.3T0.4] [NothingTJustFalseTNothingTNothingTJustTrue] \nreturns[(0.1TFalse)T(0.4TTrue)]. Intuitively,atatakesabehaviorandanorderedfnitelistof sampleTime's,thefrstinthelistbeingthestarttimeofthe \nbehaviorandthelastbeingthetimeofinterest.Itreturns asresultthevalueofthebehavioratthetimeofinterest. \nSimilaris5,whihreturnsalltheourrenesdeteted Cupuntilthetimeofinterest.Inessene,aC atand5defne anoperationalsemantisforFRP.(NotethatbisaHaskell \ntermoftype[Time]->[a],soLbisafuntionoftype [Time]->[a],andthereforeLbtsisavalueoftype[a].) Inthispaperwearemostinterestedinthelimitoftheop\u00aderationalsemantisasthesamplingintervalgoestozero. \nThuswedefne: a at*:(Behavioru)-Time-Time-a ) ata[[b]]P,j .. limIP. otherwise suhlimitexists ata*[[b]]Tt \ndef = I-J HereMaybeaisadatatypewhosevaluesareeitherNothing orJustx,wherexissomea. C:(Eventu 5* ,vioristransformer:funtion \n)-Time-Time-[Timexa] ) 5C[[e]]P,j .. limIP. otherwise suhlimitexists thattakesaninfnitestreamofsampletimes,andyieldsan \ninfnitestreamofvaluesrepresentingitsbehavior.Similarly, C[e]]Tt 5*[ def = I-J aneventisalsoastreamtransformer,andanbethought \nofasabehaviorwhere,ateahtimet,theeventeitherwhereP,jisapartitionof[TTt]. 244 Intuitively streamabehaaa \nDefnition1.(Partitionandnormofpartition)Aparti\u00adtionPofalosedinterval[a,b]isanon\u00ademptyfnitelist [XJ,Xl,,Xn],suhthata=Xo<Xl<<Xn=b, \nwheren?0.Suhapartitionisoftenwrittenas .The P. normofP,writtenasIPI,isdefnedasthemaximumofthe set{Xi-Xi.lI1:i:n}whenn?1,or0whenn=0. \n(Notethatweoverloadthenotation[a,b]forbothalosed intervalandalistoftwoelements,andsimilarly(a,b)for bothanopenintervalandatuple.However,themeaningis \nalwayslearfromontext.) 5. FAITHFUL IMPLEMENTATIONS AND UNIFORM CONVERGENCE Inthenextsetionwewillgiveboththedenotationalse\u00admantisandstream\u00adbasedimplementationofeahFRPon\u00adstrutinturn,andshowineahasethattheimplementa\u00adtionisfaithfultothesemantis,thoughpossiblyonlyunder \nertainonstraints,inthefollowingformalsense: .at.[[b]]Tt = ..[[b]]Tt (1) .o.[[e]]Tt =. [[e]]Tt Inaddition,wewillidentifytheaseswheretheimplemen\u00adtationonvergesuniformly,aproperty(defnedbelow)that \nisneessarytoensurethattheintegralofanumeribehavior iswelldefned.Analogoustotheoneptofuniformonver\u00adgeneforrealnumberfuntionseries[1,page393],wedefne \nuniformonvergeneforfuntionsdefnedonpartitionsof realintervals: Defnition2.(UniformConvergene)GivenasetS,we \nsaythatafuntionFdefnedonPf,whihisthesetof allpartitionswhoseleft(i.e.smaller)endisT,onverges uniformlytofonSif,foreveryE0,thereexistsa\u00c60 \n(dependingonlyonE)suhthatforeverytESandPft satisfyingIPftI<\u00c6, IF(Pft)-f(t)I<E Wedenotethissymboliallybywriting \nF(Pft).f(t)uniformlyonS So,whenpossible,wewillindiatewhenthefollowingon\u00additionholds: . at[[b]]Pft...[[b]]Ttuniformly(2) \nNotethat(2)implies(1),andforonisenesswewillnot writeout(1)ifwehavealreadyestablished(2). BeauseFRPisan\"embedded\"DSL,itisdi\u00c6ulttodrawa \nlearlinebetweenFRPandHaskell.Thusafulltreatment oftheFRP\"language\"inevitablyrequiresatreatmentof allofHaskell.Asthiswouldobsureourmaininterest,we \nhoosetodisussonlytheonstrutsspeiftoFRP. 6. CORRESPONDANCE BETWEEN SEMAN-TICS AND IMPLEMENTATION Theproofoftheimportanttheoremsinthissetionanbe \nfoundinappendixA. Time Theprimitivebehaviortimeisimplementedas: >time::BehaviorTime >time=\\ts->ts anditssemantisisgivenby: \n..[[time]]Tt=t Weanshowthattheimplementationoftimeisfaithfulto itssemantis,andthatitsonvergeneisuniform: \n. THEOREM1.at[[time]]Pft.tuniformlyon(-0,0). Lifting Hereweshowtheorretnessofthethreemostusefullift\u00adingoperators:liftO,lift1andlift2.Theresulteasily \nextendstoanyarityoflifting.Theliftingoperatorsare implementedas: >($*)::Behavior(a->b) > ->Behaviora->Behaviorb \n>ff$*fb= >\\ts->zipWith($)(ffts)(fbts) > >liftO::a->Behaviora >liftOx=map(onstx) > >lift1::(a->b)->(Behaviora->Behaviorb) \n>lift1fb1=liftOf$*b1 > >lift2::(a->b->) > ->(Behaviora > ->Behaviorb->Behavior) >lift2fb1b2=lift1fb1$*b2 \nThesemantisofliftOisgivenby: ..[[liftO] Tt=L Unsurprisingly,theimplementationonvergestotheseman\u00adtisuniformly: \n. THEOREM2.at[[liftO] Pft.Luniformlyon (-0,0). Thesemantisoflift1isgivenby: ..[[lift1fb]]Tt=Lf(..[[b]]Tt) \nTheimplementationoflift1isfaithfultoitssemantis, butonlywhentheliftedfuntionisontinuous: . THEOREM3.Ifat.[[b]]Tt=btannLfisontinuousat \n. btthenat.[[lift1fb]]Tt=Lfbt. ItisworthnotingthatweonlyrequireLftobeontinuous atbt,notneessarilyontinuouseverywhere.Sinemost \n funtionswedealwithinFRPareeithergloballyontinuous orpieewiseontinuous,thetheoremappliesinmostases. Toseewhethertheonvergeneoflift1isuniform,weneed \naoneptalleduniformontinuity[1,page74],asfoundin mosttreatmentsofalulus: Defnition3.(UniformContinuity)Afuntionfissaid \ntobeuniformlyontinuousonasetSifforeveryE0,there existsa\u00c60(dependingonlyonE)suhthatifx,yES andIx-yI\u00c6,thenIf(x)-f(y)IE. \nTHEOREM4. t[P;.fb(t)uniformlyonS,and Ifa[b]]LLfisuniformlyontinuous,then a[lift1fb]]PLt.Lf(b(t))uniformlyonS \nt[f Forexample,theliftedsinfuntionisdefnedas:1 >instaneFloatinga=>Floating(Behaviora)where >sin=lift1sin \nNotethatthesinontherighthandsideofthedefnitionis thestativersionasinthestandardHaskelllibrary: >sin::Floatinga=>a->a \nAsanexample,weanusetheorem4toprovethatthe expression\"sintime\"inFRPatuallydenotesthemathe\u00admatialnotionofsin(t),wheretistheurrenttime. \nCOROLLARY1. t[time]].sintuniformly a[sinPLton (-0,0). Thesemantisoflift2isgivenby: ..[ lift2fbd]]Tt=Lf(..[[b]]Tt)(..[ \nd]]Tt) Similartolift1,weanshow: * THEOREM5. t[b]]Tt=bt,a[Tt=dt,and Ifa[ t*[d]](unurryLf)isontinuousat(bt,dt),then \n* a t[[lift2fbd]]Tt=Lfbtdt. aswellasthefollowingforuniformonvergene: THEOREM6. t[.fb(t)uniformlyonS, \nIfa[b]]PLt ta[[d]]PLt.fd(t)uniformlyonS,and(unurryLf)is uniformlyontinuous,then a[lift2fbd]]PLt.Lf(b(t))(fd(t)) \nt[f uniformlyonS. 1Theinstanedelarationshownhereishow,usingHaskell's typelasssystem,funtionsareoverloaded.Inthisase, \nsinisamethodinthelassFloating,andtheinstane delarationsaysthatsinmaynowbeusedforvaluesof typeBehaviora,foranytypeathatisalreadyaninstane \nofthelassFloating. Forexample,weanusethistheoremtoverifythesemantis oftheliftedbinaryoperator+: >instaneNuma=>Num(Behaviora)where \n> (+)=lift2(+) * a=at+a COROLLARY2. t*[[b+d]]Tt t[[b]]T t*[[d]]Tt Integration Weuseaverysimplynumerialalgorithmtoalulatethe \nRiemannintegrationofnumeribehaviors: >integral::BehaviorReal->BehaviorReal >integralfb= >\\ts (t:ts')->0:loopt0ts'(fbts) \n>whereloopt0a(t1:ts)(a:as) > =leta'=a+(t1-t0)*a > ina':loopt1a'evstsas Theformalsemantisofintegralisgivenby: \nt ..[[integralf]]Tt=L(..[[f]]TT)dT Asmentionedearlier,thisstream\u00adbasedintegratorisonly soundmathematiallyifthebehaviortobeintegratedon\u00advergesuniformly: \nTHEOREM7.Ifa[b]]L.fb(T)uniformlyon, t[P'[Tt], then L' a[integralb]]PL'.fb(T)dT t[ uniformlyon[T,t]. \nIfa[b]]L.fb(T)non-uniformly,weansaynothing t[P'about t*[[integralb]]Tt.Asaninstane,onsiderthe a behaviorbizarre(inspiredby[1,page401]),whihisnon\u00aduniformlyonvergenton[0,1],andisdefnedas: \n>bizarre>bizarre>where> > ::BehaviorReal =0'until'e==>b e=when(time>*0)'snapshot'time b=\\( ,t1)->**time*(1-time)** \nwhere=1/t1 Ontimeinterval[0,1],theaboveisequivalentto: >bizarre=\\(t0:t1:ts)-> >0:0:map(let=1/(t1-t0) \n> in\\t->**t*(1-t)**)ts WhentE[0,1],wehave a t*[[bizarre]]0t =limIp.l stLbizarrePt o JI-o =limIp.2t(1-t),where \nJI-o 1i=thelengthofthefrstsub\u00adintervalofPt o =0  1* Henea[]0tdt=0.eha . t[bizarre]However,wve f a t*[[integralbizarre]]01 \n=limIpJa Lbizarrepf1 .!ti I-fni.1(i)wherep1=[tf=0Tt1T Ttn=1],and f subsript(i)meansthei-thelementofalist \na =limIpJI-fni.22ti_1(1-ti_1).!ti, where=1/!t1 and 1 2 limt(1-t)dt=lim=1 2 -of -o(+1)(+) Therefore \nta*[[integralbizarre]]01 f 1 t*[bizarre]0dt =a[]t Inotherwords,thelimitoftheintegraldoesn'tagreewith \ntheintegralofthelimitforbizzare. Itturnsoutthatglobaluniformonvergeneisusuallytoo strongaonditiontoahieveinpratie,partofthereason \nbeingthattheinterplayofbehaviorsandeventsoftenre\u00adsultsin.atthepointofbehaviorswithing.Thefollowing theoremrelaxestherequirementonsiderably: \nTHEOREM8. t[pL.fb(T)uniformlyon[TTt], Ifa[b]]Lexeptatn(fnite)pointsT1,T2,,Tn,and t[pL .is a[b]]boundedasIpL \n.I0forevery1:i:n,then LaL t[[integralb]]pL.F(T)dT L uniformlyon[TTt],where fb(T)T =Tiforevery1:i:n F(T)= \nanyfnitevalueotherwise Sinemostbehaviorsweenounterinpratiearebounded oneveryfniteinterval,theaboveonditionisnothardto \nsatisfy. Asshownintheorem7,integrationpreservestheuniform onvergeneproperty.Thisallowsustosafelyalulatethe \nseondintegral,thethird,andsoon: COROLLARY3. t[pL.bTTt], Ifa[b]]Lf(T)uniformlyon[then n aL t[[integral(integral \n(integralb))]]pL LLJ L..J .fb(Tn)dTndTn_1dT1 LLL uniformlyon[TTt]. Event Mapping The==>operatoressentiallymapsafuntionovertheevent \nstream,andisimplementedas: >(==>)::Eventa->(a->b)->Eventb >fe==>f=map(mapf).fe Itssemantisisgivenby: \n.[[e==>f]]Tt= [(t1TLfv1)T(t2TLfv2)TT(tnTLfvn)],where .[[e]]Tt=[(t1Tv1)T(t2Tv2)TT(tnTvn)] Ifc[e]]Tt2)n)], \nTHEOREM9.o*[=[(t1Tv1)T(t2TvTT(tnTvandLfisontinuousatviforevery1:i:n,then oc*[[e==>f]]Tt= [(t1TLfv1)T(t2TLfv2)T \nT(tnTLfvn)] The-=>operatorweusedpreviouslyisjustsyntatisugar: def e-=>b=e==>\\->b Choice .I.anbeusedtomergetwoeventsofthesametype;itis \nimplementedas: >(.I.)::Eventa->Eventa->Eventa >fe1.I.fe2= >\\ts->zipWithaux(fe1ts)(fe2ts) >whereauxNothingNothing=Nothing \n> aux(Justx) =Justx > aux (Justx)=Justx Thesemantisof.I.operatorisgivenby: If.[[e1]]Tt=[(t1Tv1)T(t2Tv2)TT(tnTvn)],.[[e2]]Tt= \nDDD [(tDTv1)T(tDTv)TT(tDTv)],andt1Tt2TTtnTtDTtD2TTtD 122mm1m aredistint,then .[[e1.I.e2]]Tt=[(T1T1)T(T2T2)TT(Tn+mTn+m)], \nD wherets={t1Tt2TTtnTt1TtD2TTtDm ,and (tjTvj)tjisthei-thsmallestofts(TiTi)=D (tkDTvk)tkDisthei-thsmallestofts \nNotethatwerequiretheourrenetimesaredistint,be\u00adausetheresultofmergingtwosimultaneousourrenesis nondeterministi. \nWeanshowthattheimplementationof(.I.)onverges toitssemantis.Tosavespae,wedon'tgivetheformal statementhere. \nBehavior Switching Theuntiloperatorisimplementedas: >until::Behaviora->Event(Behaviora) > ->Behaviora \n>fb'until'fe= >\\ts->loopts(fets)(fbts) >whereloopts ( :ts')-(e:es)(b:bs)= > b:aseeof > Nothing->loopts'esbs \n> Justfb'->tail(fb'ts) anditssemantisisgivenby: If.[[e]]Tt=[(tlTLbl)TT(tnTLbn)],thenforany7E [TTt], \n ..[ b]]T7n=0or7:tl ..[[b'until'e]]T7= ..[[bl]]tl7otherwise Thisoperatorispreiselywherebehaviorsinteratwithevents, \nandthusitsgoodbehaviorisritialtothegoodnessofFRP. Weanshow: THEOREM10.o*[=[(tlTLbl)TT(tnTLbn)], Ifc[e]]Ttthenforany7Tt]where7 \nE[T=tl, a at*[[b'until'e]]T7= a at*[[b]]T7n=0or7tl a lim,-t.at*[[bl]]T7otherwise Mostbehaviorsareontinuouswithrespettotheirstart \ntimes(i.e.asmallhangeinthestarttimeonlyresultsin asmallhangeintheresultvalue);forexamplethisistrue ofintegral.Somebehaviorsareevenindependentofthe \nstarttime,aswithtime.Insuhases,thelimitoperatorin theabovetheoremanbedropped,andtheimplementation beomesonsistentwiththesemantis. \nSnapshot snapshotsamplesabehaviorattheexatmomentsanevent ours. >snapshot::Eventa->Behaviorb > ->Event(a,b) \n>snapshotfefb >=\\ts->zipWithaux(fets)(fbts) > whereaux(Justx)y=Just(x,y) > auxNothing =Nothing Thesemantis: \nIf.[[e]]Tt=[(tlTa)T(t2Ta2)TT(tnTan)]and..[[b]]Tti= l bi,then .[[e'snapshot'b]]Tt= [tlT(alTbl)Tt2T(a2Tb2)TTtnT(anTbn)] \nTheimplementationisfaithfultothesemantisunondi\u00adtionally: THEOREM11.Ifc[e]]Tt=[(tlTa)T(t2TaT o*[l2)T (tnTan)]anda[ti=bi,then \nat*[b]]T c*['snapshot'b]]Tt= o[e [tlT(alTbl)Tt2T(a2Tb2)T TtnT(anTbn)] Predicate Events WeanturnaBooleanbehaviorintoaneventthatours \neverytimethebehaviorhangesfromFalsetoTrue.Todo soweusethewhenombinatordefnedas: >when::BehaviorBool->Event() \n>whenfb= >\\ts->zipWithup(True:bs)bs >wherebs=fbts > upFalseTrue=Just() > up =Nothing Wedefnethesemantisofwhenasfollows:GivenTTtE \nTi e,letb(7)=..[ b]]T7.IftherearelTT TEoo andapartition[toTtTTt]of[TTt],suhthat: 2n ln 1.Forall1:i:n-1,='i \ni+l; 2.Forall1:i:n-1,7E(ti-lTti)impliesb(7)=i; 3.b(T)= .orl=False,and 4.b(t) =.orn=True. then.[[whenb]]Tt=os \n=.,whereosistheshortest time\u00adasendinglistsatisfying: 1.Ifl=Trueandb(T)=False,then(TT())Eos; 2.For1:i:n-1,(tiT())Eosifi=False,and \n3.Ifn=Falseandb(t)=True,then(tT())Eos. Otherwise.[[whenb]]Tt=.. Thismayseemompliated,butitbasiallysaysthatwhenb \nhasanourreneattime7if..[[b]]TT(viewedasafun\u00adtionofT)jumpsfromFalsetoTrueasTrossespoint7 fromtheleft(i.e.thenegativeside). \nAordingtothisrule,ifb(7)togglesitsvaluebaand forthinstantaneouslyatsome7oE(TTt),then .[[whenb]]Tt=..Toseewhythisistrue,suppose \n .[b]]Tt .,thentheremustbeT T  [when=land n toT Ttnsatisfyingtheaboveonstraints.Inaddition,7o mustbeequaltotkforsome1:k:n-1,beauseb(7) \nremainsonstantineahof(ti-lTti)where1:i:n.How\u00adever,thismeansk=k+l,whihviolatestheonstraint i='i+l. Thisruleimpliesthatonanyfnitetimeinterval,aprediate \neventanonlyourafnitenumberoftimes(forthenum\u00adbernaboveisfnite).Therefore,iftheBooleanbehavior everosillatesataninfnitefrequeny(wewillseesuhan \nexamplelater),thesemantisoftheeventis.. Theimplementationofwhenbisfaithfultothesemantisif theimplementationofbonvergesuniformly: \na THEOREM12.Givenatimeinterval[TTt],ifat[[b]]Pf. b(7)uniformlyon[TTt],then oc*[[whenb]]Tt=o[[whenb]]Tt. \nWerequireata[[b]]Pf.b(7)uniformlyon[TTt],beause themeerat*[b]]T7isnotsu\u00c6ienthere.For existeneofa[ example,giventhebehaviorbizarrewedisussedinSetionInastream\u00adbasedimplementation,wedon'tknowwhat \n6,a[>*1]]0T=FalseforeveryTE[0,1],andvalueunpreditablewillyieldatruntime,sineitdepends at*[bizarrethus.[[when(bizarre>*1)]]01=[],but \nonthesamplingfrequenyandphase.Forthisexample,the semantirulesgiveavalueintermsofsin1wheret=1, c[when(bizarre>*]01=[0,0)]= \n[] o*[1)]t-1 whihisundefnedduetothedisontinuityofthefuntion.  7. EGREGIOUS BEHAVIORS AND EVENTS Asmentionedearlier,itispossibletodefneertainegregious \nbehaviorsandeventsinFRP,andagoodunderstanding ofthemishelpfulinunderstandingthesemantirulesand theoremsthatwehaveintrodued.Considerfrstthisevent: \n>sharp::Event() >sharp=when(time==*1) Thislooksinnoentenough,buttheprediateistrueonly instantaneouslyattime=1.Tosamplesharp,let'son\u00adsideraseriesofpartitions{PInEN}of[0,2],wherePn= \nn 12 .+1 [0,,,...,,2].Obviouslylimn-oIPnI=0, 2n+12n+12n +1 howevernoneofthepartitionsdivides[0,2]atpoint1.Hene \noursamplingbasedimplementationouldfailtofndthe eventourreneattime1.Thisexplainswhyoursemanti ruleforwhengives.asthedenotationofsharp. \nItisworthpointingoutthatoneanwriteawell\u00adbehaved defnitionforsharp: >sharp2=when(time>=*1) ConsidernextthisenodingofZeno'sParadox: \n>zeno::Event() >zeno=when(lift1ftime)where >ft=t<2&#38;&#38;even(floor(log2(2-t))) Thisexampledemonstratesaninfnitelydensesequeneof \neventsattimesto=1,t1=1.5,t2=1.75,andingen\u00ad -On+1) eraltn+1=tn2.Thisreatesobviousproblems withanimplementation.Butevenifweouldimplement \nsuheventsequenes,thereisamorefundamentalsemanti problem.Supposethereisaneletrilightinaroom,ini\u00adtiallyof.Adaemonomesinandturnsthelightonattime \nto,ofattimet1,andsoon.Asimplealulationshowsthat limn-otn=2,sothewholeproessomestoanendattime t=2.Nowthequestionis:isthelightonorofafterthe \ndaemonstops?Theanswermightbesurprising:itouldbe eitheronorof;i.e.,thisisanaturalexpressionofnondeter\u00adminism.Oursemantirulesgivethat.[[zeno]]Tt=.for \nanyT<2:t,whihprovidesnoinformationaboutwhat theimplementationwillgiveus,andthereforeisompatible withthenondeterministisemantisonemightexpet. \nFinally,onsiderthisunpreditablebehavior: >unpreditable::BehaviorReal >unpreditable= >0'until'(when(time>*1) \n> 'snapshot'sin(1/(time-1)) > ==>(\\( ,x)->lift0x)) sharp,zenoandunpreditableareallexampleswherethe semantisis..Thereareotheregregiousvalueswherethe \nsemantisisnot.,buttheimplementationdoesnotagree withit.integalbizarreisoneofthem.  8. INTERFACE WITH \nREAL WORLD Aswasmentionedearlier,behaviorsandeventsanalsore\u00adattouserations,whihweanaptureformallythrough \nthenotionofanenvironment,whihanbeviewedasaf\u00adnitesetofprimitivebehaviorsandevents.Thus,stritly speaking,thesemantifuntionsshouldhavetype: \n..:(Behavioru -n -Time-Time-a .:(Eventu -n -Time-Time-[Timexa]  wheren istheabstratdatatypeforalltheinputtothe \nFRPsystem. Forexample,inFran,theenvironmentinludesmousemove\u00adments,mousebuttonpresses,andkeyboardpresses.Thus \nweandefnen =Pe lntXlntxPtO)xPtO)x PtChar,wherethefouromponentsofthetupleorrespond tomouseposition,leftbuttonpress,rightbuttonpressand \nkeyboardpress,respetively.TypeoftheformPe and uPtuaredefnedas: Pe u=Time-a Ptu=Time-[Timexa] Thisideaanbejustifedbynotingthatprimitivebehaviors \nandeventsareinfatobservationsofphysialsignalsoutside oftheFRPsystem.Theirvaluesatapartiulartimedonot \ndependonwhenwestarttheobservation.Thereforeavalue oftypePe isjustamappingfromtheurrenttimeto uthevalue,andavalueoftypePtuisamappingfrom \nurrenttimetoalltheourrenessinetheinitializationof thesystem. Thetreatmentofenvironmentisalmostorthogonaltothe \ntreatmentoftheindividualFRPoperators.Thisallowsus toaddresstheissueseparately.Toextendthestripped\u00addown \nversionofFRPtoinorporateenvironments,weneedonly to: 1.DefnethesemantisfortheFRPonstrutsthatrep\u00adresentuserations. \nFormouse::Behavior(Int,Int),wehave: ..[[mouse] 0mouse,lbp,rbp,key)Tt=mouset. Forlbp::Event(),wehave: \n.[[lbp]]0mouse,lbp,rbp,key)Tt=aterT0lbpt), whereaterTlistdropsallelementsinlistwhose time\u00adstampislessthanorequaltoT. \n2.Passtheenvironmentparameteraroundintheseman\u00adtiequationsforompositebehaviors/events.Forin\u00ad stane,themeaningforlift2isnowgivenby: \n..[[lift2fbb]]envTt= .. Lf(..[[b.]]envTt)(..[[b]]envTt) . 9. CONCLUSIONS AND RELATED WORK Althoughthesignalproessingliteratureisfulloffounda\u00adtionalworkonthevalidityandaurayofsamplingteh\u00adniques,wearenotawareofanyworkattemptingtodefne \nthesemantisofareativeprogramminglanguagesuhas FRP.Also,mostofthesignalproessingworkshiesaway fromdisontinuoussignals,whereaswehaveshownthatun\u00addertherightonditionsvaluesarestillwellbehaved. \nIn[7]wedesribedadenotationalsemantisforFran.The semantisgiveninthispaperisdiferentinthatitparame\u00adterizesthestarttimeforbehaviorsandevents,andontains \namorepreiseharaterizationofevents.Variousimple\u00admentationtehniquesforFranaredisussedin[6],inluding thebasiideasbehindastream\u00adbasedimplementation;in \n[10]thepartiularimplementationusedinthispaperisde\u00adsribedindetail. Itisworthnotingthatweonentratedhereonjustoneim\u00adplementationtehniqueforFRP;itmaywellbethatother \ntehniqueseitherhavemoreorfeweronstraintsthanthose disoveredforstreams.Inpartiular,itisworthpointing outthatintervalanalysisanbeusedtosafelyapturein\u00adstantaneousprediateevents[6,7]. \nFinally,wepointoutthatallofourresultsdependonsu\u00c6\u00adientaurayoftheunderlyingnumbersystemimplemen\u00adtation.Inthelimit,ofourse,thatrequiresanimplementa\u00adtionofexatrealarithmeti.Numerialanalysistehniques \nareultimatelyneededtoensurethestabilityofanysystem basedonfoating\u00adpointnumbers. CML(ConurrentML)formalizedsynhronousoperations \nasfrst\u00adlass,purelyfuntional,valuesalled.events\"[15]. Oureventombinators..I.\"and.==>\"orrespondto CML'shooseandwrapfuntions.Therearesubstantial \ndiferenes,however,betweenthemeaninggivento.events\" inthesetwoapproahes.InCML,eventsareultimatelyused \ntoperformanation,suhasreadinginputfromorwriting outputtoafleoranotherproess.Inontrast,ourevents areusedpurelyforthevaluestheygenerate.Thesevalues \noftenturnouttobebehaviors,althoughtheyanalsobe newevents,tuples,funtions,et. ConurrentHaskell[12]ontainsasmallsetofprimitives \nforexpliitonurreny,designedaroundHaskell'smonadi supportforI/O.Whilethissystemispurelyfuntionalin thetehnialsense,itssemantishasastronglyimperative \nfeel.Thatis,expressionsareevaluatedwithoutside\u00adefets toyieldonurrent,imperativeomputations,whihareex\u00adeutedtoperformtheimpliedside\u00adefets.Inontrast,mod\u00adelingentirebehaviorsasimpliitlyonurrentfuntionsof \nontinuoustimeyieldswhatweonsideramoredelarative feel. Severallanguageshavebeenproposedaroundthesynhronous \ndata-fownotionofomputation.Thegeneral\u00adpurposefun\u00adtionallanguageLuid[16]isanexampleofthisstyleoflan\u00adguage,butmoreimportantlyarethelanguagesSignal[8], \nLustre[4],andEsterel[2,3]whihwerespeifallydesigned forontrolofreal\u00adtimesystems.InSignal,themostfunda\u00admentalideaisthatofasignal,atime\u00adorderedsequeneof \nvalues.UnlikeFRP,however,timeisnotavalue,butrather isimpliitintheorderingofvaluesinasignal.Byitsvery \nnaturetimeisthusdisreteratherthanontinuous,with emphasisontherelativeorderingofvaluesinadata\u00adfow\u00adlikeframework.ThedesignersofSignalhavealsodeveloped \nalokaluluswithwhihoneanreasonaboutSignalpro\u00adgrams.LustreisalanguagesimilartoSignal,rootedagain inthenotionofasequene,andowingmuhofitsnature \ntoLuid. Esterelisperhapsthemostambitiouslanguageinthislass, forwhihompilersareavailablethattranslateEsterelpro\u00adgramsintofnitestatemahinesordigitaliruitsforem\u00adbeddedappliations.Moreimportantlyinrelationtoour \nurrentwork,alargeeforthasbeenmadetodevelopafor\u00admalsemantisforEsterel,inludingaonstrutivebehav\u00adioralsemantis,aonstrutiveoperationalsemantis,andan \neletrialsemantis(intheformofdigitaliruits).These semantisareshowntoorrespondinaertainway,on\u00adstrainedonlybyanotionofstability. \n10. ACKNOWLEDGEMENTS WewouldliketothankthePLDIrefereesfortheirinsight\u00adfulommentsandinstrutivefeedbak.Alsothankstoour \nfundingagenies,NSFthroughgrantsCCR\u00ad9706747and CCR\u00ad9900957,andDARPAthroughgrantF33615\u00ad99\u00adC\u00ad3013 administeredbytheAFOSR. \n11. REFERENCES [1]TomM.Apostol.MathematialAnalysis AModern ApproahtoAdvanedCalulus.Addison\u00adWesley, 1957. \n[2]GerardBerry.TheFoundationsofEsterel.MITPress, 1998. [3]GerardBerry.Theonstrutivesemantisofpure esteral(draftversion3).DraftVersion3,Eoledes \nMinesdeParisandINRIA,July1999. [4]P.Caspi,N.Halbwahs,D.Pilaud,andJ.A.Plaie. Lustre:Adelarativelanguageforprogramming \nsynhronoussystems.In14thACMSymp.on PriniplesofProgrammingLanguages,January1987. [5]ConalElliott.Modelinginterative3Dand \nmultimediaanimationwithanembeddedlanguage.In ProeedingsofthefrstonfereneonDomain-Speif Languages,pages285.296.USENIX,Otober1997. \n[6]ConalElliott.Funtionalimplementationsof ontinuousmodeledanimation.InProeedingsof PLILP/ALP'98.Springer\u00adVerlag,1998. \n [7]ConalElliottandPaulHudak.Funtionalreative animation.InInternationalConfereneonFuntional Programming,pages163.173,June1997. \n[8]ThierryGautier,PaulLeGuerni,andLoiBesnard. Signal:Adelarativelanguageforsynhronous programmingofreal\u00adtimesystems.InGillesKahn, \neditor,FuntionalProgrammingLanguagesand ComputerArhiteture,volume274ofLetNotesin ComputerSiene,editedbyGGGoosand1G \nHartmanis,pages257.277.Springer-Verlag,1987. [9]PaulHudak.Modulardomainspeiflanguagesand tools.InProeedingsofFifthInternationalConferene \nonSoftwareeuse,pages134.142.IEEEComputer Soiety,June1998. [10]PaulHudak.TheHaskellShoolofExpression LearningFuntionalProgrammingthroughMultimedia. \nCambridgeUniversityPress,NewYork,2000. [11]PaulHudak,SimonPeytonJones,andPhilipWadler (editors).ReportontheProgrammingLanguage \nHaskell,ANon-stritPurelyFuntionalLanguage (Version1.2).ACMSIGPLANNoties,27(5),May 1992. [12]SimonPeytonJones,AndrewGordon,andSigbjorn \nFinne.ConurrentHaskell.InACMSymposiumonthe PriniplesofProgrammingLanguages,St.Petersburg Beah,Florida,January1996. \n[13]JohnPeterson,GregoryHager,andPaulHudak.A languagefordelarativerobotiprogramming.In InternationalConfereneonobotisandAutomation, \n1999. [14]JohnPeterson,PaulHudak,andConalElliott. Lambdainmotion:ControllingrobotswithHaskell. InFirstInternationalWorkshoponPratialAspets \nofDelarativeLanguages.SIGPLAN,Jan1999. [15]JohnH.Reppy.CML:Ahigher-orderonurrent language.ProeedingsoftheACMSIGPLAN'91 \nConfereneonProgrammingLanguageDesignand Implementation,pages293.305,1991. [16]W.W.WadgeandE.A.Ashroft.Luid,theDatafow \nProgrammingLanguage.AademiPressU.K.,1985. APPENDIX  A. PROOF OF THEOREMS Wefrstpointoutthefollowingusefulpropertythatevery \nbehaviorandeventobserves: Defnition4G(n-equality)Givenanintegernandtwo listsllandl2,if lengthl?n,lengthl2?n,and \nl takenl takenl2, l thenwesaythatllandl2aren-equal,whihwewriteas . l l l2. LEMMA2.Llift1fbts mapf(bts)G \nPROOF. Llift1fbts (LliftOfL$*b)ts(defnitionoflift1) ()ts.zipWithL($)(LliftOfts)(bts))ts (defnitionof$*) \nzipWithL($)(LliftOfts)(bts) zipWithL($)(map(anstf)ts)(bts)  . (defnitionofliftO) mapf(bts) LEMMA3.Llift2fblb2ts \nzipWithf(blts)(b2ts)G Theproofisnothardandomitted. Theorem 1 PROOF.Forany0,let\u00c61,foranypj suhthat Ipj \nI\u00c6,wehave a[time]]pj at[ lastLtimepj at) (defnitionofa lastpj (defnitionoftime) t Hene a[time]]pj \n-t 0 at[. Theorem 2 PROOF.Forany0,let\u00c61,foranypj suhthat Ipj I\u00c6,wehave ata[[liftO] pj  lastLliftOpj \n lastLliftOLpj  lastmap(anstL)pj (defnitionofliftO) L a Heneat[[liftO] pj -L0. Theorem 3 PROOF. bj \nlimata[[b]]pj Ip.I-o Thus LEMMA1.ForanybEBehavioru),eEEventu),ts,ts'E .Lfbj [ime],andnEN,ts ts'impliesthat: \na at[[b]]pj Lf . Lbts Lbts',and lim .. Ip a Lfat[[b]]pj I-o . Lets Lets'G .. lim IpI-o ThisLemmaessentiallysaysthattheurrentvalueofabe\u00ad \nhaviororeventdoesnotdependonthefuture.Theproof I-o a at[[b]]pj ) (Lf .. isontinuousatlimIp ofthislemmaisanindutiononthesyntatistrutureof \nanFRPexpression. pj ) .. limLflast(Lb Ip I-o   a t I-0i=l Lf(LbP;j) =limlastmap IP I .P... at[[f]]Pai \nlim .tti = I-J IP Furthermore, ..   Llift1LfLbP;j =limlast I-J  a (lemma2) * at .tti-  dT  tr \ni=l ; a at[[f]]Pai [[f]]TT at* Theorem 4 a [[lift1fb]]Tt lim IPI-0 .. = IP   t I-0i=l  at[[f]]Pai \nI-0i=l at .tti\u00ad lim .. =   PROOF.ForanyE>0,sineLfisuniformlyontinuous, at* a [[f]]Tti.ttilim .. \n' thereisanT>0,suhthatforanyv,v,Iv-v'I<Timplies IP lim ILfv-Lfv'I<E.   t a t tlim<t.,eii IP .. a IP.. \nat[[f]]Pai-ata* [[f]]Tti.tti= thereisaata[[b]]P;j-fb(t) a at[[b]]P;j0,suhthatforeverytES,IP;jI Sine \nfb(t)uniformlyonS,fortheaboveT, I-0 . i=l implies \u00c6> <\u00c6 . <T I-0i=l . [[f]]T7uniformlyonvergeson[T,t], \nHeneforeverytES,IP;jI<\u00c6implies -a at[[f]]Paiat* [[f]]Ttiwhereei=  ffb(t)   a at[[lift1fb]]P;j a -L \n a a at*foreverygivenE>0,thereisa\u00c6>0,suhthataslongas    at[[f]]Pr ; Sine ;j ffb(t) . Lf<E at[[b]] \n= -L P IPrI<\u00c6, ;ei<E,forevery1<i<lengthP;r. Pr ThuswhenI;I<\u00c6,forevery7E[T,t] Corollary 1 wehave PROOF.Sine \n t at[[time]]P;j.tuniformlyon(-0,0) i=l t ei.tti<E.tti=E.(7-T)<E.(t-T) i=l (bytheorem1),andLsin=sinisuniformlyontinuous,we \na SineEisarbitrary,ata[[integralf]]Pruniformlyonverges ; have r at*[[f]]TT ;(a )dT.to Theorem 10 uniformlyon(-0,0)(bytheorem4). \nPROOF.Ifp[e]]Tt=[],thenthereisa\u00c6>0suhtha o*[t foreverypartitionP;jof[T,t]whereIP;jI<\u00c6,Aordingtothedefnitionofliftedsin: \njustValuesP;j(LeP;j)=[].Therefore a at[[lift1sintime]]P;j.sint   Lb'until'eP;j limlast >instaneFloatinga=>Floating(Behaviora)where \n>sin=lift1sin .. IP =limlast I-0   LbP;j a IP wehave (defnitionofuntil) ..a*at I-0 time]]P;j.sintuniformlyon(-0,0). \nat[[sin [[b]]Tt =  pp thenforapartitionP=[T0,Tl,,Tt]of[T,t],whenIPI E[T,t], Pk o*[[e]]Tt=[(tl,Lbl),,(tm,Lbm)], \nIfwherem>0, Theorem 7 PROOF.Forany7 issmallenough,justValuesP(LeP)willhavemele\u00adments.Letthefrstofthemelementsbe(Tk,Lb'),and \n a .... IP =limlast(LintegralfPr ;) IP at[[integralf]]PrwherePr=[tJ,tl,,tt]. ;,; lim I\u00ad t],then J =[Tk,Tk+l,,T \nlimlast(Lb'until'eP) I-0 IPI-0  b'  p Pk  t I-0i=l   =limlast IPI-0 LfP;r .tti,wheretti .. lim \nIP =ti-ti-l. = (i) a (defnitionofuntil) at* (defnitionofintegral) lim[[bl]] Tt =  t =limlastLfPai.tti, \n   }-j. IP .. I-0 i=l wherePai=takeiPr(lemma1) ;. 252  \n\t\t\t", "proc_id": "349299", "abstract": "<p><italic>Functional Reactive Programming</italic>, or <italic>FRP</italic>, is a general framework for programming hybrid systems in a high-level, declarative manner. The key ideas in FRP are its notions of <italic>behaviors</italic> and <italic>events</italic>. Behaviors are time-varying, reactive values, while events are time-ordered sequences of discrete-time event occurrences. FRP is the essence of <italic>Fran</italic>, a domain-specific language embedded in Haskell for programming reactive animations, but FRP is now also being used in vision, robotics and other control systems applications. </p><p>In this paper we explore the formal semantics of FRP and how itrelates to an implementation based on <italic>streams</italic> that represent (and therefore only approximate) continuous behaviors. We show that, in the limit as the sampling interval goes to zero, the implementation is faithful to the formal, continuous semantics, but only when certain constraints on behaviors are observed. We explore the nature of these constraints, which vary amongst the FRP primitives. Our results show both the power and limitations of this approach to language design and implementation. As an example of a limitation, we show that streams are incapable of representing instantaneous predicate events over behaviors.</p>", "authors": [{"name": "Zhanyong Wan", "author_profile_id": "81100388303", "affiliation": "Yale University, Department of Computer Science, P.O. Box 208285, New Haven, Connecticut", "person_id": "P309663", "email_address": "", "orcid_id": ""}, {"name": "Paul Hudak", "author_profile_id": "81100539650", "affiliation": "Yale University, Department of Computer Science, P.O. Box 208285, New Haven, Connecticut", "person_id": "PP40028396", "email_address": "", "orcid_id": ""}], "doi_number": "10.1145/349299.349331", "year": "2000", "article_id": "349331", "conference": "PLDI", "title": "Functional reactive programming from first principles", "url": "http://dl.acm.org/citation.cfm?id=349331"}