{"article_publication_date": "01-08-2014", "fulltext": "\n Parametric Completeness for Separation Theories James Brotherston Jules Villard Dept. of Computer Science, \nUniversity College London, UK Abstract In this paper, we close the logical gap between provability in \nthe logic BBI, which is the propositional basis for separation logic, and validity in an intended class \nof separation models, as employed in applications of separation logic such as program veri.cation. An \nintended class of separation models is usually speci.ed by a collection of axioms describing the speci.c \nmodel properties that are expected to hold, which we call a separation theory. Our main contributions \nare as follows. First, we show that sev\u00aderal typical properties of separation theories are not de.nable \nin BBI. Second, we show that these properties become de.nable in a suitable hybrid extension of BBI, \nobtained by adding a theory of naming to BBI in the same way that hybrid logic extends normal modal logic. \nThe binder-free extension HyBBI captures most of the properties we consider, and the full extension HyBBI(.) \nwith the usual . binder of hybrid logic covers all these properties. Third, we present an axiomatic proof \nsystem for our hybrid logic whose extension with any set of pure axioms is sound and complete with respect \nto the models satisfying those axioms. As a corollary of this general result, we obtain, in a parametric \nmanner, a sound and com\u00adplete axiomatic proof system for any separation theory from our considered class. \nTo the best of our knowledge, this class includes all separation theories appearing in the published \nliterature. Categories and Subject Descriptors F.3.1 [Logics and Mean\u00adings of Programs]: Specifying and \nVerifying and Reasoning about Programs Logics of programs; F.4.1 [Mathematical Logic and Formal Languages]: \nMathematical Logic Model theory, Proof theory, Modal logic General Terms Theory, veri.cation Keywords \nBunched logic, separation logic, hybrid logic 1. Introduction Essentially, all models are wrong, but \nsome are useful. G. E. P. Box and N. R. Draper [3], 1987 In mathematical logic, there is a notable tension \nbetween provabil\u00adity in a deductive system which typically captures validity in some general class of \nmodels of the underlying logic and valid\u00adity in the intended model(s) of practical or theoretical interest. \nFor Permission to make digital or hard copies of part or all of this work for personal or classroom use \nis granted without fee provided that copies are not made or distributed for pro.t or commercial advantage \nand that copies bear this notice and the full citation on the .rst page. Copyrights for third-party components \nof this work must be honored. For all other uses, contact the owner/author(s). POPL 14, January 22 24, \n2014, San Diego, CA, USA. Copyright is held by the owner/author(s). ACM 978-1-4503-2544-8/14/01. http://dx.doi.org/10.1145/2535838.2535844 \n example, as famously demonstrated by G \u00a8odel [15], there are state\u00ad ments of Peano arithmetic (PA) that \nhold in its intended model, i.e. the natural numbers N, but not in all of its possible models, and so \nthese statements are not provable in PA. This incompleteness of logical proof systems with respect to \na particular choice of in\u00adtended model(s) is unavoidable for suf.ciently expressive systems. In other \ncases, it might happen that a logical system is complete but insuf.ciently expressive to capture the \ninteresting properties of the intended model; that is, some mathematical property of the model cannot \nbe expressed by any formula of the logical language (in which case we say that the intended models are \nnot de.nable or ax\u00adiomatisable within the system). Thus, when formulating a logical system, there are \nat least two natural and essentially independent questions: .rst, whether the language of the system \nis expressive enough to axiomatise the intended models; and, second, whether the system is complete for \nvalidity in these intended models. In this paper, we consider these questions in the context of sep\u00adaration \nlogic, an established formalism for reasoning about heap\u00admanipulating programs [24, 6, 26]. The purely \npropositional part of separation logic is usually considered to be given by Boolean BI (from now on BBI), \nwhich is a particular .avour of bunched logic obtained by freely combining the connectives of multiplicative \nin\u00adtuitionistic linear logic with those of standard classical logic [18, 23]. Provability in BBI corresponds \nto validity in the general class of relational commutative monoids [14]. Applications of separa\u00ad tion \nlogic, on the other hand, typically deal with speci.c such mod\u00adels, or classes thereof, based on the \ncomposition of heaps (see [5] for a survey of the models used in practice). Unsurprisingly, these heap \nmodels exhibit various interesting mathematical properties that are not true of all relational commutative \nmonoids, and thus are not captured by provability in BBI. For example, composition of disjoint heaps \nis a cancellative partial (binary) function, which is a special case of the ternary relation in a relational \ncommutative monoid. Various collections of such properties have been advanced in the literature as abstractions \nover concrete heap models, suitable for program analysis, under the common name of separation alge\u00adbra \n[8, 12, 11]. We list the model properties commonly found in the literature in De.nition 3.1, and call \na given collection of such properties a separation theory. Our aim is to obtain logical proof systems \nin which provability accurately captures (validity in) the class of models determined by a separation \ntheory (and preferably by adding as little extra machinery as possible to BBI). In this paper, we make \nthree main contributions: First, we show in Section 3 that BBI is insuf.ciently expressive to axiomatise \nmost separation theories. Speci.cally, we show that several commonly considered model properties are \nnot de.nable by any BBI-formula (e.g., partial functionality and/or cancellativity of the composition \noperation). Unde.nability of a property means that the logic is fundamentally incapable of distinguishing \nmodels with the property from those without it. In particular, we .nd that none of the three different \nclasses of separation algebras found in the literature [8, 12, 11] are de.nable in BBI.  Second, we \nintroduce in Section 4 a simple hybrid extension HyBBI of BBI, which bears the same relation to BBI as \nnor\u00admal hybrid logic does to normal modal logic (see [1, 2] for an overview). That is, HyBBI extends \nBBI with a theory of naming: we introduce a second sort of atoms, called nominals, which are interpreted \nas individual states in a model; and we also add a unary hybrid modality @e (parameterised by the nominal \ne), so that the hybrid formula @eA is satis.ed at any world in a model just when A is satis.ed at the \nworld denoted by the nominal e. Despite the simplicity of this extension, which is conservative over \nstandard BBI, the hybrid logic HyBBI is expressive enough to de.ne most of the separation theories we \nconsider, including in particular all three concepts of separation algebras from the lit\u00aderature [8, \n12, 11]. However, for more complex model properties such as the cross-split property of [12], still more \nexpressivity is required: we show in Section 7 how to gain this expressivity by adding the . binder of \nhybrid logic to HyBBI.  Third, we provide a Hilbert-style axiomatic proof system for HyBBI that is parametrically \nsound and complete with respect to any given separation theory. That is, whenever the proof system is \nextended with the axioms de.ning a separation theory, the resulting extension is sound and complete with \nrespect to the class of models determined by that theory. (E.g., by adding the axiom de.ning can\u00adcellativity, \nwe obtain a sound and complete proof theory for can\u00adcellative models.) Such axiomatic proof systems provide \na useful proof-theoretic characterisation of validity in separation theories which can be used as a baseline \nfor, e.g., tableau or sequent-style proof systems.  We present the axiom system and its soundness result \nin Section 5, and give the completeness theorem in Section 6. Section 7 extends these results to HyBBI \nwith the . binder. Related work. Most of our technical results are obtained by adap\u00adtations of techniques \nfrom modal and hybrid logic. This should come as no surprise, since bunched logics can quite straightfor\u00adwardly \nbe seen as modal logics; indeed, this view has been ex\u00adploited previously in the literature on bunched \nlogic, e.g. to obtain completeness results [7, 4]. However, as far as we know, this pa\u00adper represents \nthe .rst explicit introduction of hybrid logic into the setting of (abstract) separation logic. In particular, \nprevious work on hybrid logics has seemingly been con.ned to modal logic with unary modalities connected \nby De Morgan duality, whereas in this setting we consider the case of binary modalities connected by \nresiduation. Interestingly, the key concept from hybrid logic, i.e. the explicit naming of elements in \nthe underlying model, has been used im\u00adplicitly several times in the literature on the proof theory of \nBBI. For example, the labelled tableau system for BBI [20], which was recently proven complete for partial \nfunctional BBI-models [19], relies on a system of semantic labels which pick out individual model states \nin much the same way as nominal atoms in hybrid logic. Even more recently, labelled nested [22] and non-nested \n[17] sequent calculi for BBI have appeared, employing semantic labels in a broadly similar way. While \nsuch works add names or labels to proof systems as auxiliary tools for simplifying proof search in standard \nBBI, here we consider these features to be .rst-class com\u00adponents of the logic. Indeed, we believe that \nit should be possible to adapt the labelled proof systems in the literature to yield cut-free proof theories \nfor our hybrid extensions of BBI. In a similar vein, the explicit naming of heaps arises naturally in \nseveral extensions of separation logic as an aid to practical program veri.cation. Reynolds conjectured \nthat referring explicitly to the current heap in speci.cations would allow one to verify programs that \nmanipulate data structures with sharing, such as graphs [25]. Duck et al. recently vindicated this claim \nby providing automatic veri.cation techniques for such programs, where speci.cations are written using \na constraint language based on separation logic with explicit heaps [13]. In an independent line of research, \nDavid and Chin introduced immutable speci.cations [10], which extend sep\u00adaration logic to support the \ntagging of certain parts of the heap as immutable. This can be viewed as adding a heap label in the pre\u00adcondition \nof a command, corresponding to the immutable part, and asserting the same heap label in the postcondition. \nThe hybrid log\u00adics introduced in this paper can be seen as providing a common formal foundation for adding \nexplicit heap atoms and modalities to separation logic-based veri.cation. Our main focus here is on the \nprecise expressivity of these logics. 2. Syntax and semantics of BBI In this section, we introduce formulas \nof BBI and their Kripke semantics, given by relational commutative monoids (cf. [14]). De.nition 2.1 \n(BBI-formula). Let V be a countably in.nite set of propositional variables. BBI-formulas are built from \npropositional variables P . V using the usual connectives (T, ., \u00ac, ., ., .) of classical logic, and \nthe so-called multiplicative connectives, consisting of the constant I and binary operators * and - *. \nBy convention, \u00ac has the highest precedence, followed by *, . and ., with . and - * having lowest precedence. \nDe.nition 2.2 (BBI frames and models). A BBI-frame is a a tuple (W, ., E), where W is a set (of worlds \n), . : W \u00d7 W . P(W ) and E . W . We extend . pointwise to P(W )\u00d7P(W ) . P(W ): def W1 . W2 = w1 . w2 \nw1.W1,w2.W2 A BBI-frame (W, ., E) is a BBI-model if . is commutative and associative, and w . E = {w} \nfor all w . W (that is, w . e . {w}for all e . E and w . e = {w} for some e . E). We call E the set of \nunits of the model (W, ., E). De.nition 2.3 (BBI-validity). Let M = (W, ., E) be a BBI\u00adframe. A valuation \nfor M is a function . that assigns to each propositional variable P . V a set .(P ) . W . Given any valuation \n. for M , any w . W and any BBI-formula A, we de.ne the forcing relation M, w |=. A by induction on A: \nM, w |=. P . w . .(P ) M, w |=. T always M, w |=. . never M, w |=. \u00acA . M, w |=. A M, w |=. A1 . A2 . \nM, w |=. A1 and M, w |=. A2 M, w |=. A1 . A2 . M, w |=. A1 or M, w |=. A2 M, w |=. A1 . A2 . M, w |=. \nA1 implies M, w |=. A2 M, w |=. I . w . E M, w |=. A1 * A2 . .w1, w2 . W. w . w1 . w2 and M, w1 |=. A1 \nand M, w2 |=. A2 \" \"\" . w . w M, w |=. A1 - * A2 . .w, w\"\" . W. if w\" and M, w\" |= . A1 then M, w\"\" |= \n. A2 A is said to be valid in M if M, w |= . A for all valuations . and for all w . W . A is valid if \nit is valid in all BBI-models. De.nition 2.4. We de.ne KBBI to be the proof system obtained by extending \na complete Hilbert system for classical logic with the following axioms and inference rules for *, - \n* and I (where A f B is syntactic sugar for the formula A . B): A * B f B * A A * (B * C) f (A * B) * \nC A f A * I A * I f A A1 f B1 A2 f B2 A * B f C A f B - * C A1 * A2 f B1 * B2 A f B - * C A * B f C \n Galmiche and Larchey-Wendling showed [14] that KBBI is sound and complete with respect to single-unit \nBBI-models, where the set of units is a singleton (cf. De.nition 3.1). The corresponding result for our \nmulti-unit setting is an easy corollary. Theorem 2.5. A BBI-formula is KBBI-provable iff it is valid. \n3. De.nable and unde.nable properties in BBI In this section, we review a number of interesting properties \nof BBI-models encountered in the literature on separation logic, and examine whether or not these properties \ncan be axiomatised, or de\u00ad.ned, by formulas of BBI. Speci.cally, we show that several such properties \nare not de.nable in BBI, by showing that they are not generally preserved by validity-preserving model \nconstructions. De.nition 3.1 (Separation theories). Letting M = (W, ., E) be a BBI-model, we introduce \nthe following properties of interest: Partial functionality: w, w \" . w1 . w2 implies w = w \" ; Cancellativity: \n(w . w1) n (w . w2) = \u00d8 implies w1 = w2; Single unit: |E| = 1, i.e. w, w \" . E implies w = w \" ; Indivisible \nunits: (w . w \" ) n E = \u00d8 implies w . E; Disjointness: w . w = \u00d8 implies w . E; Divisibility: for every \nw . E there are w1, w2 ./E such that w . w1 . w2; Cross-split property: whenever (t . u) n (v . w) = \n\u00d8, there exist tv, tw, uv, uw such that t . tv . tw, u . uv . uw, v . tv . uv and w . tw . uw. Any given \ncollection of model properties from the above list is called a separation theory. All the above axioms \nare true of standard heap models with the exception of divisibility, which arises naturally in models \nwith frac\u00adtional permissions. The signi.cance of the individual properties is explained in more detail \nin [12] (where disjointness and divisibil\u00ad ity are referred to as positivity and splittability respectively). \nVarious different separation theories have been considered in the literature on separation logic. For \nexample, a BBI-model that is both partial functional and cancellative is called a separation alge\u00adbra \nin [12], while in [8] the same term de.nes a BBI-model that is partial functional and cancellative with \na single unit, and in the views framework of [11] the same term again refers to a BBI\u00admodel that is simply \npartial functional. De.nability in BBI. We now examine which of the characteris\u00adtics of separation theories \nare de.nable within BBI. We abuse no\u00adtation slightly by identifying a property of BBI-models with the \nclass of BBI-models satisfying that property. De.nition 3.2 (De.nability). Given a language L of formulas, \na property P of BBI-models is said to be L-de.nable if there exists an L-formula A such that for all \nBBI-models M, A is valid in M .. M . P . We remark that de.nability could equally well be de.ned on BBI-frames, \nnot just BBI-models. Note that the property of being a BBI-model, among all frames, is itself BBI-de.nable: \ntake as the de.ning formula the conjunction of the top four axioms in De.nition 2.4 (which de.ne associativity, \ncommutativity and the unit law E . w = {w}). However, we shall be concerned mainly with the properties \nof BBI-models listed in De.nition 3.1. Proposition 3.3. The indivisible units property and the divisibility \nproperty are both BBI-de.nable, as follows: Indivisible units: I . (A * B) f A (iu) Divisibility: \u00acI \nf \u00acI * \u00acI (div) Proof. The case of the indivisible units property is shown in [5]. For the case of divisibility, \nwe proceed as follows: (.) Assume that M is divisible, let . be a valuation for M and let w . W . To \nshow that (div) is valid, we suppose that M, w |=. \u00acI, i.e., that w ./E, and require to show that M, \nw |=. \u00acI * \u00acI. Di\u00advisibility gives us w1, w2 . W \\ E such that w . w1 . w2; thus, M, w |=. \u00acI * \u00acI. (.) \nAssume that (div) is valid in M, and suppose that w . W \\E. Then, M, w |= . \u00acI, hence we have M, w |= \n. \u00acI * \u00acI by validity of (div). This gives us w1, w2 such that w . w1 . w2 where M, w1 |= . \u00acI and M, \nw2 |= . \u00acI, i.e. w1, w2 ./E as required. Unde.nability in BBI. Here we show that four of the properties \nof Defn. 3.1 are not de.nable in BBI: partial functionality, cancella\u00ad tivity, disjointness and single \nunit. First, we introduce the bounded morphic image and disjoint union constructions for BBI-models and \nshow that they preserve validity in a given model, which mir\u00adrors the situation arising from their analogues \nin modal logic [1]. Our unde.nability results follow from the fact that the .rst three of the above properties \nare not preserved by bounded morphic images, while the last one is not preserved by disjoint unions. \nDe.nition 3.4 (Bounded morphic image). Let M = (W, ., E ) and M \" = (W \" , . \" , E \" ) be BBI-models. \nA bounded morphism from M to M \" is a function f : W . W \" satisfying the following: 1. w . E iff f(w) \n. E \" ; 2. w . w1 . w2 implies f(w) . f(w1) . \" f(w2); 3. f(w) . w1 \" . \" w2 \" implies .w1, w2 . W. \nw . w1 . w2 and f(w1) = w1 \" and f(w2) = w2 \" ; 4. w2 \" . f(w) . \" w1 \" implies .w1, w2 . W. w2 . w \n. w1 and f(w1) = w1 \" and f(w2) = w2 \" ;  We say M \" is a bounded morphic image of M, written M _ M \n\" , if there is a surjective bounded morphism from M to M \" . Lemma 3.5. Let M and M \" be BBI-models \nwith M _ M \". Then any BBI-formula valid in M is also valid in M \" . Proof. We write M = (W, ., E) and \nM \" = (W \" , . \" , E \" ), and let f : W . W \" be a surjective bounded morphism from M to M \". Suppose \nfor contradiction that A is valid in M, but not in M \" . \" \"\" Thus there exists a valuation . \" for M \nand w . W such that M \" , w \" |= .1 A. We de.ne a valuation . for M as follows: def \" .(P ) = {w . W \n| f(w) . . (P )} As f is surjective, there is a w . W such that w \" = f(w). To obtain the required contradiction, \nwe claim that M, w |=. A. To show this claim, we prove by structural induction on A that for all w . \nW , we have M, w |=. A if and only if M \" , f (w) |= .1 A. We omit the cases for the classical connectives, \nas they are straightfor\u00adward by induction hypothesis. Case A = P . V . Using the de.nition of ., we have \nas required: M, w |=. A . w . .(P ) . f (w) . . \" (P ) . M \" , f (w) |= .1 P  Case A = I. Using condition \n1 in Defn. 3.4, we have as required: M, w |=. I . w . E . f(w) . E \" . M \" , f (w) |= .1 I Case A = B \n* C. (.) Supposing that M, w |= . B * C, we have w . w1 . w2 with M, w1 |= . B and M, w2 |= . C. Us\u00ading \ncondition 2 in Defn. 3.4, we have f (w) . f (w1) . \" f(w2). Furthermore, by induction hypothesis, M \" \n, f (w1) |= .1 B and M \" , f (w2) |= .1 C. Thus M \" , f (w) |= .1 B * C as required.  (.) Supposing \nthat M \" , f(w) |= .1 B * C, we have f(w) . \"\" \"\" \"\" w1 . \" w2 with M , w1 |= .1 B and M , w2 |= .1 C. \nBy condition 3 in Defn. 3.4, there are w1, w2 . W with w . w1 . w2 and f(w1) = w1 \" and f(w2) = w2 \" \n. Thus, by the induction hypothesis, we have M, w1 |= . B and M, w2 |= . C. Hence M, w |= . B * C. Case \nA = B - * C. (.) Suppose M, w |=. B - * C. To show \" \"\" that M , f(w) |= .1 B - * C, we assume that w2 \n. f(w) . \" w1 \"\" \"\" and M , w1 |= .1 B, and must show M , w2 |= .1 C. By condition 4 in Defn. 3.4, there \nare w1, w2 . W with w2 . w . w1 and f(w1) = w1 \" and f(w2) = w2 \" . Thus, by the induction hypothesis, \nM, w1 |=. B. Since M, w |=. B - * C, we obtain M, w2 |=. C, which yields the required M \" , w2 \" |= .1 \nC by induction hypothesis. (.) Suppose M \" , f(w) |= .1 B - * C. To show that M, w |=. B - * C, we assume \nthat w2 . w . w1 and M, w1 |= . B, and must show M, w2 |= . C. By condition 2 in Defn. 3.4, we have f(w2) \n. f(w) . f(w1), and by induction hypothesis we have M \" , f(w1) |= .1 B. Since M \" , f(w) |= .1 B - * \nC, we obtain M \" , f(w2) |= .1 C, which then yields the required M, w2 |=. C using the induction hypothesis. \nThis completes all cases. Lemma 3.6. Let P be a property of BBI-models, and let M, M \" be BBI-models \nsuch that M . P, M \" . P and M _ M \" . Then P is not BBI-de.nable. Proof. Suppose for contradiction that \nthe BBI-formula A is valid in exactly those BBI-models with property P. Then A is valid in M. By Lemma \n3.5, A must be valid in M \" , since M _ M \" . Hence M \" . P, contradicting the assumption that M \" . \nP. In fact, Lemma 3.6 applies to BBI-frames as well as BBI\u00admodels, and implies that if M _ M \" and M \nis a BBI-model, then so is M \" . Otherwise the class of all BBI-models would not be BBI-de.nable among \nall BBI-frames, contradiction. The following result shows that separation algebras as de.ned by the views \nframework [11] are not BBI-de.nable. Theorem 3.7. Partial functionality is not BBI-de.nable. Proof. By \nLemma 3.6, it suf.ces to exhibit a pair of BBI-models M and M \" such that M is partial functional, M \n\" is not partial functional and M _ M \" . We de.ne BBI-models M = (W, ., E)and M \" = (W \" , . \" , E \" \n) as follows: def def W = {e, v1, v2, x1, x2, y, z} E = {e} def w . e = e . w = {w} for all w . W def \ndef x1 . v1 = v1 . x1 = {y} x1 . v2 = v2 . x1 = {y} def def x2 . v1 = v1 . x2 = {z} x2 . v2 = v2 . x2 \n= {z} def def W \" = {e, v, x, y, z} E \" = {e} def w . \" e = e . \" w = {w} for all w . W \" def x . \" v \n= v . \" x = {y, z} def with w1 . w2 = w1 . \" w2 = \u00d8 for all other w1 and w2. First, we verify that M \nand M \" are indeed BBI-models. Com\u00admutativity and the unit law hold in both models by construc\u00adtion. \nAssociativity of . and . \" is straightforward to check since w1 . (w2 . w3) and w1 . \" (w2 . \" w3) are \nalways empty unless one of w1, w2, w3 is e. Next, we note that M is partial functional since |w1 . w2| \n= 1 for all w1, w2 . W by construction, whereas M \" is not partial functional since z, y . x . \" v but \nz = y. Finally, we claim that M _ M \" , i.e., that there is a surjective bounded morphism from M to M \n\" . De.ne f : W . W \" by: def def f (v1) = f(v2) = v f(x1) = f(x2) = x def f(w) = w (w . {e, y, z}) Clearly \nf is surjective, so it just remains to check the four bounded morphism conditions in De.nition 3.4: 1. \nTrivial, since E = E \" = {e} and f(e) = e. 2. We just check that every membership statement in the de.nition \nof . maps under f to a corresponding membership statement in the de.nition of . \" . E.g., since y . x1 \n. v2, we need to check that f(y) . f(x1) . \" f (v2), i.e., y . x . \" v, which is the case. 3. We need \nto check that every membership statement f(w) . w1 \" . w2 \" in the de.nition of . \" can be traced back \nunder f to a corresponding membership statement in the de.nition of .. E.g., since f(z) . x. \" v, we \nneed w1, w2 such that z . w1 .w2 and f(w1) = x, f(w2) = v. By taking, say, w1 = x2 and w2 = v2, we are \ndone. 4. Similar to item 3 above, but for membership statements of the form w2 \" . f(w) . w1 \" . E.g., \nsince y . f(v2) . \" x, we need w1, w2 such that w2 . v2 . w1 and f(w1) = x, f (w2) = y. By taking w1 \n= x1, w2 = y we are done.  We remark that there is no a priori connection between de.n\u00adability of a \nproperty on the one hand, and the existence of complete proof systems for models having the property \non the other. In par\u00adticular, Theorem 3.7 says nothing about the existence of proof theo\u00adries for BBI \nthat are complete for partial functional models. In fact, Larchey-Wendling and Galmiche showed in [21] \nthat KBBI is in\u00adcomplete for such models. What Theorem 3.7 shows in addition is that, if one were to \nadd (perhaps in.nitely many) axioms to KBBI so as to obtain a complete system for partial functional \nmodels, then provability in this system still would not exclude all models that are not partial functional. \nOne can contrast this situation, e.g., with that of KBBI s commutativity axiom A * B f B * A, which is \neasily seen to de.ne commutativity and therefore to exclude all non-commutative models. Theorem 3.8. \nCancellativity is not BBI-de.nable. Proof. By Lemma 3.6, it suf.ces to exhibit a pair of BBI-models M \nand M \" such that M is cancellative, M \" is not cancellative and M _ M \" . We de.ne BBI-models M = (W, \n., E) and M \" = (W \" , . \" , E \" ) as follows: def def W = {e, v1, v2, x, y, z1, z2} E = {e} def w . \ne = e . w = {w} for all w . W def def x . v1 = v1 . x = {z1} x . v2 = v2 . x = {z2} def def y . v1 = \nv1 . y = {z2} y . v2 = v2 . y = {z1} def def W \" = {e, x, v, y, z} E \" = {e} def w . \" e = e . \" w = \n{w} for all w . W \" def v . \" x = x . \" v = v . \" y = y . \" v = {z} def with w1 . w2 = w1 . \" w2 = \u00d8 \nfor all other w1 and w2. First, it is straightforward to verify that M and M \" are indeed BBI-models, \nwith associativity holding because w1.(w2.w3) = \u00d8 implies one of w1, w2, w3 is e (and similarly for . \n\"). Next, we note that M is cancellative because, by construction, w \" . (w . w1) n (w . w2) implies \nw1 = w2. On the other hand, M \" is not cancellative, for z . (v . \" x) n (v . \" y) but x = y. Finally, \nwe need a surjective bounded morphism from M to M \" . We de.ne a map f : W . W \" by def def f(v1) = f(v2) \n= v f(z1) = f(z2) = z def f(w) = w (w . {e, x, y}) The veri.cation that f is indeed a surjective bounded \nmorphism is similar to that in the proof of Theorem 3.7.  Notice that the proof of Theorem 3.8 in fact \nmaps a model that is both partial functional and cancellative with a single unit to a non\u00adcancellative \nmodel. Thus, it also establishes that neither the class of models that are partial functional and cancellative \n(the separation algebras of [12]) nor the subclass of such models having a single unit (the separation \nalgebras of [8]) are BBI-de.nable. Theorem 3.9. Disjointness is not BBI-de.nable. Proof. By Lemma 3.6, \nit suf.ces to exhibit a pair of BBI-models M and M \" such that M is disjoint, M \" is not and M _ M \". \nWe de.ne BBI-models M = (W, ., E ) and M \" = (W \" , . \" , E \" ) by: def def W = {e, x, y} E = {e} def \nw . e = e . w = {w} for all w . W def x . y = y . x = {x, y} def def W \" = {e, x} E \" = {e} def w . \" \ne = e . \" w = {w} for all w . W def x . \" x = {x} = w1 . \" def with w1 . w2 w2 = \u00d8 for all other w1 and \nw2. Similar to the previous Theorems 3.7 and 3.8, we can easily verify that M and M \" are indeed BBI-models, \nwith M disjoint by construction, whereas M \" is not disjoint since x = e and x. \" x = \u00d8. We de.ne a surjective \nbounded morphism f from M to M \" by def def def f(e) = e f(x) = x f (y) = x It just remains to check \nthe bounded morphism conditions, which is similar to the veri.cations in Theorems 3.7 and 3.8. The fact \nthat the single-unit property is not BBI-de.nable is a straightforward consequence of existing completeness \nresults. We also present a direct proof for pedagogical interest. Theorem 3.10. The single-unit property \nis not BBI-de.nable. Proof. The result can be deduced from the completeness result for single-unit BBI-models \nin [14]. Suppose for contradiction that the single-unit property is de.nable by the formula A. Then, \nby com\u00adpleteness, A is provable in KBBI. Hence, by soundness (Theo\u00adrem 2.5), A is valid in all BBI-models, \nsome of which fail to have the single-unit property. Theorem 3.10 can also be shown more directly: we \nshow that the single-unit property is not preserved under the following dis\u00adjoint union construction, \nwhich preserves validity. De.nition 3.11 (Disjoint union). Let M1 = (W1, .1, E1), M2 = (W2, .2, E2) be \nBBI-models, where W1 and W2 are disjoint sets. Then M1 l M2, the disjoint union of M1 and M2 is de.ned \nas def M1 l M2 = (W1 . W2, .1 . .2, E1 . E2) where .1 . .2 : (W1 . W2) \u00d7 (W1 . W2) . P (W1 . W2) is de.ned \nas .i on Wi\u00d7Wi and unde.ned on W1 \u00d7W2 and W2 \u00d7W1. Lemma 3.12. Let M1, M2 be BBI-models. Then any BBI-formula \nvalid in both M1 and M2 is also valid in M1 l M2. Proof. We write M1 = (W1, .1, E1) and M2 = (W2, .2, \nE2). Suppose for contradiction that A is valid in M1 and M2, but not in M1 l M2. Thus there exists a \nvaluation . and w . W1 . W2 such that M1 l M2, w |=. A. We show the case where w . W1; the case w . W2 \nis similar. We de.ne a valuation .1 for M1 by def .1(P ) = .(P ) n M1 To obtain the required contradiction, \nwe claim that M1, w |=.1 A (contradicting the supposition that A is valid in M1). To show this claim, \nwe prove that for all w . W1, we have M1, w |= .1 A if and only if M1 l M2, w |= . A. This is easily \nestablished by a straightforward structural induction on A, which we omit. Lemma 3.13. Let P be a property \nof BBI-models, and suppose that there exist BBI-models M1 and M2 such that M1, M2 . P but M1 l M2 . P \n. Then P is not BBI-de.nable. Proof. Similar to the proof of Lemma 3.6. Note that it is straightforward \nto show that if M1 and M2 are BBI-models then so is M1 l M2. (Alternatively, similarly to Lemma 3.6, \nLemma 3.13 implies that otherwise BBI-models would be unde.nable among all BBI-frames, contradiction.) \nAlternative proof of Theorem 3.10. Let M1 = (N, +, {0}) and M2 = (N \" , + \" , {0 \" }) be disjoint, isomorphic \ncopies of the monoid of natural numbers under addition. M1 and M2 are both single-unit BBI-models, but \nM1 lM2 is not, as its set of units is {0, 0 \" }. Thus, by Lemma 3.13, the single-unit property is not \nBBI-de.nable. We have not yet considered the cross-split property from De.\u00adnition 3.1. In Section 7, \nwe show that this property is de.nable in a relatively strong hybrid extension of BBI including a binder \n(see Proposition 7.3). The complication of expressing the property even in that logic leads us to strongly \nsuspect it is not de.nable in BBI. Conjecture 3.14. The cross-split property is not BBI-de.nable. Cross-split \nis seemingly preserved by bounded morphic images, disjoint unions and by generated submodels (cf. [1]). \nWe believe it should be possible to show its unde.nability in BBI by employing a model construction based \non ultra.lter extensions (cf. [1]), but that is beyond the scope of the present paper. 4. HyBBI: a basic \nhybrid extension of BBI In this section, we present an extension of BBI, called HyBBI, based upon a simple \nfragment of hybrid logic [1, 2]. This exten\u00ad sion allows us to refer to individual elements of the underlying \nBBI-model (as opposed to sets of elements, as denoted by BBI\u00adformulas) by introducing a second sort of \npropositional variables called nominals. We also introduce a new modality, @e, enabling us to evaluate \na formula at the world denoted by the nominal e. The additional expressivity of HyBBI enables us to de.ne \nthe separa\u00adtion theory properties shown in the previous section to be unde.n\u00adable in BBI. De.nition 4.1 \n(HyBBI-formula). We assume a .xed, denumer\u00adably in.nite set N of nominals, disjoint from the propositional \nvariables. We write lower case letters j, k, e etc. for nominals to distinguish them from propositional \nvariables. A HyBBI-formula is de.ned as a BBI-formula (Defn. 2.1), except that (a) any nomi\u00ad nal e . \nN counts as an atomic HyBBI-formula, and (b) if A is a HyBBI-formula and e a nominal then @eA is a HyBBI-formula. \nA HyBBI-formula is said to be pure if it contains no proposi\u00adtional (or formula) variables. De.nition \n4.2 (HyBBI-validity). A hybrid valuation . for a BBI\u00admodel M = (W, ., E) extends a standard valuation \n(see Defn. 2.3) by additionally mapping every nominal e . N to an element .(e) . W . Given any hybrid \nvaluation . for M, any w . W and a HyBBI-formula A, we de.ne the forcing relation M, w |=. A by extending \nthe de.nition of the forcing relation in Defn. 2.3 with the following clauses for nominals and the @e \nmodality: M, w |= . e . w = .(e) M, w |= . @eA . M, .(e) |= . A  A is then said to be valid in M if \nM, w |= . A for all hybrid valuations . and all w . W (and simply valid if it is valid in all BBI-models). \nWe observe that HyBBI is a conservative extension of BBI; that is, every BBI-formula A is valid according \nto De.nition 2.3 if and only if it is valid according to De.nition 4.2 (because the forcing relations \nin the two de.nition coincide on BBI-formulas). Thus every property of BBI-models de.nable in BBI, in \nparticular those described in Proposition 3.3, is also de.nable in HyBBI. However, HyBBI is strictly \nmore expressive than BBI: several properties not de.nable in BBI become de.nable in HyBBI. Theorem 4.3. \nThe following properties from De.nition 3.1 are HyBBI-de.nable via pure formulas: Functionality: @e(j \n* k) . @e1 (j * k) f @ee \" (pfn) Cancellativity: e * j . e * k f @j k (cnc) Single unit: @e1 I . @e2 \nI f @e1 e2 (su) Indivisible units: I . (e1 * e2) f e1 (iu ) Disjointness: e * e f I . e (dis) Proof. \nWe treat each property individually. Functionality. (.) Assume M is partial functional, let . be a val\u00aduation \nfor M and let w . W . To show that (pfn) is valid in M, we assume that M, w |= . @e(j * k) . @e1 (j * \nk), and must show that M, w |= . @ee \" , i.e., that .(e) = .(e \" ). By assumption, we have .(e) . .(j) \n. .(k) and .(e \" ) . .(j) . .(k). Hence by partial functionality of M we have .(e) = .(e \" ) as required. \n(.) Assume that (pfn) is valid in M, and suppose w \" , w . w1 .w2. We require to show that w = w \" . \nSince (pfn) is valid in M, we have M, w |=. (pfn) for all w . W and for any hybrid valuation .. We de.ne \na hybrid valuation . for M as follows: .(e) = w .(e \" ) = w \" .(j) = w1 .(k) = w2 Then, showing that \nw = w \" means showing that M, .(e) |= . e \" , i.e., that M, w |= . @ee \" . As (pfn) is valid in M, it \nsuf.ces to show that M, w |= . @e(j * k) . @e1 (j * k). Since w, w \" . w1 . w2 by assumption and M, w1 \n|= . j and M, w2 |= . k by construction, we obtain that M, w |= . j * k and that M, w \" |= . j * k, from \nwhich the result follows. Cancellativity. (.) Assume M is cancellative, let . be a val\u00aduation for M and \nlet w . W . To show that (cnc) is valid in M, we suppose that M, w |=. (e * j) . (e * k), and re\u00adquire \nto show that M, w |=. @j k, i.e., that .(j) = .(k). That M, w |=. (e * j) . (e * k) straightforwardly \nmeans that w . (.(e) . .(j)) n (.(e) . .(k)). By cancellativity, we thus im\u00admediately get that .(j) = \n.(k) as required. (.) Assume that (cnc) is valid in M, and suppose w \" . (w .w1)n (w . w2). We require \nto show that w1 = w2. Since (cnc) is valid in M, we have M, w |= . (cnc) for all w . W and hybrid valuations \n.. We de.ne a hybrid valuation . for M as follows: .(e) = w .(j) = w1 .(k) = w2 Then by assumption M, \nw \" |=. (e*j).(e*k). By validity of (cnc), we deduce that M, w \" |=. @j k, hence that .(j) = .(k), and \nby construction that w1 = w2. Single unit. (.) Assume E = {e}, let . be a valuation for M and let w . \nW . We show (su) is valid. Supposing that M, w |= . @e1 I . @e2 I, we have that .(e1), .(e2) . E. Thus \n.(e1) = .(e2) = e, which yields M, w |= . @e1 e2 as required. (.) Assume (su) is valid and let e, e \" \n. E. We need to show e = e \" . De.ne a valuation . for M by .(e1) = e and .(e2) = e \" . Thus, to show \ne = e \" , it suf.ces to show M, w |= . @e1 e2 (for any w . W ). Since (su) is valid, it suf.ces to show \nthat M, w |=. @e1 I . @e2 I. This follows from our construction of .. Indivisible units. The equivalence \nholds by a straightforward mod\u00adi.cation of the argument for the formula (iu) (see [5]) in Prop. 3.3. \nDisjointness. (.) Assume the disjointness property, let . be a val\u00aduation for M and let w . W . To show \n(dis) is valid, we suppose that M, w |= . e * e and require to show that M, w |= . I . e, i.e., that \nw = .(e) and w . E. That M, w |= . e * e means that w . .(e) . .(e). In particular, .(e) . .(e) = \u00d8 hence, \nby disjoint\u00adness, .(e) . E. We thus get w . .(e) . .(e) = {.(e)} hence w = .(e) and also w . E as required. \n(.) Assume that (dis) is valid in M, and suppose that w . w = \u00d8. We require to show that w . E. Let w \n\" . w . w and . be such that .(e) = w. By construction, we have that M, w \" |=. e * e, hence by validity \nof (dis) we get M, w \" |=. I . e, i.e., w \" = .(e) = w and w \" . E, hence w . E as required. Corollary \n4.4. Any separation theory from Def. 3.1 not including the cross-split property is HyBBI-de.nable by \npure formulas. Proof. Follows by taking as the de.ning formula the conjunction of the relevant formulas \nfrom Theorem 4.3 and Proposition 3.3. As is also the case for BBI (see Conjecture 3.14), we suspect (but \ndo not know) that the cross-split property is not de.nable even in HyBBI. This is because a straightforward \ntranslation of the property into HyBBI would require some way of binding or existentially quantifying \nnominals, which is not provided by pure nominals or the @e modality. In Section 7 we add a binder to \nHyBBI, which enables us to express cross-split. 5. An axiomatic proof system for HyBBI Here, we present \na Hilbert-style axiomatic proof system for HyBBI, and show that it is sound with respect to validity \nin BBI-models; we examine questions of completeness in Section 6. In the rest of the paper, it will often \nbe convenient to reason in terms of - -, the De Morgan dual of - * de.ned as def A - -B = \u00ac(A - * \u00acB) \n. Unpacking the negations and - * yields the following forcing rela\u00adtion for - -: \" \"\" \" M, w |=. A1 \n- -A2 . .w , w . W. w \"\" . w . w and M, w \" |= . A1 and M, w \"\" |= . A2 (Using - -rather than - * means \nthat we deal exclusively with diamond-type modalities with an existential interpretation, which frequently \nmakes life easier in our technical developments.) De.nition 5.1. We de.ne KHyBBI to be the proof system \nobtained by extending the proof system KBBI (see De.nition 2.4) with the axioms and rules for nominals \nand @ given in Figure 1. KHyBBI is based on the proof system for basic hybrid logic in [1]. We have chosen \nthe axioms and rules so as to make the subsequent completeness proof as simple as possible. Proposition \n5.2. Any KHyBBI-provable formula is valid. Proof. Let M = (W, ., E) be a BBI-model. Then, assuming A \nis KHyBBI-provable, we must show that A is valid in M . It suf\u00ad.ces to show that all axioms of KHyBBI \nare valid and that validity  (K@) (Self-dual) (@-intro) (Re.) (Sym) @e(A . B) f @eA . @eB @eA f \u00ac@e \n\u00acA and \u00ac@e \u00acA f @eA e . A f @eA f @ee @ek f @ke (Nom) (Agree) (Bridge *) (Bridge - -) @ek . @kA f @eA \n@k@eA f @eA and @eA f @k@eA @e(k * k \" ) . @kA . @k1 B f @e(A * B) @e(k - -k \" ) . @kA . @k1 B f @e(A \n- -B) f A (Subst) f A[.] f A (Gen) f @eA @e(k * k \" ) . @kA . @k1 B f C @e(A * B) f C k, k \" not in A, \nB, C or {e}(Paste *) e f A f A e not in A (Name) @e(k - -k \" ) . @kA . @k1 B f C @e(A - -B) f C k, k \n\" not in A, B, C or {e}(Paste - -) Figure 1. Rules and axioms for nominals in KHyBBI. Note that . in \nthe the rule (Subst) is a substitution of nominals for nominals. is preserved by every proof rule of \nKHyBBI. This is a straight\u00adforward veri.cation for all the rules and axioms except the two bridge axioms \nand the two paste rules. We just show the cases of (Bridge *) and (Paste - -) here, as the others are \nsimilar. Case (Bridge *). Let . be a valuation for M and let w . W . Suppose M, w |= . @e(k * k \" ) . \n@kA . @k1 B. Then we have M, .(e) |= . k * k \" and M, .(k) |= . A and M, .(k \" ) |= . B. The .rst of \nthese means that .(e) . .(k) . .(k \" ). Thus M, .(e) |= . A * B, i.e. M, w |= . @e(A * B) as required. \nCase (Paste - -). Let . be a valuation for M and let w . W . Supposing the premise of the rule is valid \nin M and M, w |=. @e(A - -B), we have to show M, w |=. C. We have M, .(e) |=. A - -B which means that \nthere exist w \" , w \"\" . W such that w \"\" . .(e) . w \" and M, w \" |=. A and M, w \"\" |=. B. Now de.ne \nthe valuation . \" = .[k . w \" , k \" . w \"\" ], where k and k \" are the fresh nominals appearing in the \npremise of the rule. By con\u00adstruction, and using the fact that . and . \" agree except possibly on the \nfresh nominals k, k \" , we have . \" (k \" ) . . \" (e) . . \" (k) and M, . \" (k) |= .1 A and M, . \" (k \" \n) |= .1 B. The .rst of these gives us M, . \" (e) |= .1 k - -k \" . Putting everything together, we obtain \nM, w |= .1 @e(k - -k \" ) . @kA . @k1 B Since the premise of the rule is valid by assumption, we obtain \nM, w |= .1 C. Again, since . and . \" agree except on k, k \" , which do not appear in C, we thus obtain \nM, w |=. C as required. The following example illustrates how the hybrid axioms and rules are used in \npractice. Example 5.3. The HyBBI-formula T * (I . (e - -A)) f @eA is provable in HyBBI. (Intuitively, \nthe LHS of this formula says that from the current world w one may .nd a unit e such that w .e is de.ned \nand e..(e) is de.ned and satis.es A. This implies that .(e) itself satis.es A.) Proof. First, we show \nthat the following formula is provable: A * @eB f @eB (1) Let j, k, k \" be fresh nominals not occurring \nin A, B or {e}. We have @k1 @eB f @eB an instance of (Agree). By weakening for ., we thus obtain @j (k \n* k \" ) . @kA . @k1 @eB f @eB Using the fact that k, k \" are fresh, we can apply the rule (Paste *) to \nderive @j (A * @eB) f @eB. Since the formula j . (A * @eB) f @j (A * @eB) is an instance of (@-intro), \nwe obtain j . (A * @eB) f @eB by transitivity, and thus easily we have j f (A * @eB) . @eB. Since j is \nfresh, we obtain A * @eB f @eB by applying (Name). Next, we show that the following formula is provable: \nI . (e - -A) f @eA (2) We have e . A f @eA an instance of (@-intro), whence by contra\u00adposition and use \nof (Self-dual) we obtain e . @e \u00acA f \u00acA. Now, since e * @e \u00acA f @e \u00acA is provable as an instance of (1) \nabove, we obtain e . (e * @e \u00acA) f \u00acA. By straightforward manipula\u00adtions of plain BBI we can prove (I \n. @e \u00acA) * e f e . (e * @e \u00acA) Thus, by transitivity, we obtain (I . @e \u00acA) * e f \u00acA. This rear\u00adranges \nto I . @e \u00acA f e - * \u00acA and then to I . (e - -A) f \u00ac@e \u00acA, which yields the required (2) by using (Self-dual). \nNow we can supply the required derivation of the formula in the proposition. We can derive T * (I . (e \n- -A)) f T * @eA using (2). As T * @eA f @eA is an instance of (1), we have T * (I . (e - -A)) f @eA \nby transitivity as required. Interestingly, the converse of the formula in Example 5.3, that is @eA f \nT * (I . (e - -A)), is not generally valid, but is valid in all single-unit models (and thus in such \nmodels @e is de.nable already using plain nominals). This is because, in models with a single unit e, \nthe composition w . e must be de.ned for all w . W , whereas this might fail in models with multiple \nunits. The @e modality enables us to talk about worlds not accessible from the current world via the \nI, * and - * modalities; but in single-unit models, there are no such worlds. 6. Completeness for pure \nextensions of KHyBBI In this section, we show a parametric completeness result: any extension of KHyBBI \nwith a set of pure axioms Ax is complete with respect to the class of BBI-models satisfying Ax. In particular, \nwe can obtain complete proof systems for many separation theories simply by adding the axioms de.ning \nthe theory to KHyBBI. We follow the basic structure of the corresponding complete\u00adness proof for normal \nhybrid logic in [1], which shows that any consistent set of formulas has a model based upon named maxi\u00admal \nconsistent sets. Compared to this proof, we encounter two ad\u00additional dif.culties. First, we have to \nwork (at least implicitly) with the residuated binary connectives * and - *, as opposed to a sin\u00adgle \ndiamond modality and its De Morgan dual. Second, we have to show that the model we construct is a BBI-model, \nas opposed to an unrestricted frame.  De.nition 6.1 (Consistent set). Let K be any proof system. A set \nG of formulas is said to be K-inconsistent if there are formulas A1, . . . , An . G such that A1 . . \n. . . An f . is provable in K. Otherwise G is called K-consistent. De.nition 6.2 (Maximal consistent \nset). Let K be any proof sys\u00adtem. A set G of formulas is maximal K-consistent (and we call G a K-MCS) \nif G is K-consistent and any . . G is K-inconsistent. In the rest of this section, whenever we talk about \nMCSs, con\u00adsistency and provability, we always mean with reference to a .xed but arbitrary extension KHyBBI \n+ Ax of KHyBBI with a .nite set Ax of axioms expressed as pure formulas. We begin by recalling some basic \nfacts about MCSs. Lemma 6.3. For any MCS G and formulas A, B, we have 1. if A f B is provable and A . \nG then B . G; 2. T . G and . . G; 3. either A . G or \u00acA . G; 4. A . B . G iff A, B . G; 5. A . B \n. G iff A . G or B . G.  Proof. Standard in all cases. In the following, we do not refer explicitly \nto uses of Lemma 6.3, as we use it so frequently. De.nition 6.4 (Named / pasted MCS). An MCS G is said \nto be named if there is at least one nominal e . G; any such e is called a name for G. G is said to be \npasted if @e(A * B) . G implies @e(e1 * e2) . @e1 A . @e2 B . G for some e1, e2, and @e(A - -B) . G \nimplies @e(e1 - -e2).@e1 A.@e2 B . G for some e1, e2.  Lemma 6.5 (Extended Lindenbaum Lemma). Let N \n\" be a count\u00adably in.nite set of nominals disjoint from N . If . is a consistent set of formulas then \nthere is a named, pasted MCS .+ (of formulas in the extended nominal language of N . N \") such that . \n. .+ . Proof. Let k0, k1, k2 . . . be an enumeration of N \" , and let B1, B2, B3 . . . be an enumeration \nof all formulas in the extended language given by N . N \" . Given a consistent set . of formulas, we \nde.ne a sequence (.i)i=0 of sets of formulas as follows: def .0 = . . {k}; def if .i . {Bi} is inconsistent \nthen .i+1 = .i;  if .i . {Bi} is consistent and the formula Bi is not of the form  def @e(A * B) or \n@e(A - -B), then .i+1 = .i . {Bi}; if .i . {Bi} is consistent and Bi = @e(A * B) then def \" .i+1 = .i \n. {Bi} . {@e(k * k ) . @kA . @k1 B} if .i . {Bi} is consistent and Bi = @e(A - -B) then def \" .i+1 = \n.i . {Bi} . {@e(k - -k ) . @kA . @k1 B} where k, k \" in the .rst and last two clauses are fresh nominals \nfrom def our enumeration of N \" . We claim that .+ = i=0 .i is a named, pasted MCS. First, to see that \n.+ is consistent, it suf.ces to show that .i is consistent for all i. We proceed by induction on i. In \nthe case i = 0, we must show that . . {k} is consistent. If not, then there n are formulas A1, . . . \n, An . . such that, writing A = Ai, 1=i=n we have A . k f . provable. Thus k f \u00acA is provable, whence \nby the rule (Name) we have f \u00acA provable and thus A f . provable, contradicting the consistency of .. \nNow, assuming that .i is con\u00adsistent, we must show that .i+1 is consistent. This is immediate by induction \nhypothesis except in the case that Bi = @e(A * B) or Bi = @e(A - -B). We show the case Bi = @e(A * B). \nIn this case, assume for contradiction that there are A1, . . . , An . .i n such that, writing A = Ai, \nthe following is provable: 1=i=n A . @e(A * B) . @e(k * k \" ) . @kA . @k1 B f . Thus we can also prove \n@e(k * k \" ) . @kA . @k1 B f \u00acA . \u00ac@e(A * B) Since k, k \" are fresh nominals, we obtain by applying (Paste \n*): @e(A * B) f \u00acA . \u00ac@e(A * B) Thus we obtain A . @e(A * B) f ., contradicting the assumed consistency \nof .i . {Bi}. The case Bi = A - -B is similar, using the rule (Paste - -). Next, we must show that .+ \nis maximal. Suppose that for some formula A, we have .+ . {A} consistent but A . .+ . Note that A appears \nin our enumeration as Bi say, so by construction it must be that .i . {A} is inconsistent (otherwise \nA . .i+1 . .+). But then .+ . {A} is inconsistent, contradiction. Next, to see that .+ is named, observe \nthat k . .0 . .+ , for some nominal k, by construction. Finally, we show .+ is pasted. First, suppose \n@e(A*B) . .+ . Note that @e(A * B) appears as some Bi in our enumeration. Now every .nite subset of an \nMCS is consistent, so .i . {Bi} must be consistent. Thus, by construction, we have @e(k * k \" ) . @kA \n. @k1 B . .i+1 . .+ as required. For similar reasons, whenever @e(A - -B) . .+ we have @e(k - -k \" ) \n. @kA . @k1 B . .+ . In the following, we de.ne a named set yielded by G to be any set of formulas {A \n| @eA . G} for some nominal e. def Lemma 6.6. Let G be an MCS, and let .e = {A | @eA . G} be the named \nset yielded by G for each nominal e. Then the following hold for all nominals e, k: 1. .e is an MCS containing \ne; 2. if e . .k then .k = .e; 3. @eA . .k iff @eA . G; 4. if e is a name for G then G = .e.  Proof. \nThe proof of the analogous result for normal hybrid logic, stated as Lemma 7.24 in [1], suf.ces for our \nsetting. De.nition 6.7. A BBI-model (W, ., E) is named by the hybrid valuation . if for all w . W there \nis an e . N with .(e) = w. De.nition 6.8. Let G be a named, pasted MCS. Then the named model yielded \nby G is de.ned as MG def , .G , EG), where: = (W G 1. W G is the set of all named sets yielded by G; \ndef 2. .1 .G .2 = {. | A1 . .1, A2 . .2 implies A1 *A2 . .}; 3. EG def  = {. | I . .}. The canonical \nvaluation .G for MG is de.ned by .G def (P ) = {. | P . .} P a proposition def .G(e) = {A | @eA . G} \ne a nominal We show that MG is indeed a BBI-model in Lemma 6.13 (but require for the intermediate results \nonly that MG is a BBI-frame). We observe that MG is indeed named by .G: for any . . W G we have . = {A \n| @eA . G} for some e, whence .G(e) = ..  Lemma 6.9 (Existence Lemma for *). For any . . W G , if A1 \n* A2 . . then there exist .1, .2 . W G such that . . .1 .G .2 and A1 . .1, A2 . .2. Proof. Let A1 * A2 \n. .. We have . = {A | @eA . G} for some nominal e. Thus @e(A1 * A2) . G. As G is pasted, we have nom\u00adinals \ne1, e2 such that @e(e1 * e2) . @e1 A1 . @e2 A2 . G. Thus A1 . .1 and A2 . .2, where .1 = {A | @e1 A . \nG} and .2 = {A | @e2 A . G} are named sets yielded by G. It just remains to show that . . .1 .G .2. Let \nB1 . .1, B2 . .2. By de.nition, @e1 B1 . G and @e2 B2 . G. As MCSs are closed under provability and conjunction, \nwe have @e(e1 *e2). @e1 B1 . @e2 B2 . G. Thus, using the rule (Bridge *), we have @e(B1 * B2) . G. Thus \nB1 * B2 . . as required. Lemma 6.10. . . .1 .G .2 if and only if for all formulas A and B, A . .2 and \nB . . implies A - -B . .1. Proof. We show each direction separately, making use of the fact that ., .1, \n.2 are MCSs by part 1 of Lemma 6.6. (.) Assume the right-hand side of the implication and let A1 . .1 \nand A2 . .2. We must show A1 * A2 . .. Suppose for contradiction that A1 * A2 . .. Since . is an MCS, \n\u00ac(A1 * A2) . .. By assumption, A2 - -\u00ac(A1 * A2) . .1, i.e. \u00ac(A2 - * \u00ac\u00ac(A1 * A2)) . .1. As .1 is an MCS, \nwe have A1 . \u00ac(A2 - * (A1 * A2)) . .1. But A1 f A2 - * (A1 * A2) is provable, hence so is A1 . \u00ac(A2 - \n* (A1 * A2)) f .. This con\u00adtradicts the consistency of .1. Hence A1 * A2 . . as required. (.) Let A . \n.2, B . . and suppose for contradiction that A - -B ./.1. As .1 is an MCS, we have A - * \u00acB . .1, so \nby the main assumption (A - * \u00acB) * A . .. As . is an MCS and (A - * \u00acB) * A f \u00acB is provable, \u00acB . .. \nThis contradicts the consistency of ., so A - -B . .1 as required. Lemma 6.11 (Existence Lemma for - \n*). For any . . W G , if , . \"\" W G A1 - -A2 . . then there exist . \" . such that . \"\" , A2 . . \"\" . \n. .G . \" and A1 . . \" . Proof. We have . = {A | @eA . G} for some nominal e. Since A1 - -A2 . . by assumption, \n@e(A1 - -A2) . G. As G is pasted, we have @e(e1 - -e2) . @e1 A1 . @e2 A2 . G for some e1, e2. We obtain \nnamed sets . \" = {A | @e1 A . G} and . \"\" = {A | @e2 A . G} yielded by G with A1 . . \" and A2 . . \"\" \n. It remains to show that . \"\" . . .G . \" . By Lemma 6.10, it suf.ces to show that A . . \" and B . . \n\"\" implies A - -B . .. Supposing A . . \" , B . . \"\" , we have @e1 A . G and @e2 B . G. Thus we obtain \n@e(e1 - -e2) . @e1 A . @e2 B . G. Since G is an MCS it is closed under the rule (Bridge - -), and it \nfollows that @e(A - -B) . G. Thus A - -B . . as required. Lemma 6.12 (Truth Lemma). For any HyBBI-formula \nA and . . W G , we have MG , . |= .G A if and only if A . .. Proof. By structural induction on A. We \nomit the cases for the classical connectives, as these are straightforward by induction hy\u00adpothesis, \nusing the properties of MCSs and the fact that any named set yielded by G is an MCS (see part 1 of Lemma \n6.6). Case A = P . Using the de.nition of .G , we have as required: MG , . |= .G P . . . .G(P ) . P . \n. Case A = e. Using the de.nition of .G , we have MG , . |= .G e . . = .G(e) . . = {A | @eA . G} Now, \ngoing from left to right, we have . = {A | @eA . G} and thus e . . by part 1 of Lemma 6.6. Conversely, \nassuming e . ., we have that . = {A | @kA . G} for some k, and by part 2 of Lemma 6.6 we obtain . = {A \n| @eA . G} as required. Case A = I. Using the de.nition of EG , we easily have as required: MG , . |= \n.G I . . . Ec . I . . Case A = A1 * A2. Using the induction hypothesis, we have: MG , . |= .G A1 * A2 \n. . . .1 .G .2 and MG , .1 |= .G A1 and MG , .2 |= .G A2 . . . .1 .G .2 and A1 . .1 and A2 . .2  Going \nfrom left to right, we immediately get A1 * A2 . . as re\u00adquired from the de.nition of .G . Going from \nright to left, we have A1 * A2 . . and must construct the required named sets .1, .2 yielded by G satisfying \nthe statement above. This is precisely guar\u00adanteed by our Existence Lemma for * (Lemma 6.9). Case A = \nA1 - * A2. Using the induction hypothesis for A1 and A2, we have: MG , . |= .G A1 - * A2 . .. \" , . \"\" \n. . \"\" . . .G . \" and MG , . \" |= .G A1 implies MG , . \"\" |= .G A2 , . \"\" . . \"\" . .. \" . . .G . \" and \nA1 . . \" implies A2 . . \"\" Going from right to left, assume that A1 - * A2 . ., A1 . . \" and . \"\" . ..G. \n\" . By the de.nition of .G , we have (A1 - * A2)*A1 . . \"\" , whence we obtain A2 . . \"\" as required by \nmodus ponens. Going from left to right, we must show that A1 - * A2 . . given the above implication. \nWe show the contrapositive. Assume that A1 - * A2 . ., i.e. \u00ac(A1 - * A2) . .. We must construct named \nsets . \" , . \"\" yielded by G, with . \"\" . ..G . \" and A1 . . \" but A2 . . \"\" , i.e. \u00acA2 . .. This is \nprovided by our Existence Lemma for - * (Lemma 6.11). Case A = @eB. Using the induction hypothesis for \nB, we have: MG MG , . |= .G @eB . , .G(e) |= .G B . B . .G(e) . B . {A | @eA . G}  . @eB . G Now, using \npart 3 of Lemma 6.6, we have that @eB . G if and only if @eB . .. This completes the case, and the proof. \nLemma 6.13. Let MG = (W G , .G , EG) be the named model yielded by the named, pasted MCS G. Then MG is \na BBI-model. Proof. We must show that MG satis.es the axioms in Defn. 2.2. Commutativity. It suf.ces \nto show that .1 .G .2 . .2 .G .1. Let . . .1 .G .2, and suppose A1 . .1, A2 . .2. To show . . .2 .G .1, \nwe have to show A2 *A1 . .. As . . .1 .G .2, we have A1 * A2 . .. As MCSs are closed under modus ponens \nand A1 * A2 f A2 * A1 is provable, we have A2 * A1 . .. Associativity. It suf.ces by commutativity to \nshow .1 .G (.2 .G .3) . (.1 .G .2) .G .3. Assume that . . .1 .G (.2 .G .3), which means that for some \n. \" . .2 .G .3 we have . . .1 .G . \" . Using part 1 of Lemma 6.6, we have e1, e2, e3 such that ei . .i \nfor each i . {1, 2, 3}. As . \" . .2 .G .3, we have e2 * e3 . . \" . Thus, as . . .1 .G . \" , we have e1 \n* (e2 * e3) . .. By ap\u00adplying associativity, e1 * (e2 * e3) f (e1 * e2) * e3 is provable, so (e1 * e2) \n* e3 . .. By two applications of the Existence Lemma for * (Lemma 6.9) we obtain named sets S1, S2, S3, \n. \"\" . W G such that ei . Si for each i . {1, 2, 3}, and . . . \"\" S3 .G  and . \"\" . S1 .G S2. By part \n2 of Lemma 6.6, Si = .i for each i . {1, 2, 3}. Hence . . (.1 .G .2) .G .3 as required. Unit law. We \nmust show that EG .G . = {.} for any . . W G . First we show that EG .G . . {.}. Suppose . \" . EG .G \n., i.e. there is a .E . EG such that . \" . .E .G .. We need to show . \" = .. First suppose A . ., and \nnote that I . .E by de.nition. By de.nition of .G we have I * A . . \", and as I * A f A is provable we \nmust have A . . \". Thus . \" . .. To see that . \" = . as required, we just observe that if . \" . . then, \nas . \" is consistent, . is not maximal, contradiction. We still need to show that . . EG .G ., i.e. that \n. . .E .G . for some .E . EG. Using part 1 of Lemma 6.6, we have some e . .. Since e f I * e is provable, \nwe have I * e . .. Using the Existence Lemma for * (Lemma 6.9) we obtain named sets .E , . \" . W G such \nthat . . .E .G . \" and I . .E and e . . \" . Thus .E . EG and, by part 2 of Lemma 6.6, . \" = .. This completes \nthe proof. Lemma 6.14. Let M = (W, ., E ) be a BBI-model named by . and let A be a pure formula. Suppose \nthat M, w |= . A[.] for all w . W and nominal substitutions .. Then A is valid in M. Proof. Letting . \n\" be a hybrid valuation and w . W , we must show that M, w |= .1 A. Since M is named by ., we have that \nfor any e . N there is a k . N such that .(k) = . \" (e). Thus we can de.ne the substitution . of nominals \nfor nominals by: .(e) is the .rst k . N with .(k) = . \" (e). By hypothesis, we have that M, w |= . A[.] \nfor all w . W . We now prove by structural induction on A that M, w |= .1 A. In the case that A is a \nnominal e, we must show that . \" (e) = w, and are done since by assumption w = .(e[.]) = . \" (e). Note \nthat A cannot be a propositional variable since it is assumed pure. The other cases follow by induction \nhypothesis. Theorem 6.15 (Completeness). Let Ax be a set of pure HyBBI\u00adformulas. Then if a HyBBI-formula \nis valid in the class of BBI\u00admodels satisfying Ax, then it is provable in KHyBBI + Ax. Proof. Let C be \nthe class of BBI-models satisfying Ax. Suppose A is valid in all BBI-models M . C, but not provable in \nKHyBBI + Ax. Then {\u00acA} is consistent. Using the Extended Lindenbaum Lemma (6.5), we can construct a named, \npasted MCS G . {\u00acA}. Now let MG = (W G , .G, EG) be the named model yielded by G, and .G the corresponding \ncanonical valuation. By Lemma 6.13, MG is a BBI-model. Furthermore, for any pure formula B . Ax and any \nnominal substitution ., we have that f B[.] is provable (using the rule (Subst)), which means that B[.] \n. . for all . . W G since MCSs are closed under provability. By the Truth Lemma (6.12), we obtain MG \n, . |= .G B[.] for all B . Ax, . . W G, and substitutions . Thus, by Lemma 6.14, all formulas in Ax are \nvalid in MG, i.e. MG . C . Thus, by the main assumption, A is valid in MG . Since G is named by construction, \nwe have G . W G by part 4 of Lemma 6.6. Since \u00acA . G, we have MG , G |= .G \u00acA by the Truth Lemma. That \nis, M G , G |= .G A. Thus A is not valid in MG , contradiction. We conclude A is provable in KHyBBI + \nAx. Corollary 6.16. Let S be any separation theory from De.nition 3.1 not including the cross-split property, \nand let Ax be the set of pure HyBBI formulas de.ning S, as given by Corollary 4.4. Then a HyBBI-formula \nis provable in KHyBBI +Ax if and only if it is valid in the class of BBI-models satisfying S. Proof. \nFollows from Prop. 5.2, Thm. 6.15 and Cor. 4.4. 7. HyBBI with the . binder In this section, we study \nthe extension of HyBBI with the . binder from hybrid logic [2]. Speci.cally, we show that the elusive \ncross\u00ad split property from De.nition 3.1 is de.nable in this extension, called HyBBI(.), and we show \nhow to extend our soundness and parametric completeness results for HyBBI in the previous sections to \nthe setting of HyBBI(.). 7.1 Formulas and expressivity De.nition 7.1 (HyBBI(.)-formula). A HyBBI(.)-formula \nis de\u00ad.ned as for HyBBI (Defn. 4.1), except that if A is a HyBBI(.)\u00adformula and e a nominal then .e. \nA is a HyBBI(.)-formula. De.nition 7.2 (HyBBI(.)-validity). Given any hybrid valuation . for a BBI-model \nM = (W, ., E), and any w . W , we extend the forcing relation for HyBBI in Defn. 4.2 by the following \nclause for the . binder, which binds the given label to the current world: M, w |= . .e. A . M, w |= \n.[e:=w] A where .[e := w] is notation for the hybrid valuation de.ned as def . except that .[e := w](e) \n= w. The de.nition of validity for HyBBI then extends immediately to HyBBI(.). Proposition 7.3. The cross-split \nproperty (see De.nition 3.1) is de.nable in HyBBI(.) via the following pure formula: (a * b) . (c * d) \n(cs) f @a(T * .ac. @a(T * .ad. @a(ac * ad) . @b(T * .bc. @b(T * .bd . @b(bc * bd ) . @c(ac * bc) . @d(ad \n* bd ))))) Proof. We use the following formula abbreviations: def C = @c(ac * bc) . @d(ad * bd ) def \nB = @b(T * .bc. @b(T * .bd . @b(bc * bd ) . C)) def A = @a(T * .ac. @a(T * .ad. @a(ac * ad) . B)) Using \nthe fact that ac, ad and a are distinct nominals, we have for any BBI-model M = (W, ., E), valuation \n. and w . W , M, w |=. A . M, .(a) |= . T * .ac. @a(T * .ad. @a(ac * ad) . B) . .w \" , w1. .(a) . w \" \n. w1 and M, w1 |=. .ac. @a(T * .ad. @a(ac * ad) . B) . M, w1 |= .[ac:=w1] @a(T * .ad. @a(ac * ad) . \nB) . M, .(a) |= .[ac:=w1] T * .ad. @a(ac * ad) . B  . .w \"\" , w2. .(a) . w \"\" . w2 and M, w2 |= .[ac:=w1] \n.ad. @a(ac * ad) . B . M, w2 |= .[ac:=w1,ad:=w2] @a(ac * ad) . B . M, .(a) |= .[ac:=w1,ad:=w2] (ac * \nad) . B . .w1, w2. .(a) . w1 . w2 and M, .(a) |= .[ac:=w1,ad:=w2] B  By a similar chain of reasoning, \nwe have M, .(a) |= .[ac:=w1,ad:=w2] B . .w3, w4. .(b) . w3 . w4 and M, .(b) |= .[ac:=w1,ad;=w2,bc:=w3,bd \n:=w4] C Finally, we have M, .(b) |= .[ac:=w1,ad;=w2,bc:=w3,bd :=w4] C . .(c) . w1 . w3 and .(d) . w2 \n. w4 Putting everything together, we have M, w |= . A . .w1, w2, w3, w4. .(a) . w1 . w2, .(b) . w3 . \nw4, .(c) . w1 . w3, .(d) . w2 . w4 With the above equivalence for A in place, we can now show that (cs) \nde.nes the cross-split property of De.nition 3.1.  (.) Suppose M has the cross-split property. We require \nto show that the formula (cs) is valid in M, i.e. that if M, w |= . (a * b) . (c * d) then M, w |= . \nA. Supposing M, w |= . (a * b) . (c * d), we have w . (.(a) ..(b)) n (.(c) ..(d)). By the cross-split \nproperty, there then exist ac, ad, bc, bd . W such that .(a) . ac . ad, .(b) . bc . bd, .(c) . ac . bc \nand .(d) . ad . bd. Thus, by the equivalence above, M, w |=. A as required. (.) Suppose the formula (cs) \nis valid in M. We require to show that M has the cross-split property. Suppose w . (t . u) n (v . w). \nDe.ne a hybrid valuation . for M by .(a) = t .(b) = u .(c) = v .(d) = w where a, b, c, d are distinct \nnominals. We have that M, w |= . (a * b) . (c * d). Thus, as (cs) is valid in M, we have M, w |= . A. \nUsing the equivalence above, there then exist tv, tw, uv, uw . W such that t . tv . tw, u . uv . uw, \nv . tv . uv and w . tw . uw as required. The . binder of HyBBI(.) also allows us to encode the de.\u00adnition \nof the overlapping conjunction .* of separation logic, which has been used in specifying and verifying \nprograms manipulating data structures with intrinsic sharing [25, 16, 13]. In these works, .* is introduced \nas an new primitive connective, de.ned by extending the standard forcing relation for BBI (De.nition \n2.3) as follows: M, w |=. A1 .* A2 . .w1, w2, w3, w \" , w \"\" . W. w \" . w1 . w2 and w \"\" . w2 . w3 and \nw . w \" . w3 and M, w \" |=. A1 and M, w \"\" |=. A2 We give below an equivalent formulation of A1 .* A2 \nsolely in terms of HyBBI(.) connectives. We conjecture that this is not possible in BBI (for arbitrary \nA1 and A2). Proposition 7.4. For any HyBBI(.) formulas A1 and A2, the overlapping conjunction A1 .* A2 \nis de.nable via the following HyBBI(.) formula, where e and es do not occur in A1 or A2: .e. T * .es. \n@e(es - -A1) * (es - -A2) * es Proof. Let M = (W, ., E) be a BBI-model, . a valuation for M, and w . \nW . M, w |=. .e. T * .es. @e(es - -A1) * (es - -A2) * es . M, w |= .[e:=w] T * .es. @e(es - -A1) * (es \n- -A2) * es . w . ws \" . ws and M, ws |= .[e:=w] .es. @e(es - -A1) * (es - -A2) * es . M, w |= .[e:=w,es:=ws] \n(es - -A1) * (es - -A2) * es \"\" \" . .w1, w2, w3, w . w . w1 . w2 and w . w . w3 and M, w1 |= .1 es - \n-A1 and M, w3 |= .1 es - -A2 and M, w2 |= .1 es (letting . \" = .[e := w, es := ws]) Notice now that M, \nw1 |= .1 es - -A1 \"\"\" \" . .w , w1. w . w1 . w1 and M, w1 \" |= .1 es and M, w \" |= .1 A1 . .w \" . w \" \n. w1 . ws and M, w \" |= .1 A1  Consequently, after applying a similar line of reasoning to w3, M, w \n|=. .e. T * .es. @e(es - -A1) * (es - -A2) * es \" \"\" \"\" . .w1, w2, w3, w , w . W. w \" . w1 . w2 and w \n. w2 . w3 and w . w \" . w3 and M, w \" |= .1 A1 and M, w \"\" |= .1 A2 . M, w |= .1 A1 .* A2  Since e \nand es are suf.ciently fresh, this is equivalent to M, w |= . A1 .* A2. A three-place variant A1(.* : \nB)A2 of the overlapping conjunc\u00adtion was introduced in [9] to deal with some forms of speci.ed shar\u00ading. \nThis variant tags the shared core of A1 and A2 with a formula B that it satis.es. Its satisfaction is \nde.ned as follows: M, w |= . A1(.* : B)A2 . .w1, w2, w3, w \" , w \"\" . W. w \" . w1 . w2 and w \"\" . w2 \n. w3 and w . w \" . w3 and M, w \" |= . A1 and M, w \"\" |= . A2 and M, w2 |= . B It is easy to modify the \nde.ning HyBBI(.)-formula of Propo\u00adsition 7.4 so as to accommodate this variant: .e. T * .es. B . @e(es \n- -A1) * (es - -A2) * es 7.2 Proof theory, soundness and completeness De.nition 7.5. We de.ne KHyBBI(.) \nto be the proof system ob\u00adtained by adding the following axiom schema to KHyBBI: (Bind .. ) f @j (.e. \nB . B[j/e]) Lemma 7.6 (Nominal Substitution Lemma). We have for any model M = (W, ., E), hybrid valuation \n., HyBBI(.)-formula A and nominals j, e, M, .(j) |=. A[j/e] . M, .(j) |= .[e:=.(j)] A where [j/e] is \na (capture-avoiding) nominal substitution. Proof. By structural induction on A. The cases not involving \nnom\u00adinals are straightforward. We examine the nominal cases, making use of the identity .[e := .(j)](k) \n= .(k[j/e]): Case A = k . N . The required equivalence becomes: M, .(j) |=. k[j/e] . M, .(j) |= .[e:=.(j)] \nk i.e. .(j) = .(k[j/e]) . .(j) = .[e := .(j)](k) which follows from the identity above. Case A = @kB. \nWe have (@kB)[j/e] = @k[j/e]B[j/e] (noting that @ is not a binder, so the nominal substitution applies \nto the argument k), and proceed as follows: M, .(j) |=. @k[j/e]B[j/e] . M, .(k[j/e]) |=. B[j/e] . M, \n.[e := .(j)](k) |=. B[j/e] (by above identity) . M, .[e := .(j)](k) |= .[e:=.(j)] B (by ind. hyp.) \n . M, .(j) |= .[e:=.(j)] @kB Case A = .k. B. Without loss of generality, we can assume that k = e. In \nthis case, we have (.k. B)[j/e] = .k. B[j/e], and can proceed as follows: M, .(j) |=. .k. B[j/e] . M, \n.(j) |= .[k:=.(j)] B[j/e] . M, .(j) |= .[k:=.(j)][e:=.(j)] B (by ind. hyp.) . M, .(j) |= .[e:=.(j)][k:=.(j)] \nB  . M, .(j) |= .[e:=.(j)] .k. B This completes all cases. Proposition 7.7. Any KHyBBI(.)-provable formula \nis valid. Proof. Given the soundness of KHyBBI (Proposition 5.2), we just need to show that the new axiom \n(Bind .. ) is valid in all BBI\u00admodels. Let M = (W, ., E) be a BBI-model, let . be a valuation for M and \nlet w . W . We need to show that M, w |=. @j ((.e. B) . B[j/e]) i.e. M, .(j) |=. .e. B . M, .(j) |=. \nB[j/e] i.e. M, .(j) |= .[e:=.(j)] B . M, .(j) |=. B[j/e]  which is guaranteed by Lemma 7.6.  We can \nobtain a parametric completeness result for KHyBBI(.) by repeating the Lindenbaum model construction \nfor KHyBBI in Section 6. The only difference is that the crucial Truth Lemma needs to be extended to \naccount for the . binder case (cf. [2]). Lemma 7.8 (Extended Truth Lemma). For any HyBBI(.)-formula A \nand . . W G, we have MG , . |= .G A if and only if A . .. Proof. By induction on the size of A, with \nall cases except A = .e. B covered by Lemma 6.12. In this case, using the fact that . = {A | @j A . G} \nfor some nominal j, we proceed as follows: MG , . |= .G .e. B . MG , . |= .G[e:=.] B G . M , . |= .G[e:=.G(j)] \nB . MG , . |= .G B[j /e] (by Lemma 7.6) . B[j/e] . . (by ind. hyp.) . @j B[j/e] . G  Now since G is \nan MCS and thus closed under (K@) and the new axiom (Bind .. ), we have @j B[j/e] . G if and only if \n@j .e. B . G if and only if .e. B . ., which completes the case. Theorem 7.9 (Completeness). Let Ax be \nany set of pure HyBBI(.)\u00adformulas. Then if a HyBBI(.)-formula is valid in the class of BBI-models satisfying \nAx, then it is provable in KHyBBI(.) + Ax. Proof. Exactly as Theorem 6.15, using the Extended Truth Lemma \n(Lemma 7.8) for HyBBI(.) in place of Lemma 6.12. Corollary 7.10. Let S be any separation theory from \nDe.ni\u00adtion 3.1, and let Ax be the set of pure HyBBI(.) formulas de.ning the properties S, as given by \nCorollary 4.4 and Proposition 7.3. Then a HyBBI(.)-formula is provable in KHyBBI(.) + Ax if and only \nif it is valid in the class of BBI-models satisfying S. Proof. Follows from Props. 7.7, 7.3, Thm. 7.9 \nand Cor. 4.4. 8. Conclusions and future work In this paper, we show that many separation theories that \narise nat\u00adurally in applications of separation logic, and in particular the var\u00adious notions of separation \nalgebras introduced in the literature so far, are not de.nable in the standard propositional basis for \nsep\u00adaration logic, namely BBI. To overcome these limitations in ex\u00adpressivity, we introduce new hybrid \nversions of BBI, obtained by marrying BBI with the machinery of hybrid logic, in which the sep\u00adaration \ntheories are de.nable. In addition, we show how to obtain axiomatic proof systems for these hybrid logics \nthat are sound and complete for any separation theory obtained by combining proper\u00adties from a list of \nthose we found in the separation logic literature. In future work, we plan to explore possible applications \nof our hybrid logics to program analysis, e.g. by adding support for nom\u00adinals to separation logic. More \nbroadly, we hope that our intro\u00adduction of more expressive intermediaries between BBI and full .rst-order \nlogic will help facilitate the expression and veri.cation of more complex program properties, particularly \nthose involving overlapping data structures. Acknowledgments Many thanks to Hongseok Yang for pointing \nout to us the need for Lemma 6.10, and to Adam Barwell for crucial typing assistance. Brotherston was \nsupported by an EPSRC Career Acceleration Fellowship and Villard by the EPSRC grant EP/H008373/2. References \n[1] P. Blackburn, M. de Rijke, and Y. Venema. Modal Logic. Cambridge University Press, 2001. [2] P. Blackburn \nand B. ten Cate. Pure extensions, proof rules, and hybrid axiomatics. Studia Logica, 84(2), 2006. [3] \nG. E. P. Box and N. R. Draper. Empirical model-building and response surfaces. Wiley series in probability \nand mathematical statistics. John Wiley &#38; Sons, Inc., 1987. [4] J. Brotherston and C. Calcagno. Classical \nBI: Its semantics and proof theory. Logical Methods in Computer Science, 6(3), 2010. [5] J. Brotherston \nand M. Kanovich. Undecidability of propositional separation logic and its neighbours. To appear in Journal \nof the ACM. [6] C. Calcagno, D. Distefano, P. O Hearn, and H. Yang. Compositional shape analysis by means \nof bi-abduction. Journal of the ACM, 58(6), 2011. [7] C. Calcagno, P. Gardner, and U. Zarfaty. Context \nlogic as modal logic: Completeness and parametric inexpressivity. In POPL-34. ACM, 2007. [8] C. Calcagno, \nP. O Hearn, and H. Yang. Local action and abstract separation logic. In LICS-22. IEEE Computer Society, \n2007. [9] R. Cherini and J. O. Blanco. Local reasoning for abstraction and sharing. In SAC-24. ACM, 2009. \n[10] C. David and W.-N. Chin. Immutable speci.cations for more concise and precise veri.cation. In OOPSLA-11. \nACM, 2011. [11] T. Dinsdale-Young, L. Birkedal, P. Gardner, M. J. Parkinson, and H. Yang. Views: compositional \nreasoning for concurrent programs. In POPL-40. ACM, 2013.  [12] R. Dockins, A. Hobor, and A. W. Appel. \nA fresh look at separation algebras and share accounting. In APLAS-7. Springer, 2009. [13] G. J. Duck, \nJ. Jaffar, and N. C. H. Koh. Constraint-based program reasoning with heaps and separation. 2013. To appear \nin CP-19. [14] D. Galmiche and D. Larchey-Wendling. Expressivity properties of Boolean BI through relational \nmodels. In FSTTCS-26. Springer, 2006. [15] K. G \u00a8odel. On formally undecidable propositions of Principia \nMathe\u00admatica and related systems. 1962. English translation by B. Meltzer. [16] A. Hobor and J. Villard. \nThe rami.cations of sharing in data struc\u00adtures. In POPL-40. ACM, 2013. [17] Z. Hou, A. Tiu, and R. Gor \n\u00b4 e. A labelled sequent calculus for Boolean BI: Proof theory and proof search. To appear in TABLEAUX-22, \n2013.  [18] S. Ishtiaq and P. W. O Hearn. BI as an assertion language for mutable data structures. In \nPOPL-28. ACM, 2001. [19] D. Larchey-Wendling. The formal strong completeness of Boolean BI. Submitted, \n2012. [20] D. Larchey-Wendling and D. Galmiche. Exploring the relation be\u00adtween intuitionistic BI and \nBoolean BI: An unexpected embedding. Mathematical Structures in Computer Science, 19(3), 2009. [21] D. \nLarchey-Wendling and D. Galmiche. The undecidability of Boolean BI through phase semantics. In LICS-25. \nIEEE Computer Society, 2010. [22] J. Park, J. Seo, and S. Park. A theorem prover for Boolean BI. In POPL-40. \nACM, 2013. [23] D. Pym. The Semantics and Proof Theory of the Logic of Bunched Implications. Applied \nLogic Series. Kluwer, 2002. [24] J. C. Reynolds. Separation logic: A logic for shared mutable data structures. \nIn LICS-17. IEEE Computer Society, 2002. [25] J. C. Reynolds. A short course on separation logic. http://www.cs.cmu.edu/afs/cs.cmu.edu/project/fox\u00ad \n19/member/jcr/wwwaac2003/aac.html, 2003. [26] H. Yang, O. Lee, J. Berdine, C. Calcagno, B. Cook, D. Distefano, \nand P. O Hearn. Scalable shape analysis for systems code. In CAV-20. Springer, 2008.   \n\t\t\t", "proc_id": "2535838", "abstract": "<p>In this paper, we close the logical gap between provability in the logic BBI, which is the propositional basis for <i>separation logic</i>, and validity in an intended class of <i>separation models</i>, as employed in applications of separation logic such as program verification. An intended class of separation models is usually specified by a collection of axioms describing the specific model properties that are expected to hold, which we call a <i>separation theory</i>.</p> <p>Our main contributions are as follows. First, we show that several typical properties of separation theories are not definable in BBI. Second, we show that these properties become definable in a suitable <i>hybrid extension</i> of BBI, obtained by adding a theory of <i>naming</i> to BBI in the same way that <i>hybrid logic</i> extends normal modal logic. The binder-free extension captures most of the properties we consider, and the full extension HyBBI(&#8595;) with the usual &#8595; binder of hybrid logic covers all these properties. Third, we present an axiomatic proof system for our hybrid logic whose extension with any set of \"pure\" axioms is sound and complete with respect to the models satisfying those axioms. As a corollary of this general result, we obtain, in a parametric manner, a sound and complete axiomatic proof system for any separation theory from our considered class. To the best of our knowledge, this class includes all separation theories appearing in the published literature.</p>", "authors": [{"name": "James Brotherston", "author_profile_id": "81100189429", "affiliation": "University College London, London, United Kingdom", "person_id": "P4383880", "email_address": "J.Brotherston@cs.ucl.ac.uk", "orcid_id": ""}, {"name": "Jules Villard", "author_profile_id": "81384606967", "affiliation": "University College London, London, United Kingdom", "person_id": "P4383881", "email_address": "j.villard@ucl.ac.uk", "orcid_id": ""}], "doi_number": "10.1145/2535838.2535844", "year": "2014", "article_id": "2535844", "conference": "POPL", "title": "Parametric completeness for separation theories", "url": "http://dl.acm.org/citation.cfm?id=2535844"}