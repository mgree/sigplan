{"article_publication_date": "09-01-2000", "fulltext": "\n Make it Practical: A Generic Linear-Time Algorithm for Solving Maximum-Weightsum Problems Isao Sasano \nZhenjiang Hu Masato Takeichi Department of Information Engineering University of Tokyo {sasano,hu,takeihi} \nipl.t.u-tokyo.a.jp Mizuhito Ogawa NTT Communication Science Laboratories mizuhito theory.brl.ntt.o.jp \nABSTRACT Inthispaperweproposeanewmethodforderivingaprati\u00adallinear\u00adtimealgorithmfromthespeifationofa maximum\u00adweightsumproblem:Fromtheelementsofadata \nstruturex,fndasubsetwhihsatisfesaertainproperty pandwhoseweightsumismaximum.Previouslyproposed methodsforautomatiallygeneratinglinear\u00adtimealgorithms \naretheoretiallyappealing,butthealgorithmsgeneratedare hardlyusefulinpratieduetoahugeonstantfatorfor spaeandtime.Thekeypointsofourapproaharetoex\u00adpressthepropertypbyareursivebooleanfuntionoverthe \nstruturexratherthanausuallogialprediateandtoapply programtransformationtehniquestoreduetheonstant fator.Wepresentanoptimizationtheorem,giveaalula\u00adtionalstrategyforapplyingthetheorem,anddemonstrate \ntheefetivenessofourapproahthroughseveralnontrivial exampleswhihwouldbedi\u00c6ulttodealwithwhenusing themethodspreviouslyavailable. \nKeywords:Maximum\u00adweightsumproblem,Linear\u00adtimeal\u00adgorithm,Programalulation,Mutumorphism,Fusion,Tu\u00adpling \n1. INTRODUCTION Considerthefollowingthreeoptimizationproblems,the frstofwhihappearedasanexerisein[12]andwasdis\u00adussedin[8]. \nProfessorMKenzieisonsultingforthepresi\u00addentoftheA.\u00adBCorporation,aompanythat hasahierarhialstruture.Thatis,thesuper\u00advisoryrelationsformatreerootedatthepresi\u00addent.Thepersonnelo\u00c6ehasrankedeahem\u00ad \nPermission to make digital or hard copies of all or part of this work for personal or classroom use is \ngranted without fee provided that copies are not made or distributed for pro.t or commercial advantage \nand that copies bear this notice and the full citation on the .rst page. To copy otherwise, to republish, \nto post on servers or to redistribute to lists, requires prior speci.c permission and/or a fee. ICFP \n00, Montreal, Canada. Copyright 2000 ACM 1-58113-202-6/00/0009 ..$5.00 ployeewithaonvivialityratingthatisapositive \nornegativerealnumber. PartyPlanningProblem Thepresidentwantstohaveaompanyparty. Tomakethepartyfunforallattendees,thepres\u00adidentdoesnotwantbothanemployeeandhisor \nherdiretsupervisortoattend. Theproblemistodesignalinearalgorithmmak\u00adingtheguestlist.Thegoalistomaximizethe \nsumoftheonvivialityratingsoftheguests. GroupOrganizingProblem Thepresidentwantstoorganizeaprojetgroup \ninwhihtheexistingsupervisoryrelationshold; thatis,eahmemberofagroup(exeptthegroup leader)hasinthatgrouphisorherdiretorin\u00addiretsupervisor. \nTheproblemistodesignalinearalgorithmmak\u00adingthememberlist.Again,thegoalistomax\u00adimizethesumoftheonvivialityratingsofthe \ngroupmembers. SupervisorChainingProblem Thepresidentwantstoawardahainofsuper\u00advisorsthathasthelargestsumofonviviality \nratings. Theproblemistodesignalinearalgorithmmak\u00ad ingthelistofsupervisors. Theseproblems,thoughlookingabitdiferent,anbefor\u00admulatedinthefollowinguniformway:Givenatreethaving \nnodesassoiatedwithweights,fndasetofnodesvsthat satisfesaertainpropertyp(t,vs)andhasthemaximum weightsum.Thatis, \nspet lwsI[vsIvs.nodesetst,p(t,vs)] wherewsvsomputestheweightsumofvsandnodesets generatesallsetsofnodesofatree.Theoperatorlfis \nalledtheseletionoperator[7]andisdefnedby alfb a,iffafb b,otherwise. I[aI,a2,...,a ]aI a2 a . Thediferenesbetweenthethreeproblemsareinthedif\u00adferentdefnitionsofthepropertydesriptionofp.Theprop\u00adertiesforthepartyplanningproblem,thegrouporganizing \nproblem,andthesupervisorhainingproblemarerespe\u00adtivelydenotedbyppp,p,andps,andareasfollows. ppp(t,vs):foranyvIandv2invs,vIisnottheparent \norahildofv2int.  p(t,vs):foranyvIandv2invs,eithervIisanan\u00adestororadesendentofv2orthereisinvsaommon anestorofvIandv2. \n ps(t,vs):foranyvIandv2invs,vIisananestoror adesendentofv2,andvertiesonthepathbetween vIandv2areallinludedinvs. \n Weshallrefertothesekindsofproblems,themainsubjet ofthispaper,asmaximum-weightsumproblems.Ingeneral, \namaximum\u00adweightsumproblemistofnd,fromtheelements ofadatastruture,asubsetwhihsatisfesaertainprop\u00adertypandwhoseweightsumismaximum. \nThemaximum\u00adweightsumproblemsareinterestinginthat theyenompassaverylargelassofoptimizationprob\u00adlems[6,11](seeSetion7forsomeexamples).Thesolving \nofmaximum\u00adweightsumproblems,however,requiresmuh insightfulanalysis.Therearebasiallytwokindsofap\u00adproahes. \nTheAlgebraiApproah. Usingthealgebrailawsofprograms[9,8],onemay trytoalulatee\u00c6ientsolutionstotheproblemsby \nprogramtransformation.Forinstane,Birdderiveda linearalgorithmtosolvethemaximumsegmentsum problem[9],whihisamaximum\u00adweightsumproblem \nonlists.BirdanddeMoor[8]demonstratedthederiva\u00adtionofagreedylinearfuntionalalgorithmforthe partyplanningproblem. \nHowever,thesuessofderivationusuallydependson apowerfulalulationtheoremandrequiresareful andinsightfuljustifationtomeettheonditionsof \nthetheorem.Formanyases,suhjustifationisdif\u00adfultfor(evenexperiened)funtionalprogrammers tomimitosolveothersimilarproblems. \nTheConstrution-trom-prediatesApproah. Thoughlittleknowninfuntionalprogrammingom\u00admunity,ithasbeenknownfordeades[1,27,6,11] \nthatifmaximum\u00adweightsumproblemsarespeifedby regularprediates[11],theyaresolvableinlineartime ondeomposablegraphsandthatlinear\u00adtimealgo\u00adrithmsforthemanbederivedautomatiallyfromthe \nspeifationsofthegraphproblems. Thoughmoresystematiandonstrutivethantheal\u00adgebraiapproah,thisapproahyieldsalgorithmsthat \nsuferfromaprohibitivelylargetable(seeSetion8for details).Thealgorithmforsolvingthepartyplanning problem,forinstane,wouldneedtoonstrutatable \n2(2...)withmorethanentries[11].Thealgorithms thusannotbeputtopratialuse. Inthispaperweproposeanewapproahtoderivingpra\u00adtiallinear\u00adtimealgorithmsformaximum\u00adweightsumprob\u00adlemsoverdatastruturessuhaslists,trees,anddeom\u00adposablegraphs.Thekeypointsofourapproaharetoex\u00adpressthepropertypbyareursivebooleanfuntionover \nthestruturexratherthanausuallogialprediateand toapplyprogramtransformationtehniquestoreduethe onstantfator,therebyexploitingtheadvantagesoftheal\u00adgebraiandonstrution\u00adfrom\u00adprediatesapproahes.Our \nmainontributionsanbesummarizedasfollows. Weproposeanoptimizationtheoremthatgivesa generiandpratiallinear\u00adtimealgorithmsforsolv\u00adingmaximum\u00adweightsumproblems(Setion5).Itpro\u00advidesafriendlyinterfaeforpeoplederivinglinear\u00adtimealgorithms.Moreover,wegiveaalulational \nstrategyfortransformingtheproblemspeifation intotheformtowhihtheoptimizationtheoreman beapplied(Setion6).Thisisatransformationfroma \nreursivebooleanfuntionintoapropertydesription intheformofmutumorphisms.Thistransformation utilizestuplingandfusiontransformations. \n Ouralulationalapproahissimple,general,andfex\u00adible.WedemonstratethisinSetion7byderiving linear\u00adtimealgorithmsforinterestingandnontrivial \nmaximum\u00adweightsumproblems.TheHaskellodesfor solvingalltheproblemsinthispaperareavailableat http://www.ipl.t.u\u00adtokyo.a.jp/ \nsasano/mws.html.  Wearethefrsttosuessfullyapplythealgebraiap\u00adproahtosolvingthehuge\u00adtableproblemappearingin \nthederivationoflinear\u00adtimealgorithmsondeompos\u00adablegraphs[1,27,6,11],aproblemnotsolvedbytable ompression[6]orbydynamitablemanagement[5]. \nThisshouldbeasignifantstepinmakingthetheo\u00adretiallyappealinglinear\u00adtimegraphalgorithmspra\u00adtiallyuseful. \n Theorganizationofthispaperisasfollows.InSetion2we desribeourideainformallybyusingalistversionofthe \npartyplanningproblem.Afterbriefyreviewingthenota\u00adtionalonventionsandsomebasioneptsofprogramal\u00adulationinSetion3,weformallydefnemaximum\u00adweightsumproblemsinSetion4.Wedesribetheoptimiza\u00adtiontheoreminSetion5andouralulationframeworkin \nSetion6.InSetion7wehighlightthefeaturesofourap\u00adproahwithseveralexamples,andinSetion8wedisuss relatedwork.WemakeouronludingremarksinSetion \n9.  2. A TOUR Beforeaddressingourapproahformally,webriefyex\u00adplainourideabygoingthroughthelistversionoftheparty \nplanningproblem. 2.1 Speci.cation Thelistversionofthepartyplanningproblem,whih willbealledthemaximumindependent-sublistsumproblem \n(misforshort),istoomputevs,thesetofelementsfroma non\u00ademptylistxs,suhthatnotwoelementsinvsaread\u00adjaentinxs.Clearly,itisoneofthemaximum\u00adweightsum \nproblemsonlists,whihanbegenerallyspeifedby m.s:[a]-[a] m.sxslwsI[vsIvssubsxs,pmis(xs,vs)] mis::[Elem]->[MElem] \nmisxs=letopts=mis'xs ingetdata(foldr1(bmax[(,w,and) seond) typeWeight=rnt typeElem=Weight typeMElem=(Elem,Bool) \ntypeClass=rnt (,w,and)<\u00adopts, ==2 ==3]) weightweight ::MElem->Weight (w, )=w mis'mis'mis' ::[Elem]->[(Class,Weight,[MElem])] \n[x]=[(2,x,[(x,True)]),(3,\u00b0,[(x,False)])] (x:xs)= markedmarked ::MElem->Bool ( ,m)=m letopts=mis'xs ineahmax[(table(markedmx), \n(ifmarkedmxthenweightmxelse\u00b0)+w, markmark ::Elem->MElem x=(x,True) mx:and) mx<\u00ad[markx,unmark(,w,and)<\u00adopts] \nx], unmarkunmark ::Elem->MElem x=(x,False) bmaxbmax ::Ordw=>(a->w)->a->a->a fab=iffa>fbthenaelseb tabletabletable \n::Bool->ClassTrue\u00b0=\u00b0True1=\u00b0 ->Class eahmax::(Eq,Ordw)=>[(,w,a)]->[(,w,a)] eahmaxxs=foldlf[]xs wheref[](,w,and)=[(,w,and)] \nf((,w,and):opts)(',w',and')= if=='then ifw>w'then(,w,and):opts tabletabletabletabletabletable True2=\u00b0True3=2 \nFalse\u00b0=1 False1=1 False2=3 False3=3 elseopts++[(',w',and')] else(,w,and):fopts(',w',and') seond( ,x, \n)=x getdata( , ,x)=x Figure1:Alinear-timeHaskell wheresubsenumeratesallsublists(notneessarilyontigu\u00adous)ofalist. \nWhatisleftistodefnepmis,thespeifomponentofthe problem.Beausevsisasublistofxs,weanspeifypmisin twosteps:frstmarkingtheelementsinxswhihbelongto \nvs,andthenonthemarkedxsdefningtheproperty.Thus, pmis(xs,vs)p(markingxsvs). Herepheksthatallpairsofmarkedelementsarenotad\u00adjaentinthemarkedxs. \n p : [a]-Bool p[x] True p(x:xs) ifmarkedx thennot(marked(hdxs)) 1 p x s elsep x s hd:[a]-a hd[x]x hd(x:xs)x \nForlatertransformation,wedefnehdinthesamewayasp overthetwoasessingletonlistandonslist.Somuhfor ourspeifationoftheproblem.Itisworthnotingthatour \nspeifationisasnaturalasthatin[11]usingthemonadi seond\u00adorderlogi(SeeSetion4.2).Theritialdiferene isinspeifyingpbyusingareursivefuntioninsteadof \nalogialprediate.Thisenablesustousethefuntional programalulationforthelaterderivation.  2.2 Derivation \nThederivationisbasedonouroptimizationtheoremin Setion5,whihsaysthatifthepropertydesriptionpan bedefnedinmutumorphisms[15,18,17],thenalinear\u00adtime \nalgorithmsolvingthemaximum\u00adweightsumproblemwithre\u00ad programforthemisproblem. spettopanbederivedautomatially. \nTherefore,thederivationofalinear\u00adtimealgorithmforthe misproblemreduestobeaderivationofmutumorphisms forp.Morepreisely,wehopetotransformptothefollowing \nform: p[x]\u00a2Ix p(x:xs)\u00a22x(pxs,pIxs,...,pxs) where\u00a2i'sdenotesomefuntionsandpi'sareauxiliaryprop\u00adertydesriptionsdefnedinafashionsimilartothatinwhih \npisdefned: pi :[a]-Bool pi[x]\u00a2iIx pi(x:xs)\u00a2i2x(pxs,pIxs,...,pxs). Considernowthepforthemisproblem.ByintroduingpI \ndefnedby pI :[a]-Bool pI[x]not(markedx) pI(x:xs)not(markedx) weantransformptothefollowingform. p[x]True \np(x:xs)ifmarkedxthenpIxs1pxselsepxs Applyingourgeneraloptimizationtheoremforsolving maximum\u00adweightsumproblemsnowsoonyieldsalinear\u00adtimealgorithmlikethatinFigure1,wherethealgorithm \nisodedinHaskell.ThefuntionbmaxinFigure1orre\u00adspondstotheseletionoperatorl.Themainfuntionmis takesalistasitsargumentandreturnstheinputlistwith \ntheseletedelementsmarkedwithTrue.Forexample,mis [1..4]returns [(1,False),(2,True),(3,False),(4,True)]. \n Theargumenttoeahmaxhasatmost8elements, andsodoestheseondargumentoffusedtodefne eahmax.Soeahmaxosts0(1)time.Therefore,the \nauxiliaryfuntionmis'isalinear\u00adtimeprogram.  Theoptsinthebodyofmishasatmost4elements,so itostsonstanttimetoproduethefnalresultafter \nomputingmis'  xs. Thefuntionmis'omputesoneoptimalsolutionforeah lass,wherelassesorrespondtoelementsofrangeofh \ndefnedasfollows. h:[a]-(Bool,Bool) hx(px,pIx) Class0orrespondsto(False,False),Class1to(False,True), Class2to(True,False),andClass3to(True,True).These \nlassesanbeinterpretedasfollows. Class0meansthatpdoesnotholdandpIdoesnot hold.Thismeansthattheheadofthelistismarked \nandthesetofmarkedelementsinthelistisnotinde\u00adpendent.  Class1meansthatpdoesnotholdandpIholds.This meansthattheheadofthelistisnotmarkedandthe \nsetofmarkedelementsinthelistisnotindependent.  Class2meansthatpholdsandpIdoesnothold.This meansthattheheadofthelistismarkedandtheset \nofmarkedelementsinthelistisindependent.  Class3meansthatpholdsandpIholds.Thismeans thattheheadofthelistisnotmarkedandthesetof \nmarkedelementsinthelistisindependent.  Fromthefuntionh,weanautomatiallyderivethedef\u00adnitionoftable.SeeSetion5fordetails. \n 2.3 Remarks Tworemarksareworthmaking.First,theoptimization theorem,whihwillbedisussedindetailinSetion5,plays \nasignifantroleinourderivation.Toapplythistheorem, theonlythingonehavetodoistofndthepropertydesrip\u00adtioninmutumorphiform. \nSeond,thepropertydesriptioninmutumorphiform anbederivedfromareursivepropertydesriptionbyus\u00adingthealulationalstrategywepresentinSetion6.This \nderivationutilizestuplingandfusiontransformations,whih arenothingveryspeialandforwhihawealthofalula\u00adtiontehniqueshavebeendeveloped[18,8].Ourderivation \nisthussurprisinglysimpleandpowerful.  3. PRELIMINARIES Inthissetionwebriefyreviewthenotationalonventions \nandsomebasioneptsofprogramalulation[7,20,8] usedinthispaper. 3.1 Recursive Data Types Tosimplifythepresentationandproofoftheoptimization \ntheoreminSetion5,werestritourselvestoonsidering polynomialdatatypes.Andtoavoidategorialnotations, wedesribepolynomialdatatypesinthefollowingform. \nD a GI(a,DI, . . . , D .) I G2(a,DI, . . . , D .) I I G (a,DI, . . . , D .) HereDi'sdenoteD a , a n d \nGi'sarealleddataonstrutors applyingtoanelementoftypeaandaboundednumber ofreursiveomponents.Thoughseemlyrestrited,these \npolynomialdatatypesarepowerfulenoughtooverour ommonlyuseddatatypes,suhaslists,binarytrees,rooted trees[6],andseries\u00adparallelgraphs[23].Moreover,other \ndatatypesliketherosetrees,akindofregulardatatype defnedby RTreeaNodea[RTreea], anbeenodedintooneofthesepolynomialdatatypes. \nThiswillbedemonstratedinSetion6. ForeahdataonstrutorGi,wedefne.iby .if(e,xI,...,x.)(e,fxI,...,fx.). \n3.2 Catamorphism Catamorphisms,oneofthemostimportantoneptsin programalulation[20,22,8],formalassofimportant \nreursivefuntionsoveragivendatatype.Theyarethe funtionsthatpromotethroughthedataonstrutors. Forexample,forthetypeoflists,giveneand,there \nexistsauniqueatamorphismatasatisfyingthefollowing equations. ata[]e ata(x:xs)x(ataxs) Inessene,thissolutionisarelabeling:itreplaeseveryo\u00adurreneof[]witheandeveryourreneof:withinthe \nonslist.Beauseoftheuniquenesspropertyofatamor\u00adphisms(i.e.,forthisexampleeanduniquelydeterminesa atamorphismoveronslists),weusuallydenotethisata\u00admorphismasata([e']). \nDEFINITION1(CATAMORPHISM).Aatamorphismover areursivedatatypeDisharaterizedby f([\u00a2I,...,\u00a2 ])D f\u00c6Gi\u00a2i\u00c6.if(1,...,k) \nItitisleartromtheontext,weusuallyomitthesubsript Din([\u00a2I,...,\u00a2 ])D. . Catamorphismsplayanimportantroleinprogramtransfor\u00admation(programalulation)beausetheysatisfyanumber \nofniealulationalpropertiesinwhihthetusiontheorem isofgreatestimportane: THEOREM1(FUSION). f\u00c6([\u00a2I,...,\u00a2 \n])D([ I,..., ])D providedthattoreverywith1::k f\u00c6\u00a2i i\u00c6.if. . Thefusiontheoremgivestheonditionthathastobesat\u00adisfedinordertopromote(fuse)afuntionintoaatamor\u00adphismtoobtainanewatamorphism.Itatuallyprovides \naonstrutivebutpowerfulmehanismforderivinga\"big\u00adger\"atamorphismfromaprograminaompositionalstyle, atypialstyleforfuntionalprogramming.Whenapplying \nthefusiontheorem,wemaydogeneralization,whihisan operationsubstitutinganewfuntionforthetargetpartof thefusiontransformation. \n 3.3 Mutumorphisms Mutumorphisms,generalizationsofatamorphismstomu\u00adtuallydefnedfuntions,aredefnedasfollows[15,16,17]. \nDEFINITION2(MUTUMORPHISMS).FuntionsfI,f2, ...,faresaidtobemutumorphismsonareursivedata typeDaiteahtuntionfiisdefnedmutuallyby \nfi\u00c6Gj\u00a2ij\u00c6.j(fI f2 ... f) torj{1,2,...,k}. . NotethatfI f2 ... frepresentsafuntiondefned asfollows. (fI \nf2 ... f)x(fIx,f2x,...,fx) Itisknownthatmutumorphismsanbeturnedintoasingle atamorphismbythetuplingtransformation[15,16,17]. \nTHEOREM2(MUTUTUPLING).ItfI,f2,...,fare mutumorphismslikethoseinDefnition2,then fI f2 ... f([\u00a2I,\u00a22,...,\u00a2])D \nwhere\u00a2i\u00a2Ii ... \u00a2itor1,...,k..  4. MAXIMUM-WEIGHTSUM PROBLEMS Beforeaddressingourapproah,weshouldbemorepre\u00adiseaboutthemaximum\u00adweightsumproblemsandshould \nlarifythelimitationsoftheexistingsolutions. 4.1 A Formal De.nition Amaximum\u00adweightsumproblemanberephrasedasfol\u00adlows.Givenadatastruturex,thetaskistofndawayto \nmarksomeelementsinxsuhthatthemarkeddatastru\u00adturex,sayx . ,satisfesaertainproperty,sayp,andthe weightsumofthemarkedelementsismaximum.Herethe \n\"maximum\"meansthatnoothermarkingofxsatisfying panproduealargerweightsum.Astraightforwardso\u00adlution,whoseomplexityisexponentialinthenumberof \nelementsinx,isasfollows. mws:(Da . -Bool)-Da-Da . mwspxlwsumI[x .Ix . genx,px .] Weusegenxtogenerateallpossiblemarkingsofinput \ndatax,andfromthosewhihsatisfythepropertypweuse lwsumItoseletonewhoseweightsumofmarkedelements ismaximum. \nBeforedefninggenandwsum,weexplainsomeofour notationformarking.Foradatatypeofa,weusea .to extendawithmarkinginformation.Itanbedefnedmore \nonretelyby a . (a,Bool) whereabooleanvalueindiateswhetherornottheelement . b.. oftypeaismarked.Aordingly,weusea,,...,x \ntodenotevariablesofthetypea . orthetypeDa .(i.e., D(a .)). Thefuntiongen,exhaustivelyenumeratingallpossible \nwaysofmarkingorunmarkingeveryelement,anbereur\u00adsivelydefnedby gen:Da-[Da .] gen([7I,...,7]) where .. 7i(e,xs \nI,...,xs) . .. . [Gi(e,xI,...,x)I . e . [marke,unmarke], . . xI xsI, . . x2 xs2, . . . x . . xs . .] \n( 1 . . . k ) wheremarkandunmarkarefuntionsformarkingandun\u00admarking: markx(x,True) unmarkx(x,False). \nThefuntionwsumomputesthesumofweightsof markedelementsinadatastruture: wsum:Da . -Weight wsum([\u00a2I,...,\u00a2]) \nwhere \u00a2i(e . ,wI,...,w.) (ifmarkede .thenwe.ghte .else0)+ wI++w. wheremarkedisafuntionwhihtakesasitsargumentan \nelemente .andhekswhethere .ismarked. marked:Da . -Bool marked(e,m)m. Somuhforthespeifationofmws,withwhihwean \ndefnevariousmaximum\u00adweightsumproblems.Forexample, themisprobleminSetion2anbespeifedby m.smwsp wherepisthedesriptionofthe\"independent\"property \nspeifedinSetion2. 4.2 Limitation of Borie s Approach Themaximum\u00adweightsumproblemshavemanyinstanes ingraphalgorithms.Bernetal.showedthatmanygraph \nproblems suhastheminimumvertexoverproblem,the maximumindependentsetproblem,themaximummath\u00adingproblem,andthetravelingsalesmanproblem \nanbe desribedbymws,and,moreinterestingly,thattheyanbe solvedinlineartimeondeomposablegraphs[6].Basing \ntheirworkonBernetal.'sandonCourelle's[14],Borie etal.proposedamethodforautomatiallyonstruting linear\u00adtimealgorithmsthatsolvethemaximum\u00adweightsum \nproblems[11]. Themainideaistorestritthepropertyptobedesribed intermsofasmallanonialsetofprimitiveprediates(suh \nastheinidentprediateIn(v,e))oraombinationofthem bylogialoperators(1,V,and-)and(eitherfrst\u00adorder orseond\u00adorder)quantifers(Vand:).Forexample,the \np VvIVv2-Adj(vI,v2) Adj(vI,v2):eI(In(vI,eI)1In(v2,eI)) 1-(vIv2). Withthisrestrition,itispossibletoautomatiallyon\u00adstrutalinear\u00adtimealgorithmformwspfromtheprediative \nstrutureofp. Thoughattrativeintheory,alinear\u00adtimealgorithmneeds toreateahugetable,andthispreventsthesealgorithms \nfromatuallybeingused[6,11,5].Thetablereatedfor themaximumindependentsetproblem,forinstane,on\u00ad 2(2...)tainsmorethanentries.Thefuntionalapproahwe \nproposeanreduethisnumberto8(SeeFigure1).  5. THE OPTIMIZATION THEOREM Thissetionfousesonaformalstudyofourfuntional \napproahtosolvingthemaximum\u00adweightsumproblems,in whihapproahourmaintheorem,theoptimizationtheo\u00adrem,playsasignifantrole.Itnotonlylarifesasu\u00c6\u00adientonditionfortheexisteneoflinear\u00adtimealgorithms, \nbutalsogivesaalulationrulefortheonstrutionofsuh algorithms.Aswillbeseenlater,thekeypointsofouralu\u00adlationarethefuntional(ratherthanprediative)struture \nofpropertydesriptions,andthegoodusemadeofprogram transformationsuhasfusionandtupling[17,16,15].We beginherebygivinginLemma3asu\u00c6ientonditionun\u00adderwhihe\u00c6ientlinear\u00adtimealgorithmsareguaranteedto \nexist.ThenweusemutumorphismstoformalizeinLemma 4thelassofproblemsweansolveinlineartime.Finally, wesummarizethetwolemmasinouroptimizationtheorem. \n 5.1 A Suf.cient Condition Itisobviousthatnotalloptimizationproblemsspeifed by spe:Da-Da . spemwsp anbesolvedinlineartime.Ourfrstresultgivesasu\u00c6ient \nonditionforpintheformoftheompositionofafuntion andaatamorphism. LEMMA3(OPTIMIZATIONLEMMA).Letspebedefned \nby spe:Da-Da . spemws(aept\u00c6([\u00a2I,...,\u00a2])). Itthedomainottheprediateaeptisfnite,thenspean besolvedinlineartime. \n. Toprovethelemma,wedefneanoptimizationfuntion optinFigure2.Wewillshowthatoptsolvesspeorretly andthatisomputableinlineartime.InFigure2,getdatais \nafuntionwhihtakesasitsargumentatripleandreturns thethirdelement. getdata(,w,r.)r . Correctness Hereweshowhowtheright\u00adhandsideof \nspexoptaept\u00a2I...\u00a2x istransformedintotheleft\u00adhandside.Inthetransformation rulesweusetheauxiliaryfuntionsi.(1,...,k)defned \nby i.(e,andI,...,and.) [(\u00a2i(e . ,I,...,.), (ifmarkede .thenwe.ghte .else0) +wI+...+w., .. . Gi(e,rI,...,r))I \n. e . [marke,unmarke], . (I,wI,rI)andI,, (.,w.,r . .)and.]. optaept\u00a2I...\u00a2x {unfoldopt} getdata(lsndI[(,w,r.) \nI(,w,r.)([I,...,])x, aept]) .. {( ,I,D)=eahmax\u00c6( ,I,D)} getdata(lsndI .. [(,w,r.)I(,w,r.)eahmax(([I,...,])x), \naept]) {flter(aept\u00c6fst)\u00c6eahmax= eahmax\u00c6flter(aept\u00c6fst)} getdata(lsndI(eahmax .. [(,w,r.)I(,w,r.)([I,...,])x, \naept])) {1snd/\u00c6eahmax=1snd/} getdata(lsndI(eahmax .. [(,w,r.)I(,w,r.)([I,...,])x, aept])) {=( \u00a2I\u00a2D)r.} \ngetdata(lsndI .. [(,w,r.)I(,w,r.)([I,...,])x, aept(([\u00a2I,...,\u00a2])r .)]) {getdata\u00c61snd/=1wsum/\u00c6mapgetdata} \n.. lwsumI[r .Ir . (mapgetdata\u00c6([I,...,]))x, aept(([\u00a2I,...,\u00a2])r .)] .. {( 7I7D)=mapgetdata\u00c6( ,I ,D)} lwsumI[r \n.Ir . ([7I,...,7])x, aept(([\u00a2I,...,\u00a2])r .)] {foldmws} mws(aept\u00c6([\u00a2I,...,\u00a2]))x {foldspe} spex Thefrsttransformationruleissimplyanunfoldingofopt. \nTheseondtransformationruleis .. ([I,...,])eahmax\u00c6([I,...,]). Therelationbetweeniandi.isasfollows. ieahmax\u00c6i \n. Thefuntion([I,...,])appliesthefuntioneahmaxto thelistofandidatesateahstage.Thefuntioneahmax\u00c6 .. ([,...,]),however,frstreatesallthemarkingsofin\u00ad \nI putdataandorrespondingweightsandlasses.Thenit appliesthefuntioneahmax.Thesetwofuntionsompute thesameandidatesolutionsbeausethefuntioneahmax \ntakesalistwhihontainsandidatesolutionsandreturnsa listwhihonsistsoftherightmostoptimalsolutionforeah \nlassintheinputlist,preservingtheorder,andthefuntion eahmaxisidempotent(i.e.,eahmax\u00c6eahmaxeahmax). optaept\u00a2I...\u00a2xgetdata(lsndI[(,w,r.)I(,w,r.)([I,...,])Dx,aept]) \nwherei(e,andI,...,and.) eahmax[(\u00a2i(e . ,I,...,.), (ifmarkede .thenwe.ghte .else0)+wI+...+w., .. . Gi(e,rI,...,r))I \n. e . [marke,unmarke], (I,w,r . andI,,(,w,r .)and](1,...,k) II).... Figure2:Optimizationfuntionopt. \nThethirdtransformationrule flter(aept\u00c6tst)\u00c6eahmax eahmax\u00c6flter(aept\u00c6tst) meanstheommutativitybetweenflterandeahmaxfun\u00adtions,whereflteristheabbreviationof \nAp.Axs.[xIxxs,px]. Thefuntionflter(aept\u00c6tst)\u00c6eahmaxfrstappliesthe funtioneahmaxandthenflters.Thefuntioneahmax\u00c6 \nflter(aept\u00c6tst)frstfltersandthenappliesthefuntion eahmax.Thesetwofuntionsomputethesameresultbe\u00adausetheprediate(aept\u00c6tst)isonernedonlywiththe \nlassesandbeausethefuntionsflterandeahmaxpreserve theorder. Thefourthtransformationruleis I\u00c6eahmaxI. lsndlsnd \nThisequationholdsbeauseIreturnstherightmost lsnd optimalsolution,andeahmaxreturnsalistwhihonsists oftherightmostoptimalsolutionforeahlassintheinput \nlist,preservingtheorder. Theffthtransformationruleis ([\u00a2I,...,\u00a2])r . . Thismeansthatthelasstowhihr .belongsis,whih \nanbeshownbyindution. Thesixthtransformationruleis getdata\u00c6lIlwsumI\u00c6mapgetdata. snd Thisholdsbeausetheseondelementistheweightsumof \nthethirdelement,whihanbeshownbyindution. Theseventhtransformationrule ([7I,...,7])mapgetdata\u00c6([,...,]) \nI followsfromTheorem1. Theeighthandninthtransformationrulesaresimplythe foldingsofmwsandspe. . Linearity \nHereweshowthatthefuntionoptislinear. optaept\u00a2I...\u00a2x getdata(lsndI [(,w,r.)I(,w,r.)([I,...,])Dx,aept]) \nTheimportantobservationisthatthenumberofelements inthelist([I,...,])Dxisboundedbythenumberof lassesI(i.e.,thenumberofelementsinthedomainofaept \nIFromtheonditionthatthedomainofaeptisfnite,we knowtherangeoftheatamorphism([\u00a2I,...,\u00a2])isfnite. ortherangeoftheatamorphism)beauseeahmaxreturns \nalistwhoselengthisboundedbythenumberoflasses. Therefore,if([I,...,])Dxanbeomputedinlinear time,soanopt. \nToprovethat([I,...,])Disalinear\u00adtimealgorithm,it issu\u00c6etoshowthatieandI...and.anbeomputed inonstanttime.Takingthefatthat\u00a2ianbeomputed \nin0(1)timebeausethesizeofitsargumentisindependent oftheinput,weanseethattheonstrutionofeahtriple (,w,r.)(i.e.,eahelementonsumedlaterbyeahmax)an \nbeomputedin0(1)timebeauseanbeobtainedin0(1) timeby\u00a2i,wbyperformingthe+operationnitimes,and .... rsimplybyombininge,r,...,r.Hereniisbounded \nI . by Nmax{niI1::k}. Moreover,exatly(2IandII...IandI)triplesof . (,w,r)aregenerated,andthisnumberisboundedbythe \nonstant2,whereGisthenumberoflasses.Therefore, GNtheomplexityofieandI...and.is0(1).Thoughthe sizeoftheboundinreasesexponentiallywithN,inmany \nwell\u00aduseddatatypes,suhaslistsandbinarytrees,Nis small(perhapsoneortwo). . Remarks ThislemmawasinspiredbyBernetal.'sworkondeompos\u00adablegraphs[6],whereasimilaronditionondeomposable \ngraphswasgiven.Wegeneralizetheideafromdeompos\u00adablegraphs2togenerireursivedatatypes.Moreover,we giveaonretelineartimealgorithmusingtheoptimization \nfuntionoptinFigure2. Intheoptimizationlemma,wegivetheoptimizationfun\u00adtionopttoomputeanoptimalsolution.Itisworthnoting \nthatbyslightlyhangingthedefnitionoftheoptimization funtionopt,weanalsodoreognitionandenumerationin lineartime.Reognitionmeansreognizingwhetherornota \nsolutionsatisfyingthepropertydesriptionexists,andenu\u00admerationmeansountingthenumberofsolutionssatisfying \nthepropertydesription[11].  5.2 Decomposition Lemma Toapplytheoptimizationlemma,weneedtorepresent thepropertydesriptionpasaept\u00c6([\u00a2I,...,\u00a2]),where \nthedomainofaeptisfnite.Thefollowinglemmagivesa methodfortransformingthepropertydesriptionpintothe aboveformwhenpisdefnedusingmutumorphisms. \nAsseeninSetion2,thisatamorphismprojetstheinput tothisfniterange,whoseelementsarealledlasses[6]. 2Deomposablegraphsdonotallowtheadditionofanew \nelementwhengluingsmallergraphs. poaept\u00c6([\u00a2I,...,\u00a2]), wherethedomainotaeptisfnite.. PROOF.Toprovethelemma,wesupposethatmutumor\u00adphismspo,pI,...,paredefnedasfollows.Foreah \n{0,1,...,n}andeahj{0,1,...,k}, pi\u00c6Gj\u00a2ij\u00c6.j(popI p). Bythemututuplingtheorem,wehave popI...p([\u00a2I,...,\u00a2])D \n(1) where \u00a2i\u00a2oi\u00a2Ii...\u00a2i(1,...,k). Bydefning aept(xo,xI,...,x)xo, weobtain poaept\u00c6([\u00a2I,...,\u00a2])D. Nextweshowthatthedomainofaept,i.e.,therange \nof([\u00a2I,...,\u00a2])D,isfnite.Funtionspo,pI,...,phave rangeswhihonsistoftwoelements,TrueandFalse.So, fromequation(1),thenumberofelementsintherangeof \n+I ([\u00a2I,...,\u00a2])Dis2,whihisafnitenumber.Thismeans thatthedomainofaeptisfnite. 5.3 The Main Theorem Combiningtheabovetwolemmas,weobtaintheopti\u00admizationtheorem. \nTHEOREM5(OPTIMIZATIONTHEOREM). Themaximum-weightsumproblemspeifedby spe:Da-Da . spemwspo anbesolvedinlineartimeitthepropertydesriptionpo: \nDa . -Boolanbedefnedasmutumorphismswithother propertydesriptionspi:Da . -Booltor1,...,n.. Thistheoremprovidesafriendlyinterfaeforthederiva\u00adtionofe\u00c6ientlinear\u00adtimealgorithmssolvingthemaximum\u00adweightsumproblems.Whenthepropertydesriptionisde\u00adfnedasmutumorphismswhihonsistofnpropertydesrip\u00adtions,aderivedatamorphismwillhaverangewhihhas2 \nelements.Inmanyases,propertydesriptionpanbeeas\u00adilydesribedasmutumorphismswhihonsistofasmall numberofpropertydesriptions(twotofourforexamples \ninthispaper).Forexample,thepartyplanningproblem isdesribedwithmutumorphismswhihonsistofonlytwo propertydesriptions.Thismeansthatthelinear\u00adtimeal\u00adgorithmsobtainedarepratial. \nToseehowthetheoremworks,reallthemisproblemin Setion2.ThepropertydesriptionpisdefnedwithpIin thefollowingmutumorphiform: \np[x]True p(x:xs)ifmarkedxthenpIxs1pxselsepxs pI[x]not(markedx) pI(x:xs)not(markedx) Itfollowsfromtheoptimizationtheoremthatane\u00c6ient \nlinear\u00adtimealgorithmsolvingthemisproblemanbederived automatially. Itiseasytoextendlemma4andtheorem5toallowthe \npropertydesriptionpotobedefnedasmutumorphisms withotherfuntionswhoserangesarefnite.  6. CALCULATION \nSTRATEGY Inthissetionweshowhowtoderivepratiallinear\u00adtime algorithmsthatsolvethemaximum\u00adweightsumproblemsby \napplyingtheoptimizationtheorem. SpeifationSpeifythepropertydesriptionforagiven maximum\u00adweightsumproblemusingareursivefun\u00adtionponadatastrutureR. \nStep1IfRisnotapolynomialdatatype,fndapolyno\u00admialdatastrutureDintowhihRanbeenoded, andthentransformthepropertydesriptionponR \nintop . onD.IfthedatastrutureRisapolynomial datastruture,thendonothing.Thatis,letp . p andDR. Step2Derivep \n.intermsofmutumorphismswhihon\u00adsistofseveralpropertydesriptionspo.,pI. ,...,p . on Dbygeneralizingsomepartinp \n.andfusingit.If neessary,dotuplingtransformationtogetaatamor\u00adphism,sineaatamorphismmustbeobtainedwhen \napplyingthefusiontheorem. Step3Applytheoptimizationtheoremtogetalinear\u00adtime algorithmthatsolvesthemaximum\u00adweightsumprob\u00adlem. \nWedemonstratethesestepsonthepartyplanningproblem. The Party Planning Problem SpeifationTheinputsinthepartyplanningproblem \naretrees,soweanusethefollowingreursive(regu\u00adlar)datastruture. Orga::Leadera[Orga] Thespeifationoftheproblemis \npp:Orga-Orga . ppmwsp wherethepropertydesriptionpofthepartyplanning problemanbewrittenasfollows. p:Orga \n. -Bool p(Leaderv[])True p(Leaderv(t:ts)) not(bothmarkedv(getLeadert))1 pt1p(Leadervts) Ifthetreeontainsonlyasinglenode,thentheprop\u00adertyissatisfed.OtherwisewehekitsrootvIwith \nitshildrenonebyonetomakeertainthatbothvI anditshildarenotmarkedatthesametime,and thenwehekotherpartsofthetreereursively.Here \nbothmarkedvIv2isusedtohekwhetherbothvI andv2aremarked,andgetLeaderreturnstherootof theorganizationtree: \nbothmarked:a . -a . -Bool bothmarkedvIv2markedvI1markedv2 getLeader:Orga-a getLeader(Leadervts)v. Notiethatourinitialspeifationisratherstraight\u00adforward. \nStep1ThedatatypeOrgaisregularbutnonpolynomial datatypewhosenodesanhavearbitrarilymanyhil\u00addren.SowetransformthisdatatypeOrgaintoapoly\u00adnomialdatatype.Infat,weanrepresentthetype \nOrgabythefollowingbinarytreestruture,alleda rootedtree[6]. RTreea::Roota IJoin(RTreea)(RTreea) Therelationbetweenthesetwodatatypesanbeap\u00adturedbythefollowingfuntions. \nr2o:RTreea-Orga r2o(Rootv)Leaderv[] r2o(JointIt2)letLeadervtsr2ot2 inLeaderv((r2ot):ts) I o2r:Orga-RTreea \no2r(Leaderv[])Rootv o2r(Leaderv(t:ts)) Join(o2rt)(o2r(Leadervts)) Thesetwofuntionsonvertdatatypesinlineartime. \nNextwetransformthepropertydesriptionponOrga top . onRTreea.Letp .andgetLeader.bethefuntions onRTreeawhihorrespondtopandgetLeaderon \nOrga.Thesefuntionsshouldsatisfythefollowing equations. p . :RTreea . -Bool p .tp(r2ot) getLeader. :RTreea-Bool \ngetLeader.tgetLeader(r2ot) Asimplefusionalulationyields p .(Rootv)True p .(JointIt2) not(marked(getLeader.tI)1 \nmarked(getLeader.t2))1 p .tI1p .t2 getLeader.(Rootv)v getLeader.(JointIt2)getLeader.t2. Step2Torepresentp \n.usingmutumorphismswhihonsist ofonlypropertydesriptions,wegeneralizethepart marked\u00c6getLeader.andletitbelm. \n. lm. :RTreea . -Bool lm. marked\u00c6getLeader. Byasimplefusionalulationweanget lm.(Rootv)markedv lm.(JointIt2)lm.t2. \nNowweanrepresentp .usingmutumorphismswhih onsistofthefollowingtwopropertydesriptions. p .(Rootv)True \np .(JointIt2)not(lm.tI1lm.t2)1 p .tI1p .t2 lm.(Rootv)markedv lm.(JointIt2)lm.t2 Step3Byapplyingouroptimizationtheorem,wegetthe \nfollowinglinear\u00adtimealgorithm. ppr2o\u00c6(optaept\u00a2I\u00a22)\u00c6o2r where aept(xo,xI)xo \u00a2Iv(True,markedv) \u00a22(aI,bI)(a2,b2) \n(not(bI1b2)1aI1a2,b2) Somuhforthederivation.Notethatweangofur\u00adthertoompute\u00a2istatiallyandstoreitinatable, \nthoughthisisnotneessary.Todoso,defnefour lassesby o(False,False) I(False,True) 2(True,False) 3(True,True) \nandsimplifythefuntionsaept,\u00a2I,and\u00a22.We write\u00a22asatable. aept(2)V(3) \u00a2Ivifmarkedvthen3else2 \u00a22 o I 2 3 \no o I o I I o I o I 2 o I 2 3 3 o I 2 I  7. FEATURES Inthissetionwehighlightseveralimportantfeaturesof \nouralulationalapproahforsolvingthemaximum\u00adweightsumproblems:itssimpliity,generality,andfexibil\u00adity. \n7.1 Simplicity First,asseeninthederivationofalinear\u00adtimealgorithm forsolvingthepartyplanningproblemaswellasseenin \nSetion2,ouralulationissurprisinglysimple.Withthe optimizationtheorem,allweneedtodoisderiveamutu\u00admorphiformofthepropertydesription.Fortunately,there \narealotofhandyalulationstrategiesforderivingmutu\u00admorphisms[17],suhasgeneralizationofsubexpressionsto \nfuntionsandfusiontransformation[18,8]. Inthefollowingweshallfurtherillustratethissimpliity bysolvingtheothertwoproblemsmentionedintheIntro\u00addution,whosederivationoflinearalgorithmsareindeed \nnotsostraightforwardforevenanexperienedfuntional programmer. Group Organizing Problem Theinputsinthegrouporganizingproblemaretrees,and \nweusethesamedatastrutureOrgathatweusedforthe partyplanningproblem.Thepropertyponthemarkedtree forthisproblemisthatoneoftheanestornodesofany \nThispropertypanbeexpressedusingthefollowingmutu\u00adtwomarkednodesmustbemarked.Thisanbedesribed morphismswhihonsistofonlypropertydesriptions. \nreursivelyby p . :RTreea . -Bool p .(Rootv)True p:Orga . -Bool p(Leaderv[])True p(Leaderv(t:ts)) ifmarkedvthenTrue \nelseifnmtthenp(Leadervts) elsept1nm(Leadervts). Thefrstequationmeansthatasingle\u00adnodetreealwayssat\u00adisfesp.Theseondequationmeansthatforatreewiththe \nrootv,iftherootismarked,thenanywayofmarkingthe nodesofitssubtreesisaeptable.Otherwise,wehaveto hekeahofthesubtreestomakesurethatatmostasingle \nsubtreehasmarkednodes.Thefuntionnmtheksthat thetreethasnomarkednodes;itisdefnedasfollows. nm(Leaderv[])not(markedv) \nnm(Leaderv(t:ts))nmt1nm(Leadervts) UsingthealulationalstrategydesribedinSetion6,we anturnthesefuntionsintothefollowingmutumorphisms \nonRtreea,whihonsistofonlypropertydesriptions,and thusanobtainalinear\u00adtimealgorithmforthegrouporga\u00adnizingproblem. \np . : RTreea . -Bool p .(Rootv) True p .(JointIt2) iflm .t2thenTrue elseifnm .tIthenp .t2 elsep .tI 1 \nnm .t2 nm .(Rootv) not(markedv) nm .(JointIt2) nm .tI 1 nm .t2 Supervisor Chaining Problem Similarly,forthesupervisorhainingproblemweanspeify \nthepropertythatthemarkednodesformapathhainas follows. p:Orga . -Bool p(Leaderv[])True p(Leaderv(t:ts)) \nifmarkedvthen ifnmtthenp(Leadervts) elsemarked(getLeadert)1pt1 ol(Leadervts) elseifnmtthenp(Leadervts) \nelsept1nm(Leadervts) Thefuntionoltheksthattheleaderofthetreetis markedandtheothernodesoftarenotmarked. \nol(Leaderv[])markedv ol(Leaderv(t:ts))nmt1ol(Leadervts) p .(JointIt2)iflm.t2then ifnm .tIthenp .t2 elselm.tI1p \n.tI1ol.t2 elseifnm .tIthenp .t2 elsep .tI1nm .t2 ol.(Rootv)markedv ol.(Joint1t2)nm .tI1ol.t2 Nowweanuseouroptimizationtheorem,aswedidfor \nthepartyingplanningproblem,toobtainalinear\u00adtimeal\u00adgorithmthatsolvesthesupervisorhainingproblem.  7.2 \nGenerality Ourapproahisgeneral(polytypi)enoughtodealwith maximum\u00adweightsumproblemsondatastruturesthatare \nnotlistsortrees.Toillustratethis,wederivealinear\u00adtime algorithmsolvingthemaximumtwodisjointpathsproblem \nonseries\u00adparallelgraphs[23]. Theseries\u00adparallelgraphisdefnedasfollows. SPG::Base(Vert,Vert,Edge) ISeriesSPGSPG \nIParallelSPGSPG HereVertrepresentsthetypeofvertiesandEdgerepresents thetypeofedges.Everygraphshouldhaveasinglesoure \nandasinglesink.ThetwodataonstrutorsareSeriesand Parallel.SeriesgIg2makessenseonlywhenthesinkofgI isthesoureofg2,andParallelgIg2makessenseonlywhen \ngIandg2shareasoureandasink. Figure3showsthemeaningoftheonstrutors.Forex\u00adample,themiddlegraphinFigure3isrepresentedby \ngSeries(Base(u,w,e1))(Base(w,v,e2)). Themaximumtwodisjointpathsproblemisdefnedasfol\u00adlows:whengiventwovertiessandt,fndtwodisjointpaths \nbetweenthetwovertiess,tsuhthatthesumoftheedge weightsismaximum.Sinethetwodisjointpathsbetween thevertiessandtanbeseenasayleontainingthever\u00adtiessandt,weanspeifythepropertypoftheproblem \nby p:Vert-Vert-SPG-Bool pstgyleg1thsg1thtg. Hereylejudgeswhetherthemarkededgesinthegraph formayle,andthvjudgeswhetherthereisamarked \nedgeinidenttothevertexv.Thesetwofuntionsanbe defnedasfollows. yle(Basee)not(markede) yle(SeriesgIg2)(ylegI1nmg2)V \n(nmgI1yleg2) yle(ParallelgIg2)(ylegI1nmg2)V (nmgI1yleg2)V (spangI1spang2) thvg anyMarked(.nvg) Thefuntionspanjudgeswhetherthemarkededgesinthe \ngraphspanbetweenthesoureandsinkofthegraph,nm  e1 e2  e1 e2  w uw v e uwv uv e1 e2 e3  uv \n Base graph uwv  Parallel operation Series operation uv  Figure3:Operationsofseries-parallelgraphs. \njudgeswhetherornottherearemarkededgesinthegraph, anyMarkedtakesasitsargumentalistofedgesesandjudges whetherornotthereisamarkededgeines,and.nvg \ngathersalltheedgesofgwhihareinidenttothevertexv. span(Basee)markede span(SeriesgIg2)spangI1spang2 span(ParallelgIg2)(spangI1nmg2)V \n(nmgI1spang2) nm(Basee)not(markede) nm(SeriesgIg2)nmgI1nmg2 nm(ParallelgIg2)nmgI1nmg2 .nv(Basee (vI,v2, \n))ifvvIVvv2 then[e]else[] .nv(SeriesgIg2).nvgI++.nvg2 .nv(ParallelgIg2).nvgI++.nvg2 Byfusionalulation,weangetthefollowinge\u00c6ientre\u00adursivedefnitionforth. \nthv(Basee (vI,v2, ))ifvvIVvv2 thenmarkedeelseFalse thv(SeriesgIg2)thvgIVthvg2 thv(ParallelgIg2)thvgIVthvg2 \nNowthepropertydesriptionpstisrepresentedasmutu\u00admorphismswithpropertydesriptionsyle,span,nm,ths, andtht.Itfollowsfromouroptimizationtheoremthata \npratiallinear\u00adtimealgorithmanbeobtained.   7.3 Flexibility Hereweexplainfexibilityofourderivationinopingwith \nmodifationofthespeifationsofproblems.Wehooseas ourexamplethemaximumsegmentsumproblem,whih istoomputethemaximumofthesumsofallsegments \n(ontiguoussublist)ofalist.Thisisaquitewell\u00adknown problemintheprogramalulationommunity[9].Inthe followingwewillnotonlygiveanewsolutiontoitbutwill \nalsodemonstratethatweanstraightforwardlysolveaset ofrelatedproblemsthatwouldnotbeeasilysolvedbyusing \nthepreviouslyavailableapproahes. Themaximumsegmentsumproblemisatuallya maximum\u00adweightsumproblemwherethepropertyisthat \nallmarkedelementsinalistshouldbeadjaent(onneted). Thispropertyanbespeifedasfollows. onn[x]True onn(x:xs)ifmarkedxthen \nnmxsV (marked(hdxs)1onnxs) elseonnxs Ifthelistontainsonlyasingleelement,thenthepropertyis satisfed.Otherwise,iftheheadismarked,theneithernone \noftheotherelementsaremarkedorallmarkedelements areonnetedtothehead.Iftheheadisnotmarked,the remaininglistishekedreursively.Asbefore,thefuntion \nnmjudgeswhetherornotanyoftheelementsaremarked. nm[x]not(markedx) nm(x:xs)not(markedx)1nmxs Totransformonnintomutumorphismswhihonsistonly \nofpropertydesriptions,wegeneralizethepartmarked (hdxs)andletitbemhxs. mhxsmarked(hdxs) Byasimplefusionalulation,weaneasilygetthefollow\u00adingdefnitionofmh. \nmh[x]markedx mh(x:xs)markedx Sowehaveobtainedthefollowingmutumorphismswhih onsistonlyofpropertydesriptions. \nonn[x]True onn(x:xs)ifmarkedxthen nmxsV(mhxs1onnxs) elseonnxs Appliationoftheoptimizationtheoremgivesusalinear\u00adtimealgorithm.Althoughourlinearalgorithmmayusea \nfewmoreoperationsthanthatdesribedbyBird[9],itis muheasiertoderive. Nowonsideranextensionofthemaximumsegmentsum \nproblemwhereweareinterestedonlyinthosesegmentson\u00adtainingonlyevennumbers.Thepropertyforthisextended problemis \npxsonnxs1evensxs whereevensanbedefnedby evens[x]ifmarkedxtheneven(weightx) elseTrue evens(x:xs)ifmarkedxthen \neven(weightx)1evensxs elseevensxs Itiseasytoseethatpanbedefnedasmutumorphisms withpropertydesriptionsonn,evens,nm,andmh,and \nthusthatweobtainalinearalgorithmforsolvingthisex\u00adtendedproblem. Followingthisline,weanonsidermanysimilarsegment \nproblems.Wean,forexample,onsidermaximumsums pxsonnxs1even(mnumxs), wheremnumxsisthenumberofmarkedelementsinxs.To \ngetmutumorphismswhihonsistonlyofpropertydesrip\u00adtions,wegeneralizetheparteven(mnumxs)andletitbe emxs. \nemxseven(mnumxs) Afterderivingareursiveformforembyusingalulations similartothosedesribedabove,weanapplytheoptimiza\u00adtiontheoremtogetalinear\u00adtimealgorithm.Itshouldbe \nnotedthatderivingalinear\u00adtimealgorithmforthisproblem requiressomereativitywhenusingtheapproahdesribed \nin[9,18]beausethepropertypisnotprefx\u00adlosed.This makesflterpromotiondi\u00c6ult. Finally,wementionthatmaximumsegmentsumproblem \nanbegeneralizedtotrees:asegmentinalistissimply generalizedtoasetofonnetednodesinatree.Itshould beeasyforreadertoderivealinear\u00adtimealgorithmtosolve \nthisgeneralizedproblem.  8. RELATED WORK Sinethemid\u00ad1980stherehavebeenseveralpowerfulap\u00adproahesbydynamiprogramming,andmanyNP\u00adomplete \nproblemshavethusbeenreduedtolinear\u00adtimeproblemsfor familiesofreursivelyonstrutedgraphs.Thepioneering \nworkinthisfeldwasonseries\u00adparallelgraphs[23]. Thebakboneoneptisalassofgraphswithbounded tree-width[21],whihwasindependentlydevelopedaspartial \nk-tree[2]andisalsodisussedintermsofseparators[24] andliques[19].Thesetofgraphswithtree\u00adwidthatmost kisequaltothesetofk\u00adterminalgraphsonstrutedby \nalgebraiompositionrules[4].NP\u00adompleteproblemson graphs,suhastheHamiltonpathproblem,areoftenlinear inthesizeandbeyondexponentialinthetreewidthby \nthedivide-and-onquerstrategyaordingtothisalgebrai onstrution. Muhworkhasbeendone[10,3],butmostofitison \nindividualgraphproblems.Courelleshowedthatwhether a(hyper)graphwithboundedtreewidthsatisfesalosed monadiseondorder(MSOL,forshort)formula(ofgraphs) \nissolvableinlineartime[13].Borieetal.furthershowed thatthereognition,enumeration,andoptimizationprob\u00adlemsspeifedbyanextensionofMSOLformulaanbe \nsolvedinlineartime[11].ThisgraphvariantofMSOLuses In(v,e),whihmeansavertexvisaninidentofanedgee, insteadoftheuseofasuessorfuntioninordinaryMSOL \n[25]. Althoughappealingintheory,thesemethodsarehardly usefulinpratieduetoahugeonstantfatorforspae andtime.Thisarisesfromthemanipulationofhugetables: \n Theonstrutionoftablesrefetsthedeomposition ofthepropertydesriptionintoprimitiveones;previ\u00adousmethodsadaptfxedbasiprediatesasprimitives, \nwhereasourmethodfreelyadaptsnewprimitivesif theyareintheformofmutumorphisms.  Theironstrutionoftablesausestheexponential \nblow\u00adupateahourreneofquantifers.Ourmethod replaestheourrenesofquantiferswithreursions, whihareomputationallymoree\u00c6ient. \n Theomparisonofdesriptionpowerbetweenmutumor\u00adphismsandMSOLisnotstudiedyet,whihisafuturework. Birdalulatedalinear\u00adtimealgorithmforsolvingthe \nmaximumsegmentsumproblemonlists[9],whihisakind ofmaximum\u00adweightsumproblem.BirdanddeMoorstudied optimizationproblems,whihinludemaximum\u00adweightsum \nproblems,inamoregeneralwaythatusedrelationalulus [8].Forinstane,agreedylinearfuntionalprogramforthe partyplanningproblemanbederivedusingrelationalu\u00adlus.Usingrelationalulus,theydevelopedaverygeneral \nframeworktotreatoptimizationproblems.Itisalledthin\u00adningtheory,andthethinningtheoremplaystheentralrole. \nButwhenapplyingthethinningtheorem,onehastofndtwo preorderswhihmeetprerequisitesofthethinningtheorem, \nandthisissometimesdi\u00c6ultfornon\u00adexperts.Weinstead fousonausefullassofoptimizationproblems,maximum\u00adweightsumproblems,andproposeaverysimplewaytode\u00adrivee\u00c6ientlinearalgorithms.Whenthetargetproblemis \namaximum\u00adweightsumproblem,thetwopreordersforthe thinningtheoremanbederivedautomatiallybyapplying theoptimizationtheorem.Toapplyouroptimizationtheo\u00adrem,theonlythingonehastodoisdesribetheproperty \nintheformofmutumorphisms.Onesignifantreasonfor ahievingthissimpliityinderivationisthatwehavere\u00adognizedtheimportaneofthefnitenessoftherangeofa \natamorphismasintheoptimizationlemma,whihreeived littleattentionin[8]. 9. CONCLUSIONS Inthispaperwepresentanewmethodforderivingpra\u00adtiallinear\u00adtimealgorithmsformaximumweightsumprob\u00adlemsonreursivedatastrutures.Fromaspeifationrep\u00adresentedasafuntionalprogram,ourmethodobtainsprati\u00adallinear\u00adtimealgorithmsbyderivingaatamorphismwhose \nrangesizeissmall.Thoughourmethoddoesnotguarantee thatthederivedatamorphismhasarangewiththesmallest numberofelements,inmanyasesithasrangeonsisting \nofabout10or20elementsbeausethepropertiesofmany problemsanbedesribedinmutumorphismswhihon\u00adsistofthreeorfourpropertydesriptions.Thismeansour \nderivedlinear\u00adtimealgorithmsarepratialinmanyases. Ourmethodalsoenableslineartimealgorithmstobede\u00adrivedinasimple,systemati,andnaturalway,anditan \nfexiblyopewithmodifationofthespeifation. Thoughoururrentfousisonwell\u00adusedreursivedata struturessuhaslistsandtrees,ourmethodshouldbeable \ntodealwiththegraphswithboundedtreewidthbeausea lassofthegraphswithboundedtreewidthanberepre\u00adsentedasareursivedatastruturelikethatdesribedin \nSetion3.Ournexttargetproblemsarelinear\u00adtimeon\u00adtrolfowanalysesforstruturedproeduralprograms,for whihtheontrolfowgraphsareknowntohavebounded \ntreewidth[26].Thoughweurrentlyrestritdatatypesto polynomialdatatypes,wethinkouroptimizationtheorem anbeextendedtoregulardatatypes. \nOurmethodofoursehaslimitations,andthemostfunda\u00admentalisthattreewidthisbounded.Thetwo\u00addimensional maximumsegmentsumproblem,forexample,annotbe \ndealtwithbyourmethodbeauseatwo\u00addimensionalmatrix orrespondstoagridgraph,whihwillhaveunboundedtree width. \n10. ACKNOWLEDGMENTS Thispaperowesmuhtothethoughtfulandhelpfuldis\u00adussionommentsmadebyAkihikoTakano,HideyaIwasaki, \nandotherTokyoCACAmembers.ThankstoJeremyGib\u00adbonsforhisvaluableommentsonanearlierversionofthis paper,toOegedeMoorforprovidingusotherinterestingop\u00adtimizationproblems,andtoRihardBirdforkindlysending \nushisdraftaboutsolvingmaximum\u00adweightsumproblems usingthethinningtheorem.Thanksalsototheanonymous refereesforusefulommentsonanearlierversionofthis \npaper. 11. REFERENCES [1]A.ArnborgandA.Proskurowski.Lineartime algorithmsforNP\u00adhardproblemsongraphsembedded \nink\u00adtrees.TehnialReportTRITA\u00adNA\u00ad8404,Royal InstituteofTehnology,Sweden,1984. [2]S.Arnborg.Complexityoffndingembeddingsina \nk\u00adtree.SIAMJournalAlgebraiDisreteMathematis, 8:277.287,1987. [3]S.Arnborg.Deomposablestrutures,Boolean \nfuntion,representations,andoptimization.In J.WiedermannandP.H ajek,editors,Mathematial FoundationsotComputerSiene1999,pages21.36, \n1995.LetureNotesinComputerSiene,Vol.969, Springer\u00adVerlag. [4]S.Arnborg,B.Courelle,A.Proskurowski,and \nD.Seese.Analgebraitheoryofgraphredution. JournalottheAssoiationtorComputingMahinery, 40(5):1134.1164,1993. \n[5]B.Aspvall,A.Proskurowski,andJ.A.Telle.Memory requirementsfortableomputationsinpartialk\u00adtree algorithms.Algorithmia,27(3):382.394,2000. \npreviouslypresentedatSWAT'98. [6]M.W.Bern,E.L.Lawler,andA.L.Wong. Linear\u00adtimeomputationofoptimalsubgraphsof \ndeomposablegraphs.JournalotAlgorithms, 8:216.235,1987. [7]R.Bird.Anintrodutiontothetheoryoflists.In \nM.Broy,editor,LogiotProgrammingandCaluliot DisreteDesign,NATOASISeries36,pages5.42. Springer\u00adVerlag,1987. \n[8]R.BirdandO.deMoor.AlgebraotProgramming. PrentieHall,1996. [9]R.S.Bird.Algebraiidentitiesforprogram \nalulation.TheComputerJournal,32(2):122.126, 1989. [10]H.Bodlaender.Atouristguidethroughtreewidth. AtaCybernetia,11:11.21,1993. \n[11]R.B.Borie,R.G.Parker,andC.A.Tovey. Automatigenerationoflinear\u00adtimealgorithmsfrom prediatealulusdesriptionsofproblemson \nreursivelyonstrutedgraphfamilies.Algorithmia, 7:555.581,1992. [12]T.H.Cormen,C.E.Leiserson,andR.L.Rivest. \nIntrodutiontoAlgorithms.TheMITEletrial EngineeringandComputerSieneSeries.MITPress, 1990. [13]B.Courelle.Graphrewriting:Analgebraiandlogi \napproah.InJ.vanLeeuwen,editor,Handbookot TheoretialComputerSiene,volumeB,hapter5, pages194.242.ElsevierSienePublishers,1990. \n[14]B.Courelle.Themonadiseond\u00adorderlogiof graphs.I.Reognizablesetsoffnitegraphs. IntormationandComputation,85(1):12.75,Mar. \n1990. [15]M.Fokkinga.Tuplingandmutumorphisms. Squiggolist,1(4),1989. [16]M.Fokkinga.LawandOrderinAlgorithmis.PhD \nthesis,UniversityofTwente,DeptINF,Enshede, TheNetherlands,1992. [17]Z.Hu,H.Iwasaki,M.Takeihi,andA.Takano. \nTuplingalulationeliminatesmultipledata traversals.InProeedingsotthe1997ACMSIGPLAN InternationalContereneonFuntionalProgramming, \npages164.175,Amsterdam,TheNetherlands,9.11 June1997. [18]J.Jeuring.TheoriestorAlgorithmCalulation.Ph.D \nthesis,FaultyofSiene,UtrehtUniversity,1993. [19]I.Kzr z andR.Thomas.Clique\u00adsums, tree\u00addeompositionsandompatness.Disrete \nMathematis,81:177.185,1990. [20]E.Meijer,M.Fokkinga,andR.Paterson.Funtional programmingwithbananas,lenses,envelopesand \nbarbedwire.InPro.ContereneonFuntional ProgrammingLanguagesandComputerArhiteture (LNCS923),pages124.144,Cambridge, \nMassahusetts,Aug.1991. [21]N.RobertsonandP.D.Seymour.Graphminors.II. Algorithmiaspetsoftree\u00adwidth.Journalot \nAlgorithms,7(3):309.322,Sept.1986. [22]T.SheardandL.Fegaras.Afoldforallseasons.In ContereneonFuntionalProgrammingLanguages \nandComputerArhiteture,pages233.242,1993. [23]K.Takamizawa,T.Nishizeki,andN.Saito. Linear\u00adtimeomputabilityofombinatorialproblems \nonseries\u00adparallelgraphs.JournalottheAssoiation torComputingMahinery,29:623.641,1982. [24]R.Thomas.AMenger\u00adlikepropertyoftree\u00adwidth: \nThefnitease.JournalotCombinatorialTheory, SeriesB,48:67.76,1990. [25]W.Thomas.Automataoninfniteobjets.InJ.van \nLeeuwen,editor,HandbookotTheoretialComputer Siene,volumeB,hapter4,pages133.192.Elsevier SienePublishers,1990. \n[26]M.Thorup.Allstruturedprogramshavesmalltree widthandgoodregisteralloation.Intormationand Computation,142:159.181,1998. \n[27]T.V.Wimer.LinearAlgorithmsonk-terminal Graphs.PhDthesis,ClemsonUniversity,1987.Report No.URI\u00ad030. \n  \n\t\t\t", "proc_id": "351240", "abstract": "In this paper we propose a new method for deriving a practical linear-time algorithm from the specification of a maximum-weightsum problem: From the elements of a data structure <i>x</i>, find a subset which satisfies a certain property <i>p</i> and whose weightsum is maximum. Previously proposed methods for automatically generating linear-time algorithms are theoretically appealing, but the algorithms generated are hardly useful in practice due to a huge constant factor for space and time. The key points of our approach are to express the property <i>p</i> by a <i>recursive</i> boolean function over the structure <i>x</i> rather than a usual logical predicate and to apply program transformation techniques to reduce the constant factor. We present an <i>optimization theorem</i>, give a calculational strategy for applying the theorem, and demonstrate the effectiveness of our approach through several nontrivial examples which would be difficult to deal with when using the methods previously available.", "authors": [{"name": "Isao Sasano", "author_profile_id": "81100091875", "affiliation": "Department of Information Engineering, University of Tokyo", "person_id": "PP31026818", "email_address": "", "orcid_id": ""}, {"name": "Zhenjiang Hu", "author_profile_id": "81100253989", "affiliation": "Department of Information Engineering, University of Tokyo", "person_id": "PP15027466", "email_address": "", "orcid_id": ""}, {"name": "Masato Takeichi", "author_profile_id": "81100466948", "affiliation": "Department of Information Engineering, University of Tokyo", "person_id": "PP15032927", "email_address": "", "orcid_id": ""}, {"name": "Mizuhito Ogawa", "author_profile_id": "81100412378", "affiliation": "NTT Communication Science Laboratories", "person_id": "PP31089105", "email_address": "", "orcid_id": ""}], "doi_number": "10.1145/351240.351254", "year": "2000", "article_id": "351254", "conference": "ICFP", "title": "Make it practical: a generic linear-time algorithm for solving maximum-weightsum problems", "url": "http://dl.acm.org/citation.cfm?id=351254"}