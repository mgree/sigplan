{"article_publication_date": "09-01-2000", "fulltext": "\n Information Flow Inference For Free Fran\u00e7ois Pottier Sylvain Conchon INRIA, BP 105, 78153 Le Chesnay \nCedex, INRIA, BP 105, 78153 Le Chesnay Cedex, France France Francois.Pottier@inria.fr Sylvain.Conchon@inria.fr \nABSTRACT Thispapershowshowtosystematiallyextendanarbitrary typesystemwithdependenyinformation,andhowsound\u00adnessandnon-interfereneproofsforthenewsystemmay \nrelyupon,ratherthandupliate,thesoundnessproofofthe originalsystem.Thisallowsenrihingvirtuallyanyofthe \ntypesystemsknowntodaywithinformationfowanalysis, whilerequiringonlyaminimalproofefort. Ourapproahisbasedonanuntypedoperationalseman\u00adtisforalabelledalulusakintooreML.Thus,itissim\u00adple,andshouldbeappliabletootheromputingparadigms, \nsuhasobjetorproessaluli. Thepaperalsodisussesaessontrol,andshowsitmay beviewedasentirelyindependentofinformationfowon\u00adtrol.Lettingthetwomehanismsoexist,withoutinter\u00adating,yieldsasimpleandexpressivetypesystem,whih \nallows,inpartiular,\"seletive\"delassifation. 1. INTRODUCTION Today,onsiderableamountsofmilitary,ommerial,or \npersonaldataareproessedandstoredinomputersystems. Thus,valuabledatamustbeprotetedagainstdeliberate oraidentalreleaseororruption,whihmaybeaused \nnotonlybyindividuals,butalsobyyrograms.Aesson\u00adtrolmehanismsprovidesomeprotetion,butrequirethe programstowhihaessisgrantedtobeunonditionally \ntrusted.Allowinginspetionorupdateofthedatabyun\u00adtrustedprogramsrequiresanalyzingtheirode,toensure thatitmeetssomeseuritypoliy.Thisproessisalled \ninformationfowanalysis. Theneedforsuhaformofprotetionwasidentifedvery early[13].Followingmilitarypratie,severalauthorssug\u00adgestedassigningaseurityleveltoeveryprogramvariable, \nandrequiringthatinformationbeallowedtofowonlyfrom lowerlevelvariablestohigherones.Thetehniquespro\u00adposedtoenforethisrestritioninvolvedseurityheksat \nrun-time[ ],atompile-time[7],oraspartofamanualproof proess[4].Seuritylevelsoferasimplewayofguarantee- \nPermission to make digital or hard copies of all or part of this work for personal or classroom use is \ngranted without fee provided that copies are not made or distributed for pro.t or commercial advantage \nand that copies bear this notice and the full citation on the .rst page. To copy otherwise, to republish, \nto post on servers or to redistribute to lists, requires prior speci.c permission and/or a fee. ICFP \n00, Montr\u00e9al, Canada. Copyright 2000 ACM 1-58113-202-6/00/0009 ..$5.00 ingnon\u00adinterferene apropertywhihallowsdesribing \nmanyseuritypoliies,inluding(ombinationsof)serey andintegrityrequirements[11]. Non-interferenestatestheabseneofdependenybe\u00adtween(partof)aprogram'sinputsand(partof)itsoutputs. \nThus,informationfowanalysisisnothingbutadeyendeny analysis.ThisfatwaspointedoutbyAbadietal.[1],who desribedageneral-purposedependenyanalysisintermsof \natyyesystemforanextendedA-alulus. Inoureyes,expressingdependenypropertiesintermsof tyyesisahighlyommendableapproah.Indeed,ithasno \nrun-timeost,andofersaorretnessguaranteepriorto programexeution.Typesareusuallysimple,preditable, andmayserveasaspeifationlanguage.Lastly,thisal\u00adlowsautomatingtheonstrutionoforretnessproofs,pro\u00ad \n1 videdtypeinfereneisavailable.Infat,laterversions ofDenning'sompile-timeertifationsystem[ ]beara strongresemblanewithtoday'spolymorphi,onstraint\u00adbasedtypesystems.Yet,tothebestofourknowledge,the \nfrsttype-basedinformationfowanalysisisduetoPals\u00adbergand0rb k,whodevelopedatypedA-aluluswithin\u00adtegrityannotations[1 \n,17].Thisworkwas,unfortunately, notsupportedbyanon-interfereneproof.Itwasfollowed byseveralothers,onernedwithpreservingsereyina \nfrst-orderimperativelanguage[27],ahigher-orderfun\u00adtionallanguage[12,1],orinJava[14]. Althoughtheseworksoferawidevarietyoftehniques \nandideas,noneofthemprovidespolymorphismandtypein\u00adferene featuresroutinelyfoundinmoderntypedprogram\u00adminglanguages \ntogetherwithanon-interfereneproof.For instane,Myers[14]ofersaverypowerfulsystem,butisun\u00adabletoproveitsorretness,duetothesheernumberofits \nfeatures.Heintze,Rieke,AbadiandBanerjee[12,1]only proposesimply-typedA-aluli.Onemayonjeturethat theirnon-interfereneproofs,basedonlogialrelationsand \n(inthelaterpaper)onaategorialsemantisofA-alulus, annoteasilydealwithreursiveorpolymorphitypes.Vol\u00adpanoandSmith'stypeinferenealgorithm[27]infersprin\u00adipaltypeshemes,butdoesnotusethemtoitsownadvan\u00adtage.Rather,ittextuallyexpands\"let\"defnitions,whih \ntakesexponentialtime.Thereasonforthisweaknessmay betheefortinvolvedindupliatingaorretnessprooffor atrulypolymorphi,onstraint-basedtypesystem. \nThispaperdesribesasystematiwayofextendingan existingtypesystemwithinformationfowontrol.Given anarbitrarytypesystemfororeML,webuildarelated \nlTheseare,ofourse,onlywell-knownadvantagesofstrong typing. system,whosetypesarryseurityannotations,andwhose \norretness,inludingnon-interferene,restsupontheorigi\u00adnal's.Thus,weavoidproofdupliation,andobtainaformal \nnon-interfereneresultataverysmallost. Varyingtheoriginalsystemyieldsawholefamilyofprov\u00adablyorret,informationfow-awaretypesystems,showing \nthatinformationfowanalysismaybereadilyombinedwith reursivetypes,polymorphism,typeinferene,orotherad\u00advanedtype-theoretifeatures.Ourproofsrelyonanun\u00adtypedoperationalsemantis.Thisapproahhasseveral \nadvantages.Itrequiresnodomain-orategory-theoreti knowledge.Itdoesnotmakeanyassumptionsaboutthe formoftypes,allowinganytypesystemtobeusedasa \nstartingpoint.Furthermore,itshouldbeappliabletoother languages,suhasA-aluliwithsideefets,objetaluli, \norproessaluli,whihalreadyenjoyrihtypesystems (e.g.[9]),yetmaynothaveadenotationalsemantis. Weonludewithaomparisonofinformationfowon\u00adtrolandaessontrol,andarguethatthesemehanisms \nmayusefullyoexist,whileremainingentirelyindeyendent atatheoretiallevel.Onthewhole,webelievethispaper \ngivesrisetothemostpowerfultypesystemsequippedwith statiinformationfowandaessontroltodate,withmin\u00adimaltheoretialoverhead.Wehopeitwillserveasauseful \npratialguideforprogramminglanguageimplementors. 2. OVERVIEW Itseemsintuitivelyobviousthatthesimplestwayofdy\u00adnamiallytrakinginformationfowthroughoutaomputa\u00adtionistomarkitsinputswithlabels,andtorequireevery \noperationtooyythelabelsarriedbyitsargumentstoits result.Providedlabelsareproperlyopied,noneanbe droppedalongtheway;so,thefnalresultmustarrythe \nlabelsofallinputswhihhaveefetivelybeenused.Re\u00adversingthisstatement,weseethatthefnalresultannot deyendonanyinputwhoselabelitdoesnotarry.This \nrouteistakenbyAbadi,LampsonandLevy[2],whode\u00advelopalabelledA-alulusinordertodynamiallyanalyze dependenies.ItexhibitstwodifereneswithordinaryA\u00adalulus.First,expressionsmayarryalabel;seond,anew \nredutionruleopieslabels,foringtheresultofeveryfun\u00adtionappliationtoretainthelabelattahedtothefuntion. \nWereviewthisalulusinsetion3,andprovethat\"labels annotbedropped\"bystatingastabilitytheorem. Abadi,LampsonandLevy'slabelledA-alulus,extended \nwitha\"let\"onstrut,isourstartingpoint.However,we wishtoanalyzedependeniesstatially,ratherthandynam\u00adially;infat,weplantodosobybuildingatyyesystemfor \nthelabelledalulus.Tothisend,itseemsnaturaltopik someexistingtypesystemfororeML,andenrihitwith informationaboutlabels.However,ifwemodifyanexist\u00adingsystem,thenwemustalsomodifyitsorretnessproof \nwhihessentiallymeansduyliatingit.(Thisapproahis followedinallpaperstodate.)Instead,wewishtobuild onthesystem'sorretnesstheorem,regardlessofitsyroof. \nThus,weannotafordtomodifytheexistingsystem;in\u00adstead,wemustuseitasabuildingblokablakboxin thedefnitionofthenewsystem. \nHowever,neitherlabelledexpressions,northeextrare\u00addutionruleareknowntoatypesystemfororeML.How to\"explain\"thesefeaturestoit?Ouransweristodevise \natranslationsheme.Usingit,weturnaprogramwritten inthelabelledalulusintoaoreMLprogram,whihwe anthensubmittoatraditionaltypesystem.Beauseour \ntranslationshemeisomputationallymeaningful,thetype thusproduedmakessense:itdesribesthebehaviorofthe originalprogramwithrespettodataandtolabels. \nTheenodingisextremelysimple.Itmapseverysoure expressiontoapair,whosefrstomponentrepresentsthe expression'somputationalontent,andwhoseseondom\u00adponentontains(anapproximationof)itslabel.Ofourse, \nthetargetalulusmusthavepairs,aswellasafamilyof onstantswhihrepresentlabels.Wedefnesuhaalulus insetion4.Wethendesribethetranslationsheme,and \ngiveafundamentalsimulationlemma,insetion5. Insetion,weassumegivenatypesystemforthetarget alulus.Wedefneasmallnumberofrequirementsabout \nit,mostnotablyasyntatitypesoundnesstheorem.Then, weimposethistypesystemonthesourealulus,through ourtranslation.Weshowthatthesystemthusobtainedis \nalsosound,andenjoysanon-interfereneproperty. Insetion7,wenotethatourtranslationshemeisabit naive,andmayauseanexponentialinreaseinthesizeof \nprograms.Toremedythis,wedefneavariantofit,whih onlyhaslinearoverhead,andshowthatitisequivalent,as farastypingisonerned. \nInsetion,weillustrateourtheoretialonstrutionwith aonreteexample.Wepikanexistingtypeinferenesys\u00adtemfororeML[20],showthatitmeetsourrequirements, \nandgiveaonretedesriptionoftheorrespondinginfor\u00admationfow-awaresystem.Weillustrateitspowerbyrun\u00adningitonasmall,buttypial,program. \nSetion9disussesaessontrol,andarguesthatitisin\u00addependentofinformationfowontrol.Thetwomehanisms mayofourseoexist;weshowthatthisallowsseletivede\u00adlassifationalaMyersandLiskov[15]. \nSetion10disussesourontributionandonludes. 3. SOURCE CALCULUS OursourealulusisexatlyAbadi,LampsonandLevy's \nlabelledA-alulus[2],extendedwitha\"let\"onstrutinthe styleofML. e::= soureterms kintegeronstant(kEN) x \nvariable(xEV) Ax.e abstration(xEV) (ee) appliation letx=eineloaldefnition(xEV) l:e labelledterm(lE\u00a3) \nThesetVofprogramvariablesisassumedtobedenumer\u00adable.Noassumptionsaremade,atthispoint,abouttheset oflabels\u00a3. \nTheoperationalsemantisforthealulusfollows.Rules (J),(let)and(ontext)arestandard.Inrule(ontext),C rangesoverarbitraryontexts:wedonotyethooseapar\u00adtiularevaluationstrategy.Rule(lift)allowsmovinglabels \noutwardsaslittleaspossibletopermitJ-redution.Inother words,(lift)movesthelabelofafuntiontoitsresult,so \nastoreordthefatthatithasbeenusedinproduingit, and,onsequently,thattheresultdeyendsonit. (Ax.el)e2-el[e2/x](J) \nletx=eline2-e2[el/x](let) (l:el)e2-l:(ele2)(lift) C[el]-C[e2]ifel-e2(ontext) Fromapratialpointofview,labelsmaybeinsertedinto \ntheodeasawayofsupplyingseurityinformation.Spe\u00adiflabelsmaybeused,forinstane,toindiatethatthe resultofertainexpressionsmustbekeptseret(e.g.ifit \nisdeemedtoontainonfdentialinformation),ormustnot betrusted(e.g.ifitwasreadfromapubliinputhannel). Notie,however,thatnofxedmeaningisbuiltintolabels. \nLabelsmerelytrakdependenies;their\"meaning\"onlyex\u00ad istsintheuser'smind.Afterwedefneatypesystemfor thisalulus,theuserwillbeabletoaddstatitypingasser\u00adtions,toprograms,therebydefningaseurityyoliy,and \ngiving\"meaning\"tolabels.Beausethepoliyisstatially enfored,thesemantisdoesnothave\"seurityviolations\". \nExampleToillustrateeverysteptakenthroughoutthepa\u00adper,wewilluseaverysimplerunningexample.Assuming LandHarelabels,lete=(L:(AxY.Y))(H:27).Then, \ne-L:((AxY.Y)(H:27))by(lift) -L:(AY.Y) by(J) Rule(lift)movesthelabelLuponenode.Thisexposesthe J-redex,allowingthefuntionAxY.Ytoreeiveitsargument. \nAtthesametime,thisguaranteesthattheappliation'sre\u00adsultistaggedL,thusreordingitsdependenyonthesub\u00adtermL:(AxY.Y).Notiehowthesub-termH:27,whihis \nunused,isdroppedduringJ-redution,labelinluded. 3.1 A stability theorem Thankstothepreseneofexpliitlabels,thisalulus \nenjoysasimple,onstrutivestabilitytheorem.Givena omputationsequenee-*f,itguaranteesthatfdoesnot dependonanysub-termofewhiharriesalabelnotfound \ninf.Morepreisely,itstatesthattheyrefxofeobtained by\"pruning\"allsuhsub-termsisstillabletoproduef,in spiteofthemissinginformation. \nWebeginwithsomestandarddefnitions.Ayrefxisan expressionwhihmayhavemissingsub-expressions: e::=prefxes \nhole ... ' Aprefxeisaprefxofanotherprefx(orexpression)eife '' mathese,exeptemayhavemoreholes;wewritee:e. \nForthepurposesofredution,wetreatlikeafreevariable. Prefxesenjoythefollowingmonotoniityproperty: '' Lemma3.1Lete,ebeyrefxessuhthate:e.Iffis \n' anexyressionsuhthate-*f,thene-*f. GivenanarbitrarysetoflabelsL.\u00a3,wedefnethe funtionL\u00b7L,whihmapsanyprefxetoaprefxofitself: \nLl:eL= whenl EL Ll:eL=l:LeLwhenlEL LL= LkL=k LxL=x LAx.eL=Ax.LeL Lele2L=(LelLLe2L) Lletx=eline2L=letx=LelLinLe2L \nInformallyspeaking,L\u00b7Lremoveseverysub-termwhihar\u00adriesalabelnotfoundinL. Wearenowreadytostatethestabilitytheorem.Wesup\u00adplyitsproof,notbeauseofitsinterest,butratherbeause \nwewishtoinsistonitssimpliity.Itbeginswiththefollow\u00adingauxiliarylemma. Lemma3.2Ife-fmaybederivedbyayylying(J)or \n(let),orby(lift)\u00adingalabellEL,thenLeL-LfL. Proof.Case(J).Then,e=((Ax.el)e2)-el[e2/x]= f.So,LeL=((Ax.LelL)Le2L)-LelL[Le2L/x]= \nLel[e2/x]L=LfL.Case(let)issimilar. Case(lift).Then,e=((l:el)e2)-l:(ele2)=f. BeauselEL,LeLis((l:LelL)Le2L.By(lift),this \nreduestol:(LelLLe2L)=LfL. . eorem3.1 a ili y)Assumeeisayrefxandfis anexyression.Ife-*fandLfL=f,thenLeL-*f. \nProof.Byindutionoverthelengthofthederivationof e-*f.Inthebasease,eequalsf,andtheresultisimme\u00addiate.Intheindutivease,weassumee-g-*f,where, \n* byindutionhypothesis,LgL-f.LetCbeaontext ''' suhthate=C[e],g=C[g'],ande-g',wheree-g' followsdiretlyfrom(J),(let)or(lift).DefneD=LCL. \n(ExtendL\u00b7Ltoontextsintheobviousway.)Now,either 'g' lemma3.2isappliabletoe-,oritisn't. 'g'' Ifitis,thenLeL-LLholds.So,LeL=LC[e]L= \n'* D[LeL]-D[Lg'L]=LC[g']L=LgL.Reallthat LgL-*f;theresultfollows. 'g' Ifitisn't,thene-isaninstaneofa(lift)rule \ng'g'' involvingalabell EL.So,isoftheforml:.Sine g'' g=C[l:]andl EL,LgLequalsD[].Thus,itisaprefx ''*f \nofD[LeL]=LC[e]L=LeL.ReallthatLgL-;by lemma3.1,thisentailsLeL-*f. . ExampleTheprograme=(L:(AxY.Y))(H:27)produes \ntheresultL:(AY.Y)=f.Theonlylabelthatappearsin fisL,soLf{.}=f.Aordingtotheorem3.1,theprefx Le{.}mustreduetofaswell.Indeed,wefnd \nLe{.}=(L:(AxY.Y)) -L:((AxY.Y))by(lift) -L:(AY.Y) by(J) Bylemma3.1,anyexpressionwhihhasLe{.}asaprefx mustreduetofaswell.Forinstane,(L:(AxY.Y))(H: \n) does.Usinglabels,wehavedeterminedthatthesub-term 27doesnotontributetotheomputatione-*f.  4. TARGET \nCALCULUS Asexplainedinsetion2,wenowwishtotranslateour sourealulusintoamoreonventional,unlabelledalu\u00adlus,soastobeabletousesomeof-the-shelftypesystem. \nAsourtargetalulus,wehooseoreML,extendedwith pairsandlabelonstants. e::= targetterms kintegeronstant(kEN) \nx variable(xEV) Ax.e abstration(xEV) (ee) appliation letx=eineloaldefnition(xEV) (e,e) pair fstfrstpairprojetion \nsndseondpairprojetion l labelonstant(lE\u00a3) labeljoin 0ed = (0edl ,0ed2) 0kdl = k 0xdl = fstx 0Ax.e dl \n= Ax.0ed 0ele2dl = fst(0eldl0e2d) 0letx=elin e2dl = letx=0eldin0e2dl 0l:edl = 0edl 0kd2 = c 0xd2 = sndx \n0Ax.e d2 = c 0ele2d2 = 0eld2 sn d(0eldl0e2d) 0letx=elin e2d2 = letx=0eldin0e2d2 0l:ed2 = l 0ed2 Figure1:ranslaion \nForlarity,doubleappliationsof willbewrittenusing infxnotation. Atthispoint,weassumethesetoflabels\u00a3isanup\u00adpersemi-lattie,whoseleastelement,orderingrelation,and \nleastupperboundoperationaredenotedc,.andY,respe-tively.ForlE\u00a3,tldenotesthelowerone{mE\u00a3;m.l}. Thealulusisequippedwithastandardoperationalse\u00admantis,augmentedwithanewrule,(join),whihstates \nthat returnstheleastupperboundofitsarguments. (Ax.el)e2-el[e2/x](J) letx=eline2 -e2[el/x](let) fst(el,e2)-el \n(7l) snd(el,e2)-e2 (72) l m-lYm (join) C[el]-C[e2]ifel-e2(ontext) Inrule(ontext),Cagainrangesoverarbitraryontexts. \nInthesourealulus,anexpressionmayarryzero,one ormorelabels.However,ourtranslationsheme(tobepre\u00adsentedinsetion5)assoiatesexatlyonelabelwithevery \nexpression.Theleastlabelcwillalsobeusedtorepresent theabseneofanylabel;thejoinoperation, ,willbeused \ntoomputeaonservativeapproximationoftwolabels.In otherwords,thesoureexpressionseandc:ewillbetrans\u00adlatedtoequivalenttargetexpressions;sowilll:m:eand \n(lYm):e.Thislakofpreisionwillnotbeaproblem. Infat,evenifthetranslationitselfwasnotapproximate, thesubsequenttypingstagewouldertainlybe:thereisno \npoint,inpratie,inkeepingtrakoflistsoflabels. Lastly,toallowformalreasoningaboutthefatthat standsforanassoiativeoperation,withneutralelementc, \nwedefneanextendedsemantis,denoted- ,byadding twoextrarulestothoseabove: (el e2) e3- el (e2 e3)(asso) \nc e- e (neutral) Inpartiular,- ontains-. 5. TRANSLATION Atranslationfromthesourealulustothetargetal\u00adulusisdefnedinfgure1.Thetranslationfuntionmaps \neverysoureexpressionetoapair0ed,whosefrst(resp. seond)omponentisdenoted0edl(resp.0ed2).Thefun\u00adtions0\u00b7d,0\u00b7dland0\u00b7d2 \naredefnedusingmutualindution. Asoureexpressioneismappedtoapair,whosefrst omponentrepresentse's\"atualvalue\"(i.e.itsomputa\u00adtionalontent),andwhoseseondomponentrepresentse's \nlabel.Forinstane,theunlabeledintegerkistranslatedto (k,c)weusetheleastlabelctodenotetheabseneofa label.A-abstrationsarehandledsimilarly.Avariablexis \ntranslatedto(fstx,sndx).Althoughitwouldbepossible totranslateitasx,thisismorehomogeneous. Thetranslationofanappliationexpression(ele2)makes \nthe(lift)-ingproessexpliit.Aordingtoouronvention, 0eldisapairofafuntionandalabel.Weextratthe former,namely0eldl \n,andapplyittoitsargumentasa whole,namely0e2d.Thisreturnsagainapair,whose frstomponenttheomputationalontentwethenkeep \nunhanged,andwhoseseondomponentthelabelwe joinwithel'slabel,namely0eld2 .Thus,thelabelattahed, inthetranslation,with(ele2),inludes(i.e.isgreaterthan, \naordingto.)theoneattahedwithel.Joininglabels allowskeepingtrakofasinglelabelperexpression,rather thanalistthereof.Thisissimpler,whilestillpreiseenough \nforourpurposes. Beausetheexpression0eldl0e2dappearsin0ele2dl andin0ele2d2 ,thesizeof0edisexponentialinthesize \nofe.Fromapurelytheoretialpointofview,thisisnota problem.Wefavorthisformulationforitssimpliity:thanks \ntoit,statingandprovingasimulationlemmaisveryeasy. Inpratie,however,efienydemandsalinearenoding. Wewilldefneone,andprovethatitisequivalenttothis \none,asfarastypingisonerned,insetion7.Thereader maywishtoimmediatelyhavealookatitsdefnition,given infgure2. \nExpressionsoftheformletx=eline2andl:earetrans\u00adlatedinastraightforwardway(again,induingexponential behavior).Notiehow0l:edhasthesameomputational \nontentas0ed,buthasagreaterlabel,duetothejoinop\u00aderationl \u00b7. Itisamatterofpureroutinetohekthefollowinglemma, \nwhoseproofwethereforeomit. Lemma5.1 imula ion)Ife-f,then0ed- *0fd. ExampleThetranslationofH:27is(27,H \nc).The translationofL:(AxY.Y)is(Ax.(AY.(fstY,sndY),c),L c). Thus,theterme=(L:(AxY.Y))(H:27)istranslatedto \n(fsta,(L c) snda),whereastandsfor (Ax.(AY.(fstY,sndY),c))(27,H c) Through(J),(7l),(72),(asso)and(neutral),0edredues \nto(AY.(fstY,sndY),L c),whihisexatly0L:(AY.Y)d= 0fd,inaordanewithlemma5.1. 6. TYPING 6.1 Fixing a strategy \nSofar,wehavenotommittedtoapartiularevaluation strategyinthesoureortargetlanguage.Wemustnow doso,mainlybeauseitseemsweannototherwisestatea \nmeaningfulyrogresstheoremoneofthetwofundamental typesoundnesstheorems[2].Letussettleonall-by-name evaluation;wewilldisussall-by-valuewhenappropriate. \nInthesourelanguage,let-.. betheredutionrela\u00adtionobtainedbyrestritingrule(ontext)tothefollowing subsetofontexts.Furthermore,defnevalues,asubsetof \nexpressions,asfollows. C::=[](Ce)l:C v::=kAx.el:v Weproeedsimilarlywiththetargetlanguage: C::=[](Ce)fstCsndC( \nC)( lC) v::=kAx.e(e,e)l ( l) Itisinterestingtonotiethattheseondfundamental typesoundnesstheorem,namelysubjetredution,anbe \nstatedindependentlyoftheredutionstrategy:itsufesto requirethattypesbepreservedalongallredutionpaths. \nWewillinfatdosointhefollowing. 6.2 Assumptions Fromhereon,weassumethetargetalulusisequipped withatypesystem.Asexplainedinsetion2,weviewit \nasa\"blakbox\":thatis,wemakenoassumptionsaboutits defnition.Rather,wesimplyregarditasarelationbetween losedtargetexpressionsandtyyes,satisfyingasmallnum\u00adberofaxioms.Thisfreesusfromaringabouttypingrules, \nenvironments,onstraints,universalquantifation,orother subtletiesinvolvedinthesystem'sinnerworkings.Thus,we \nassumetyyingjudgementsareoftheforme:t,whereeisa losedtargetexpression,andtbelongstosome(unspeifed) setoftypesT. \nWenowpresentourassumptionsaboutthetypesystem, intheformofaxioms.Thefrstonestatesthatany (losed)sub-expressionofawell-typedexpressioniswell\u00adtyped.Thisaxiomissatisfedbyallsystemsdefnedinterms \nofstruturaltypingrules. Axiom1Composi ionaliy)Ifeisalosedexyression suhthatC[e]:t,thene:uholdsforsomeuET. \nOurnexttwoaxiomsonstituteasyntatitypesound\u00adnesshypothesis[2].Thesubjetredutionaxiomrefers to- ,whereas-.. \nwouldbeexpeted,sinewehave hosenaall-by-nameevaluationstrategy.Thisstrength\u00adensitintwoways.First,replaing-.. \nwith-requires typestobepreservedbyallredutions,ratherthanonlyby all-by-nameredutions.Manyommontypesystems,suh \nasHindley/Milner's,areunawareoftheevaluationstrat\u00adegy,andsatisfythisstrongeraxiom.Althoughworkingwith \ntheusual(weak)versionoftheaxiommaybepossible,this hoiesimplifesourproofs.Seond,replaing-with- requires(asso)and(neutral)topreservetypesaswell. \nAxiom2uj.red.)Ife:tande- f,thenf:t. Axiom3Progress)Ife:t,theneither:fe-f, .. oreisavalue. Thenextaxiomrequiresthateverylabell,whihisalready \navalidexyressioninthetargetalulus,bealsoavalidtyye (possiblymodulosomeimpliitembedding).Italsostates \nthat,ifmisavalidtypeforl,wherebothlandmarelabels, thenlmustbebelowminthesemi-lattie\u00a3. Clearly,onewayofimplementingtheserequirementsisto \ndefneasetoftypesTwhihsyntatiallyontains\u00a3,to makel:lavalidtypingjudgementforeverylE\u00a3,andto defneasubtyyingrelationshipwherebylisasubtypeofm \nifandonlyiflmholds.Weillustratethisapproahin setion.However,itisinterestingtonotethatthisaxiom doesnotdemandsubtyping.Asystemwithoutsubtyping, \nbutwithasufientdegreeofpolymorphism,mayalsobe used.Forinstane,if\u00a3happenstobethepower-setofa setP(whihrepresents,say,prinipals),thenlabelsmaybe \ntypedusingP-indexedrows[21].Asimilarideaunderlies ObjetiveML[22],atypedobjet-orientedlanguagewhih doesnotrelyonsubtyping. \nAxiom4Laels)Everylabelisatyye:\u00a3T.Ifl,mE \u00a3,thenl:mimylieslm. Ourlasttwoaxiomsonernintegersandpairs.Theyare \nfarlessimportantthanaxioms14:theirmainuseistohelp formulatethenon-interferenetheoreminanieway. Axiom5 \nnegers)ThereisatyyeintET.Avaluev satisfesv:intifandonlyifitisanintegeronstantkEN. Axiom Pairs)Thereisayartialfuntionx:T2 \n-T suhthat(e,f):txuimyliese:t1f:u.Conversely,ife andfarewell\u00adtyyed,then(e,f)iswell\u00adtyyed. Notethatintandxmaynotdiretlyorrespondtothetype \nsystem'sownintandxtypeonstrutors.Indeed,whatis knownasatyyeinthisaxiomatizationmaybeknowne.g. asatyyeshemeinthesystem'satualdefnition. \n 6.3 Typing the source calculus Wenowdefnethetypesystemofthesourealulusas theompositionofthetranslationdefnedinsetion5with \nthetypesystemofthetargetalulus.Thatis,forany losedsoureexpressione,e:tholdsifandonlyif0ed:t holds.Wenotiethatifthehosentypesystemenjoysthe \nexisteneofprinipaltypes,orofatypeinferenealgorithm, thensodoesthenewlydefnedsystem. Thisabstratdefnitionsufestoprovesoundnessand \nnon-interferenetheoremsaboutthederivedsystem.Of ourse,ifoneisgiventheruleswhihdefnethetargetsys\u00adtem,thenonemayombinethemwiththedefnitionof0\u00b7d, \nyieldingasetofderivedruleswhihallowdirettypehek\u00ading/infereneinthesourealulus.Wewillillustratethis insetion. \nThenewsystemenjoysthefollowingtwosoundnessre\u00adsults.Weomittheproofoftheorem.2,whihisstraight\u00adforward,butslightlyverbose. \neorem.1uj.red.)Ife:tande-f,thenf:t. Proof.Aordingtolemma5.1,e-fimplies0ed-* 0fd. Furthermore,bydefnitionofthetypesysteminthesoure \nalulus,ourhypothesise:tmaybereadas0ed:t,and ourgoalmaybereadas0fd:t.Theresultfollowsfromthe fatthat- \npreservestypes(axiom2).. eorem.2Progress)Ife:t,theneither:fe-.. f,oreisavalue. Next,weproveanon-interferenetheorem,whihstates \nthattypesinthenewsystemdoontainusefuldependeny information.Theinterestingaspetofourproofisthatitis writteninanentirelyoperationalstyle:itessentiallyrelies \nontwopropertiesofthelabelledalulus:stability(theo\u00adrem3.1)andsubjetredution(theorem .1). Forsimpliity,thetheoremonlyonernsintegerresults. \nAmoregeneralstatementwouldbepossible. eorem.3Non-inerferene)Ife:intxlande-* v,wherevisavalue,thenLe-l-* \nv. Proof.Aordingtotheorem .1,v:intxlholds.This mayberead0vd:intxl,whih,aordingtoaxiom, implies0v:int.So,aordingtoaxiom5,0vannot \ndldl beaA-abstration.Consideringvisavalue,vmustbeof theformll:l2:...:ln:k,forsomen?O. Thus,0vdis(k,l \n... ln c).Fromthefatthatthis expressionhastypeintxl,wemaydedue,throughaxiom, thatll ... ln chastypel.However,thisexpression \nmayberedued,byrepeatedappliationofrule(join),to l llY...Yln.Aordingtoaxioms2and4,itfollowsthat llY...Ylnl.Inotherwords,everyliisanelementoftl. \nSo,Lv-lequalsv,whih,aordingtotheorem3.1,implies Le-l-* v. . Thenon-interferenetheoremmaybebetterknownunder \nthefollowingsymmetriform: Corollary.4Assumee,f:intxlandLe-l=Lf-l. Then,eitherbotheandfdiverge,orbotheandfonverge \nandyroduethesamevalue. Proof.Assumeeonverges.Then,aordingtotheorem.3 andlemma3.1,fonvergestothesamevalue.Bysymme\u00adtry,theonversealsoholds:iffonverges,theneonverges \ntothesamevalue.Furthermore,bytheorems.1and.2, neitherenorfangowrong.Theresultfollows.. Here,toonvergemeanstobeabletoreahavaluealong \nsomeredutionpath.Todivergemeansnottoonverge andnottogowrong.Togowrongmeanstogetstukalong someredutionpath.Bynormalization2,thesearethesame \nnotions,regardlessofwhether-or-.. isbeingused. Corollary .4guaranteesnotonlythateandfproduethe samevalue,butalsothattheybehavesimilarlywithrespet \ntotermination.Thisisastrongnon-interferenestatement. Withaall-by-valuesemantis,onewouldobtainaslightly \nweakerresult,wherebyeandfwouldbeguaranteedtoyield thesamevalueonlyiftheyterminate.Indeed,ife-.. v andf-.. \nw,wherevandwarevalues,then,bynormal\u00adization,e-.. vande-.. w,whene,byorollary.4, v=w.Toobtainastrongnon-interfereneresultinaall\u00adby-valuesetting,onemaymodifythelabelledalulusa\u00adordingly[2,setion3.7],andrepeatouronstrution.This \nyields,however,asignifantlymorerestritivetypesystem. Thesenon-interfereneresultsarestatedinthesoure alulus,whihhasnon-standardsemantis.However,la\u00adbelsarenotfrst-lassentities,i.e.theyannotafetthe \nourseofomputations,asshownby[2,prop.3].Thus, ifalllabelsareremovedbeforeexeution,i.e.ifweevalu\u00adate\"stripped\"termswithinastandardA-alulus,thenthe \nnon-interfereneresultsstillhold. Lastly,itisimportanttoprovethat\"enough\"programs areaeptedbythenewsystem,whihmayotherwiseturn \nouttobedevoidofpratialinterest.Unfortunately,doing soatanabstratlevelrequiresmoreaxioms,whiharedif\u00adulttostateinanelegantway.Forthisreason,wewillonly \naddressthisissueintheonretesettingofsetion. 2Wehaven'tprovedanormalizationtheoremforthelabelled A-alulus,butthisanbedoneusingexistingtehniques. \n[kD=(k,c) [xD=(fstx,sndx) [Ax.eD=(Ax.[eD,c) [ele2D=letp(x,t)=[elDin letp(Y,u)=x[e2Din (Y,t u) [letx=eline2D=letx=[elDin[e2D \n[l:eD=letp(x,t)=[eDin (x,l t) Figure2:Linear ranslaion  7. A MORE EFFICIENT TRANSLATION Thetranslationshemepresentedinsetion5behaves \nnielywithrespettoredution:itenjoysaverysimplesim\u00adulationlemma.However,beauseitdupliatessub-expres\u00adsions,ithasexponentialomplexity.Inthissetion,we \npresentaslightlydiferenttranslationsheme,whihonly haslinearoverhead,beauseitusesloalvariabledefni\u00adtionstosharesub-expressionswhereneeded.Weouldhave \nhosentousethisoneinthefrstplae,butlosinglemma5.1 wouldhavemadeourproofssomewhatheavier. Thenewenoding'sdefnitionisshowninfgure2.The \nauxiliaryloalvariablesx,t,Y,umustbehosensoasto avoidvariableapture.Weuseletp(x,Y)=eline2to denote((Ap.((AxY.e2)(fstp)(sndp)))el)wherepdoesnot \nappearfreeine2.Itwouldalsobepossibletoimplement \"letp\"intermsof\"let\".Ourhoieemphasizesthefatthat nopolymorphismisrequired:thepointistoavoiddupliat\u00adingel,nottogeneralizeitstype. \nToestablisharelationshipbetween[and0\u00b7d,weneed \u00b7Dafewextraaxiomsonerningthetargettypesystem.Let ususee:0ttodenoteC[e]:t.Thisgivesusarudewayof \ndenotingthe\"type\"ofanon-losedexpression. Axiom If(fste,snde):0t,thene:0t. Axiom IfxandYayyearfreeexatlyoneinf,andif \nf[el/x,e2/Y]:0t,thenlety(x,Y)=(el,e2)inf:0t. Axiom letx=ein(fl,f2):0tholdsifandonlyif (letx=einfl,letx=einf2):0tdoes. \nUsingtheseextraaxioms,aswellasaxiom2,itiseasyto provethat0\u00b7dand\u00b7Dgiverisetothesamederived [type system: \neorem.1[eD:tifandonlyif0ed:t. Thus,iftypeheking(resp.typeinferene)hasomplexity O(nk),wherek?I,intheoriginalsystem,thenithasthe \nsameomplexityinthederivedsystem.\u00b7Dybe Indeed,[maomputedinlineartime,andthesizeofitsoutputremains withinaonstantfatorofthatofitsinput. \n 8. A CONCRETE CASE Inthissetion,weillustrateourapproahwithaonrete example.Wefrstpikanexistingtypesystemforthetar\u00adgetalulus,andshowthatitsatisfestheaxiomsgivenin \ntheprevioussetion.Ouronstrutionthusgivesrisetoa onreteinformationfow-awaretypesystemforthesoure ll ' \nt tTint int l l ' '' '' t t t t t t t t o ollooll '' '' t o-t l t o-t l t oxt l t oxt l Figure3:uypingongroundypes \nalulus,adiretdesriptionofwhihisgivenintheformof asetoftypeinferenerules.Lastly,toillustratethesystem's \npower,weexeriseitonasimpleprogramfragment. 8.1 Typing the target calculus OurtargetalulusissimplyoreMLwithpairs,extended \nwithlabelonstantsandtheprimitiveoperation .Inpra\u00adtie,almostanytypesystemfororeMLwilldo,provided itallowsgivinganappropriatetypeshemetoeverylE\u00a3 \nefresh rhx:(x:e)=e rhe:VC.A=t rhAx.e:VC.(A\\x)=A(x)-t ]h-l. rhel:VCl.Al=tlrhe2:VC2.A2=t2 . Xp(a): efreshC=ClUC2U{tl \nt2-e} rhele2:VC.(AlnA2)=e . . . . . rhel:alr[X ae2:a2 . rhletX=eline:a2 2 . r(X)apfreshrenaminfa=gorh \n. Figure4:ypeinferenerules andto .Thus,wehaveaverywiderangeofsystemsto hoosefrom,e.g.[10,24,2,22,3,1].Wepikasubtyping\u00adonstraint-basedtypesystem,previouslystudiedbythefrst \ntensionof toobjetsoftheformA=.)Giventwotype author.Bylakofspae,wemustdesribeitverysuintly. shemesa anda,wesaytheformerismoregeneralthan \nl2 Moredetailedaountsappearin[20,19]. thelatter,andwewritea 'a,ifandonlyif[alD2[a2D. l2 Figure4givesthetypeinferenerulesofthesystem. \nForsimpliity,wedistinguishidentifersboundbyA,de\u00ad notedx,Y,...fromthoseboundby\"let\",denotedX, ,... . Judgementsareoftheformrhe:a,wherer \nisanenvi\u00ad WeexpeteahA-identifertobeboundatmostonein ronment (i.e.alistofbindingsoftheform X : a),eisa \nagivenprogram.Furthermore,ineveryexpressionofthe formletX=eine,werequireXtoappearfreewithin l2 eOveromingtheserestritionsisofoursepossible,but \n2. requiresmoreumbersometypingrules. Thepresentationofthesystembeginswithadefnitionof groundtyyes.Theyaretheregulartreesdesribedbythe \ntargetexpression,andaisatypesheme.Asfarasnota\u00ad tionisonerned,(x:e)representsaontextontaininga singleentry.A\\xistheontextobtainedbyremovingx's \nbinding(ifany)fromA.WeshortenthenotationVC.A=t toVC.t,A=t,orsimplyt,ifA,C,orbothareempty. Forthesakeofreadability,weslightlyabusenotation. \nfollowingo\u00adindutivedefnition: WeletA t::= linttxtt-tT Groundtypesareequippedwithasubtyyingorder,givenin \nfgure3.Itis,again,defnedo-indutively:asubtyping assertionholdsifandonlyifithasafniteorinfnitederiva\u00adtion.Letusassume,fromhereon,that(\u00a3,)isalattie. \nThen,groundtypesalsoformalattie,withinwhih\u00a3is embedded. Wethen(indutively)defnetyyesandonstraints: t::=e,J,... \nlinttxtt-tT ::=t t Here,e,J,...rangeoveradenumerablesetoftyyevariables. Agroundsubstitutionqisamapfromtypevariablesto \ngroundtypes.qsatisfesaonstrainttl t2ifandonlyif q(tl) q(t2).qsatisfesaonstraintsetCifandonlyifit satisfeseahofitselements. \nAontextAisasetofbindingsoftheformx:t.Atyye shemeaisatripleofaonstraintset,aontextandatype, writtenVC.A=t.Intuitivelyspeaking,allvariableswhih \nappearinashouldbethoughtofasuniversallyquantifed, henetheVnotation.Moreformally,thedenotationofa typeshemeisdefnedby \n[VC.A=tD=t{q(A=t);qsatisfesC} wheretXrepresentstheupperoneofasetXwithrespet togroundsubtyping.(Thisrequiresastraightforwardex- \nA, (xAontainsabindingforx,andforTotherwise.Weuse AlnA2todenotethepoint-wiseintersetionofAland A2.Thatis,wheneverxhasabindinginAlorA2,its \nbindinginAnAisAl(x)nA2(x).Beausethesystem doesnothaveintersetiontypes,thisexpressionmustinfat beunderstoodasafreshtypevariable,aompaniedbyan \nappropriateonjuntionofsubtypingonstraints. Everytypeshemeisimpliitlyrequiredtohaveanon\u00ademptydenotation,i.e.asolvablesetofonstraints. \nTheserulesonlydesribeoreML.Typeinfereneforthe fulltargetlanguage,asdefnedinsetion4,isobtainedby addingthefollowing(pseudo-)bindingstotheinitialtyping \nenvironmentro: l2 k:int (kEN) fst:exT-e snd:Txe-e l:l (lE\u00a3) :V{e w}.e-e-e (\u00b7,\u00b7):e-J-exJ Here,wstandsforthegreatestelementofthelattie\u00a3. \nTheonstrainte wguaranteesthat isonlyappliedto expressionswhihdenotelabelonstants. 8.2 Back to the source \ncalculus Wearenowreadytoapplytheresultsofsetioninthe onretesettingonsideredhere. )standforthetypeassoiatedwithxinif \nn rh. k:int e,'fresh '' rh. x:(x:e)=erh. e:VC.A=t rh. Ax.e:VC.(A\\x)=(A(x)-t)n rh. el:VCl.Al=tlrh. e2:VC2.A2=t2 \ne,'fresh ')' C=ClUC2U{tl(t2-e,'w} rh. ele2:VC.(AlnA2)=e ' rhe:VC.A=t . ' ' e,'freshC=CU{te,l'w} ' rh.(l:e):VC \n' .A=e Figure5:Derivedypeinferenerules eorem.1Defnetypes,inthesenseofsetion6,tobe typeshemes,inthesenseofthissetion.Defnee:ato \nholdifandonlyif:a '' aroh. e:a ' .Then,axioms \u00ad ar e s a t i sf e d. Aproofofsubjetredut ion,intheaseofo \nreML, ap p e a r s in[20]. Extendingit to thelanguageonside r ed h e r e , as w ell ashekingtheotheraxioms,isstraightforward,although \nsomewhatlengthy.Weomitproofs. Composing[\u00b7Dwiththetypeinferenealgorithmofthe targetalulusyieldsatypeinferenealgorithmforthe \nsourealulus,enjoyingallofthepropertiesstatedinse\u00adtion.Letusnowgiveamorediretdesriptionofthis algorithm.Bysystematiallyomposingthedefnitionof \ntheenodingwiththerulesoffgure4,andperforminga fewonstraintsimplifationsteps,asallowedbytheuseof ' intheorem.1,weobtainasetofderivedtypeinferene \nrules,showninfgure5.Thelasttworules,whihdealwith \"let\"-boundvariablesand\"let\"defnitions,areunhanged,so \ntheyarenotshown.Theprodutnotationtxuhasbeenre- U plaedwitht,soastoinsistonthefatthatwearedealing withtypesarryingseurityannotations. \nTheserulesseemquiteintuitive.Theyresembletherules offgure4,withthefollowingdiferenes.Values(integer onstantsandA-abstrations)areannotatedwithcupon \nreation.Theseuritylevelofafuntionappliationex\u00adpressionisthejoinoftheresultlevelwiththefuntionlevel, thusreordingthefatthatthefuntionontributestothe \nomputation.Theseuritylevelofalabelledexpressionl:e isthejoinofe'slevelwithl.Ofourse,itwouldhavebeen easytoomeupwiththeserulesdiretly.However,our \napproahhasseveraladvantagesoveramanualapproah. First,itissystemati,leavingnodoubtthattheserulesare natural.Seond,weobtainorretnessproofs(almost)for \nfree,whihisnon-trivial,onsideringthesystemhaspoly\u00admorphism,subtyping,reursivetypes,andtypeinferene. Lastly,ourapproahisgeneralandmaybeappliedtomany \nothertypesystems. Asalastrefnement,itwouldbepossibletopartition types,ayosteriori,intothreesorts:plaintypest,labeltypes \nU u,andseuretypes,oftheformt.Thiswouldallowgetting ridoftheonstraint'winthelasttworules:'would thenrangeoverlabels,makingitredundant. \nComparingtypabilityinthederivedandintheoriginal systemisnoweasy.Letstripdenotethenaturalprojetion fromsouretotargetlanguage;inpartiular,strip(l:e)is \nstrip(e).Then, eorem.2 Conserva iviy)Thesoureexyressione iswell\u00adtyyedinthederivedsystemifandonlyifthetarget \nexyressionstriy(e)iswell\u00adtyyedintheoriginalsystem. Theproofreliesontwosimpleremarks.First,anysolution \noftheonstraintsgeneratedbytherulesoffgure5also satisfesthoseinferredbytherulesoffgure4.Conversely, anysolutionofthelattermaybeextendedtoasolutionof \ntheformer,whereeverylabelvariable'ismappedtow. Thisresultshowsthatonemayswithtothenewtypesys\u00adtem,andlabelanynumberofsub-expressionsinaprogram, \nwithoutafetingitstypability.Aprogrammaybeomeun\u00adtypableonlyifanon-trivialseuritypoliy,expressedby insertingtypingassertions,isadopted. \nExampleLetususetherulesoffgure5toinferthetype ofourrunningexample.ThetypeshemeinferredforH: 27learlyisint..TheoneinferredforL:(AxY.Y)is \n''n). (T-(e-e).Thus,theterme=(L:(AxY.Y))(H: ''). 27)reeivesthetypesheme(e-e. Thistypeshemestatesthatevaluatingedoesnotreveal \nanyinformationoflevelH.Thus,thetypeinferenealgo\u00adrithmstatiallyfndsthatedoesnotleakthevalue27,a fatwhihwehadpreviouslydynamiallyobtainedbyeval\u00aduatinge(seesetion3).Furthermore,thistypeshemeis \npolymorphiineandin',showingthate'sresultwhih isL:AY.Y,theidentityfuntionlabelledLisabletoaept anyargument,regardlessofitsontentandofitsseurity \nlevel. 8.3 A realistic example Weonludethissetionwithalongerexample.Weas\u00adsumethesourelanguageisextendedwithoperationson \nBooleans,strings,pairs,variantsandreords.Bylakof spae,wedonotdefnetypingrulesfortheseonstruts. Provablyorretrulesanbeobtainedin(atleast)twoways. \nOneistoexpliitlyextendthetargetlanguage,thetransla\u00adtionsheme,andourproofs.Theotheristoderiveorret typingrulesfortheseonstrutsbyonsideringtheirChurh \nenodingsintothebasilanguage. Figureshowsasmallexampleprogram.Itisafullpro\u00adgram,whihontainsnotypeinformation,butdoesontain \nafewseurityannotations,intheformoflabelledexpres\u00adsions. Theprogramfrstdefnesalassiprediateonlists,ex\u00adists,whihtellswhetheragivenprediateissatisfedbyat \nleastoneelementofagivenlist.Reursionisahievedviaan expliitfx-pointombinator,fx.Itiswell-typed,beause \nthesystemhasreursivetypes.Thus,weareabletowrite reursiveprograms,eventhoughourformaldevelopmentdid notexpliitlydealwithreursion. \nToimprovereadability,wewritetinsteadoftn(resp.tW) whentourspositively(resp.negatively)inatypesheme. Then,thetypeshemeomputedbythetypeinfereneal\u00adgorithmforexistsis \n, VC.(e'-bool,)-<-bool, letfxf= (funfx-f(ff)x)(funfx-f(ff)x) letexists=fx( funexistsyrediatelist\u00admathlistwith \nNil\u00adfalse Cons(element,rest)\u00adifyrediateelementthen t ue else existsyrediaterest ) letusers= Cons({login=\"Pam\";yw=Sys:\"7nuggets\"}, \nCons({login=\"Sam\";yw=Sys:\"\"}, Nil)) letquery = exists(funr\u00adr.login=Priv:\"Monia\" )users letquery2= exists(funr\u00adr.yw=\"\" \n)users Figure:Exampleprogram whereContainsasingleonstraint: ,' <[NilConsof(ex<),] Intuitively,thisreursiveonstraintrequires<torepresenta \nlist,whoseelementshavetypee ' ,andwhoseseuritylevel is7.exists'sfrstargument,aprediate,mustaordingly \naeptanargumentoftypee ' .Iftheprediatehaslevel 7,andifitreturnsaBooleanresultoflevel7,thensowill exists.Notiethat'are7areayrioriunrelated:theywill \nbeomerelatedonlyifexistsisappliedtoaprediatewhih leakssomeinformationaboutitsargument. Threeimportantpointsmustbemadehere.First,this \ntypeshemeispreise,andhighlypolymorphi.Thus,mul\u00adtipleappliationsofexists,e.g.tolistswithdistintseu\u00adritylevels,ortoprediateswithdiferentbehavior,willnot \n\"pollute\"eahother.Thisisarequirementwhenwritingli\u00adbraries,sineodedupliationwouldotherwisebeneessary. \nSeond,theodeofexistsontainsnoseurityannotations, anditstypewasinferredwithouthelpfromtheuser.This featureisalsoofutmostimportaneforbakwardomyati\u00adbility:itallowsalargebodyofode,writtenwithoutany \nseurityrequirementsinmind,tobere-usedinaprogram whereseuritymatters.Third,thistypeshemeisindepen\u00addentoftheunderlyingseuritylattie.Eventhoughitdoes \nnotmentionanyonstantlabellE\u00a3,itdoesenoderel\u00adevantdependenyinformation.Inotherwords,thehoie ofapartiularseuritylattieisirrelevantwhenanalyzing \ngeneriode;itisrequiredonlywhenwishingtoenforea partiularseuritypoliy. Letusomebaktotheprograminfgure.Itsnextstep \nistodefnealist,alledusers,whoseelementsarereords ontainingname(login)andpassword(yw)strings.Thein\u00adformationontainedinywfelds,whihisdeemedsomehow \nimportant,islabelledSys.Notiethatlabellingapieeof datadoesnotrestritaesstoit;itonlyforesanyompu\u00adtationswhihmakeuseofthisdatatoreeiveatypewhih \nrevealsthisdependeny.Inotherwords,ourtypesystem doesnotforbidanythingbydefault;itmerelywathesevery\u00adthing.Seurityrestritions,whenrequired,maybeadded \nusingadditionaltypeonstraints,aswewillseebelow. Therestoftheprogramonsistsoftwoqueriesaboutthe userslist,implementedusingexists.Thefrstqueryheks \nwhethersomeuserisalledMonia.Theprogrammer,per\u00adhapswishingnottodislosethefatthatheislookingfor thispartiularperson,hasmarkedthestring\"Monia\"with \nthelabelPriv.Theseondquerylooksforauserwithan emptypasswordstring. Aordingtothetypeinferenealgorithm,thetypeof \nPrt> query isbool.Thus,thequery'sresultrevealssome informationaboutthestring\"Monia\".Notie,however, thatitdoesnotarrythelabelSys:itdoesnotleakanything \naboutthepasswordsontainedinthelistusers.Thetype ofquery2,ontheotherhand,isbool,whihtellsthatit doesontaininformationaboutthepasswords. \nIftheseinformationhannelsaredeemedundesirable,they anbeeasilyeliminatedbyaddingtypingassertionstothe \nprogram.Forinstane,ifPubliisalabelsuhthatneither PrivPublinorSysPublihold,thenwriting Publt letquery \n:bool=... Publt letquery2:bool=... ausesbothdefnitionstobeomeill-typed,thusrevealing andforbiddingtheleaks.Thus,typingassertionsmaybe \nusedtoexpress,andstatiallyenfore,aseuritypoliy.  9. ACCESS CONTROL Informationfowanalysisofersawayofprovinganun\u00adtrustedprogramorretwithrespettoaseuritypoliy. \nHowever,itisarestritivedisipline,sineitdoesnotallow delassifation.Forinstane,afuntionwhihomparesa seretpasswordstringagainstagiveninputmustreturna \nseretresult,eventhoughitusuallyyieldsfarlessthanone bitofinformationaboutthepassword.Thus,someuseful \nprogramsannotbeprovedorret;forthisreason,trust,in theformofaessontrol,mustbere-introdued. 9.1 A calculus \nwith access control Letusbriefydesribeexpliitaessontrol.Assume givenafxedsetofyriniyalsP,equippedwithanarbitrary \nbinaryrelation..Theassertionp.qintuitivelymeans thatpatsforq,i.e.qtrustsp.Asaresult,qgrantsp theabilityofdiretlyaessinganyvaluetowhihqhas \naess.Assumethealulus'syntaxinludesthefollowing produtions: e::= terms lokp loking(pEP) unlokpunloking(pEP) \n... Assumeitssemantisinludesthefollowingredutionrule: unlokp(lokqe)-eifp.q Then,avaluelokedwithq'sauthoritybeomesunusable \nuntilitisunlokedbysomeprinipalpwhihatsforq.Any attempttounlokavaluebyanunauthorizedprinipalre\u00adsultsinafailure.Ofourse,inpratie,someompilerand \noperatingsystemsupportisrequiredtoensurethatunlokp isonlyusedinodewhihatuallyatsonbehalfofprinipal p.Thisusuallyrequirestheuseofryptographiauthenti\u00adationtehniques. \nItisalsopossibletodesignaaluluswithimpliitaess ontrol,i.e.whereeveryvalueisimpliitlylokeduponre\u00adation,andunlokeduponaess,asine.g.[12].Wedisuss \nbothasesbelow. 9.2 Typing Again,extendinganexistingtypesystemwithaesson\u00adtrolfeaturesanbedoneabstratly,i.e.independentlyof \nthesystem'sdefnition,usingatranslation-basedapproah. Letusbriefyskethhow. Assumegivenatargetaluluswithpairs((\u00b7,\u00b7)),plus,for \neveryprinipalpEP,aonstantpandaprimitiveoperation atsforp.Require(atsforpv)tobewell-typedonlyifvis aonstantqEPsuhthatpq.Toeasilymeetthis \nrequirement,thetargetsystem'simplementormaywishto assume(P,)formsalattie.Defneatypesystemforthe sourealulusbyliftingthetargetsystemthroughasimple \nenoding: [lokpD=Ax.( x,p) [unlokpD=Ax. letp( x,q) =xin atsforpq; x Then,thederivedtypesystemenjoyssubjetredutionand \nprogressproperties.Inpartiular,aessontrolisentirely stati:ifaprogramiswell-typed,thenallofitsaesson\u00adtrolheksmustsueed.Asaresult,allheksanbe \nompiledaway.Inotherwords,theaboveenodingonly servestyying,notomyilation,purposes. 9.3 Combining information \n.ow and access control Informationfowandaessontrolmayoexist.Extend thesyntaxandsemantisofthesourealuluspresentedin \nsetion3with(expliitorimpliit)aessontrolfeatures, whilepreservingitsstabilityproperty.Findatypedtarget \nalulusequippedwithprinipalonstantspEP,labelon\u00adstantslE\u00a3,andsuitableoperationsthereon.Then,liftthe targettypesystemthroughanappropriateenoding. \nIfthesourealulushasimpliitaessontrol,thena simpleenoding,whereeveryexpressioneismappedtoa triple(e,ep,el),willdo.Theomponentsofthetriplere\u00adspetivelyrepresente'somputationalontent,theprinipal \nwhoseauthorityhasbeenusedtoloke,ande'slabel.This yieldsasystemwhereeverytypearriestwoannotations,a prinipalandalabel. \nIfthesourealulushasexpliitaessontrolopera\u00adtions,thenadiferentenodingmustbeused.Mapeveryex\u00adpressionetoapair(\u00b7,el),whosefrstomponentis( \ne,ep) , ifeisloked,andsimplyeotherwise.Thisisexatlythe enodingpresentedinsetion5,extendedtodealwithlokp \nandunlokp.Asbefore,ityieldsasystemwhereeverytype arriesone(informationfow)label.Avalueofomputa\u00adtionaltypee,arryingalabel',willreeivetypee \n' ifitis unloked,and(e7loked) ' ifitislokedatlevel7.Here, lokedisthetypeonstrutorassoiatedwithpairsofthe \nform((\u00b7,\u00b7))inthetargetsystem. Inommonprograms,aessontrolfeaturesshouldbe usedonlyatafewkeyplaes.Forthisreason,makinga\u00adessontrolexpliit,ratherthanimpliit,maybepreferable. \nIndeed,thisapproahyieldstypeswhihareusuallymore onise,andwhereaessontrolrestritionsaresyntati\u00adallymoreapparent. \nMarryinginformationfowanalysiswithaessontrolis notanewidea.Stoughton[25]andHeintzeandRieke[12] notiethataessontrolandinformationfowontrolserve \ndiferentpurposes,andproposehybridsystemswhereboth mehanismsoexist. However,theseworksfail,inouropinion,tomakearu\u00adialpoint:thetwomehanismsareentirelyunrelated,and \nshouldoexistwithoutinterating.Indeed,aessontrol involvesyriniyals,trustandauthentiation,whileinforma\u00adtionfowontrolrequiresneither.Furthermore,desribing \naessontrolusuallyinvolvesintroduingsomeformofse\u00adurityviolationinthelanguage'ssemantis,whileinforma\u00adtionfowontroldoesnot.Why?Aessontrolimplements \nafxedseuritypoliy,defnedby(P,);itismeaningless intheabseneofsuhapoliy.Informationfowontrol, ontheotherhand,doesmakesenseevenwhen(\u00a3,)isleft \nunspeifed,aspointedoutinsetion.3,beauseitisonly adeyendenyanalysis.Itdoesnot,fundamentally,have anythingtodowithseurity,whihexplainswhyitanbe \nformalizedwithoutanotionofseurityviolation. Whysuhemphasisonthispoint?BothStoughton[25] andHeintzeandRieke[12]defnesystemswhereaesson\u00adtrolandinformationfowinterat,byidentifyingprinipals \nwithlabels,i.e.settingP=\u00a3,andrequiringeveryvalue toarryaninformationfowlabellwhihislessrestritive thanitsaessontrollabelp,i.e.lp.Furthermore,[12] \ndefnesanoperationalsemantiswherebothkindsoflabels interat:theexpression(proteti v)usestheinformation \nfowlabelirtoupdatenotonlyv'sinformationfowlabel, butalsoitsaessontrollabel. Intheseworks,theallegedjustifationforrequesting \nlpisasfollows.ptellswhomayusethevaluediretly, whileltellswhomayuseitindiretly,i.e.have(possibly partial)aesstotheinformationontainedinit.Beause \nanyprinipalwhoisgranteddiretaessistherebygranted indiretaessatthesametime,requiringlpmayseem natural.Wedeemitwrong,however,beausethesenotions \narereallyorthogonal:whilepindeedtellswhomayusethe value,ltellswhihinformationitontains.Mixingthetwo mehanismsyieldsaneedlesslyomplexsystem.Separating \nthemmakesthesystemmoremodular,oneptuallysim\u00adpler,andpotentiallymoreexpressive,sinePand\u00a3maybe distint. \nMyersandLiskov[15,14]proposea\"deentralized\"label modelwhihisasubtlemixtureofaessontrolandinfor\u00admationfowontrol.Themodelalsorestsonasetofprin\u00adipals(P,).Alabelisasetoftaggedyoliies,wherethe \ntagarriedbyeverypoliyisaprinipal,alleditsowner. Ayoliyisasetofprinipals,alledreaders.Labelsforma pre-order,whoseunderlyingorderisalattie;itisused,asin \nthispaper,toperforminformationfowanalysis.However, MyersandLiskovalsoallowanumberof\"safe\"delassifa\u00adtionoperations:aprinipalpmayhoosetorelaxthelabel \narriedbyagivenvalue,byarbitrarilymodifyinganypoliy ownedbyaprinipalqwhihitatsfor.Ofourse,pisnot allowedtoafetthepoliiesownedbyprinipalswhosetrust \nithasnotreeived.So,labelsdonotonlyarrydeyendeny information;theyalsoontainaessontrolinformation, sinetheuseofdelassifationisrestrited. \nWethinkMyersandLiskov'smodelhassignifantprati\u00adalinterest.However,webelievethatomparableexpressive 3 poweranbeahievedinatheoretiallysimplersystem. \nIndeed,imagineorthogonalaessontrolandinformation fowontrol,assuggestedabove.Then,onemayseletively allowdelassifationbyproviding,intheinitialtypingenvi\u00adronment,anumberofdelassifationoperations,lokedat \nappropriatelevelsofauthority.ThesetsPand\u00a3may,in general,behosenindependently;onlythetypesofthede\u00adlassifationoperationsprovideaonnetionbetweenthe \ntwo.Thispresentationofthesystemismodularandab\u00adstrat.ByvaryingP,\u00a3,andthelevelofauthorityrequired byeahdelassifationoperation,oneobtainsawiderange \nofonretesystems,someofwhihareinfatveryloseto MyersandLiskov's,andhaveomparableexpressiveness. Weprefertopresentdelassifationasseletive,rather \nthansafe,sineitsusebreaksthenon-interfereneproperty atleastpartially.Althoughitisonlyamatterofterminol\u00adogy,speakingof\"safe\"delassifationissomewhatmislead\u00ading:thissortofdelassifationisonlysafeforprinipals \nwhoseauthorityisnotgrantedtotheoperation. Letusillustrateourproposalwithaverysimpleexample, inspiredfromtheACCATGuard[].Assume\u00a3isthelattie \nprodutofthe2-pointlattieSERET={LH}withsome unspeifedlattieM.Thus,inaaluluswith(say)impliit (A) aessontrol,typeswillbeoftheforme,where7,A \nandfrangeoverP,SERETandM,respetively.Assume theinitialtypingenvironmentofersthebinding (.)(.)...n delass:Ve7f.(e-e) \nwhereswoEPisafxedprinipal.Then,information mayfreelyfowfromlevel(L,m)tolevel(H,m),forany mEM,sinetheformerisasub-typeofthelatter.How\u00adever,theonlywayofallowingfowsinthereversediretion \nistousedelass,whihrequiresapprovalbytheprinipal swo,sineitmustbeunlokedwheninvoked.Thisallows modelinga\"guard\",i.e.agatewaybetweenalassifedand \nanon-lassifedsystem,wherefowswhihappeartovio\u00adlateseuritymustbeapprovedbyatrustedSeurityWath Ofer.Furthermore,notiethateventheprinipalswo \nmaynotperformarbitrarydelassifations:itisunableto modifytheseondomponentoflabels.Thus,apartialnon\u00adinterfereneresultholds:aresultwhoseinformationlabelis \n(\u00b7,m)annotdependonanyinputwhoselabelis(\u00b7,n), wherenEtm.Forinstane,ifNulearandStrategiare inomparableelementsofM,thenaomputationwhosere\u00adsulttypeis(L,Nulear)annotleakanyinformationoftype \n(L,Strategi),eventhoughitmayrevealsomeinformation oflevel(H,Nulear).ThisisexatlywhatMyersandLiskov term\"safe\"delassifation. \n10. DISCUSSION Wehaveshownhowtosystematiallyextendanarbitrary typesystemwithdependenyinformation,andhowsound\u00adnessandnon-interfereneproofsforthenewsystemmay \nrelyupon,ratherthandupliate,thesoundnessproofofthe 3assuming(P,)isfxed,i.e.maynotvaryatruntime. originalsystem.Thisallowsenrihingvirtuallyanyofthe \ntypesystemsknowntodaywithinformationfowanalysis, whilerequiringonlyaminimalproofefort. WereentlybeameawareofRossandSagiv'sredution \nofafowdependeneproblemtoamay-aliasproblem[23]. Althoughtheprogramminglanguage(frst-order,imperative vs.higher-order,funtional)andthetargetsystem(pointer \nanalysisvs.typeinferene)onsideredareratherdiferent fromours,bothpapersrelyonasimilarenoding,where everyvalueistranslatedtoapairofavalueandatag.We \ntakethisasevideneofthestrengthofthisredutionisti approah. OurworkomplementsAbadietal.'s[1].Theyshowthat \nseveralprogramanalyses,inludingsereyandintegrity analyses,programsliing,andbinding-timeanalysis,arede\u00adpendenyanalyses,whihonlydiferbythehoieofthe \ninformationlattie\u00a3.Asaunifyingdependenyalulus, theyproposeasimply-typedA-alulus,basedonMoggi's omputationalA-alulus.Inturn,weshowthatitispos\u00adsibletoenrihanystandardtypesystemwithdependeny \ninformation.Combiningtheseresultsyieldsexpressivetype systemsforalloftheanalysesabove. Byvarying\u00a3,adependenyanalysismaybeusedtoob\u00adtainsereyorintegrityguaranteesaboutaprogram.It \nisinterestingtonotiethatbothmaybeobtainedatthe sametime,withoutrequiringtwoannotationspertype:one isenough,provided\u00a3istheyrodutofasereylattie \nwithanintegritylattie.Thesametrikanbeappliedto aessontrol:bylabelingdatawith\"loks\",ratherthan prinipals,andhoosingthelattieoflokstobethelat\u00adtieprodutof(P,)withitsowndual,asingleannotation \nsufestomanageandenforerestritionsonvalueaess andreation.Thus,extendingtheSLamalulustodeal withintegrity[12,setion4]wasunneessary:notonlyis \nitenoughtomaintaintwoseurityannotations,ratherthan four,butnoneworretnessproofneedsbegiven. Infat,inatypesystemenrihedwithdependenyanno\u00adtations,ayolymoryhitypesheme(suhasthatofexists, \ngiveninsetion.3)fullyandabstratlydesribesthede\u00adpendeniesinduedbyapieeofode.(Thisideaappearsin severalpreviousworks,e.g.[,5,27].)Indeed,itdouments \nnotonlythebehavioroftheodeatdiferentseuritylev\u00adels,butalsowithindiferentseuritylatties.Thisexplains theremarkofthepreviousparagraph:ratherthanaddnew \nannotations,useanewlattie. Wehavearguedthataessontrolandinformationfow ontrolshouldbeimplementedindependently.Thelatter \nisnotarefnementoftheformer;theyarediferentmeha\u00adnisms.Oneisbasedontrust,theotheronyroof.Itispossi\u00adble,however,toletthemoexistwithinasingledesign.We \nhaveshownthatthisgivesrisetointerestingpossibilities, inludingseletivedelassifation. Toonlude,webelievewehavefoundaverylightweight \napproahtonon-interfereneproofs.Itisbasedonanun\u00adtypedoperationalsemantisforalabelledalulus,together withatranslationtoanunlabelledalulus.Twobasire\u00adsultsmustbeproved:astabilitytheorem,whihstatesthat \nthelabelledsemantisnever\"drops\"labels,andasimula\u00adtionlemma,whihshowsthatthetranslationismeaningful. Beauseofitssimpliity,thisapproahshouldbediretly \nappliabletootheromputingparadigms,suhasobjetor proessaluli.Weareurrentlyinvestigatingthisissue. 11. REFERENCES \n[1]M.Abadi,A.Banerjee,N.Heintze,andJ.G.Rieke. Aorealulusofdependeny.InConfereneReord ofthe26thACMSymyosiumonPriniylesof \nProgrammingLanguages,pages147 10,SanAntonio, Texas,Jan.1999. [2]M.Abadi,B.Lampson,andJ.-J.Levy.Analysisand \nahingofdependenies.InProeedingsofthe--6 ACMSIGPLANInternationalConfereneon FuntionalProgramming,pages391,Philadelphia, \nPennsylvania,May199. [3]A.Aiken,M.Fahndrih,J.S.Foster,and .Su.A toolkitforonstrutingtype-andonstraint-based \nprogramanalyses.LetureNotesinComyuterSiene, 1473:7 ,199. [4]G.R.AndrewsandR.P.Reitman.Anaxiomati approahtoinformationfowinprograms.ACM \nTransationsonProgrammingLanguagesand Systems,2(1):57 ,Jan.190. [5]J.-P.Ban tre,C.Brye,andD.LeMetayer. \nCompile-timedetetionofinformationfowin sequentialprograms.InD.Gollmann,editor, Proeedingsofthe3rdEuroyeanSymyosiumon \nResearhinComyuterSeurity,volume75ofLeture NotesinComyuterSiene,pages55 74.Springer Verlag,1994. [ ]D.E.Denning.CryytograyhyandDataSeurity. \nAddison-Wesley,Reading,Massahusetts,192. [7]D.E.DenningandP.J.Denning.Certifationof programsforseureinformationfow.Communiations \noftheACM,20(7):504 513,July1977. [ ]J.S.Fenton.Memorylesssubsystems.TheComyuter Journal,17(2):143 147,May1974. \n[9]C.Fournet,L.Maranget,C.Laneve,andD.Remy. ImpliittypingalaMLforthejoin-alulus.In8th InternationalConfereneonConurrenyTheory \n(CONCURT-97,volume1243ofLetureNotesin ComyuterSiene,pages19212,Warsaw,Poland, 1997.Springer. [10]Y.-C.FuhandP.Mishra.Polymorphisubtype \ninferene:Closingthetheory-pratiegap.InJ.D az andF.Orejas,editors,Proeedingsofthe InternationalJointConfereneonTheoryand \nPratieofSoftwareDeveloyment:Vol.2,volume352 ofLNCS,pages171 3,Berlin,Mar.19 9.Springer. [11]J.GoguenandJ.Meseguer.Seuritypoliiesand \nseuritymodels.InProeedingsofthe-82IEEE SymyosiumonSeurityandPrivay,pages1120, Apr.19 2. [12]N.HeintzeandJ.G.Rieke.TheSLamalulus: \nProgrammingwithsereyandintegrity.In ConfereneReordofthe25thACMSymyosiumon PriniylesofProgrammingLanguages,pages3 \n5377, SanDiego,California,Jan.199 . [13]B.W.Lampson.Anoteontheonfnementproblem. CommuniationsoftheAssoiationforComyuting \nMahinery,1(10):13 15,Ot.1973. [14]A.C.Myers.Mostly\u00adStatiDeentralizedInformation FlowControl.PhDthesis,MassahusettsInstituteof \nTehnology,Jan.1999.TehnialReport MIT/LCS/TR-7 3. [15]A.C.MyersandB.Liskov.Complete,safe informationfowwithdeentralizedlabels.In \nProeedingsofthe --8IEEESymyosiumonSeurity andPrivay,pages1197,May199. [1]M.Odersky,M.Sulzmann,andM.Wehr.Type \ninferenewithonstrainedtypes.TheoryandPratie ofObjetSystems,5(1),1999. [17]P.0rbkandJ.Palsberg.TrustintheA-alulus. \nJournalofFuntionalProgramming,7( ):557 591, Nov.1997. [1]J.PalsbergandP.0rb k.TrustintheA-alulus. LetureNotesinComyuterSiene,93:314330, \n1995. [19]F.Pottier.Simplifyingsubtypingonstraints:a theory.Submittedforjournalpubliation,De.199. [20]F.Pottier.Typeinfereneinthepreseneof \nsubtyping:fromtheorytopratie.TehnialReport 343,INRIA,Sept.199. [21]D.Remy.ProjetiveML.In --2ACMConfereneon \nLisyandFuntionalProgramming,pages 75, New-York,1992.ACMPress. [22]D.RemyandJ.Vouillon.ObjetiveML:Asimple \nobjet-orientedextensionofML.InProeedingsofthe 24thACMSymyosiumonPriniylesofProgramming Languages,pages40 \n53,Paris,Frane,Jan.1997. [23]J.L.RossandM.Sagiv.Buildingabridgebetween pointeraliasesandprogramdependenes.Nordi \nJournalofComyuting,5(4):3 13,199 . [24]G.S.Smith.Polymorphitypeinferenewith overloadingandsubtyping.InM.-C.GaudelandJ.-P. \nJouannaud,editors,TAPSOFTT-3,volumeof LetureNotesinComyuterSiene,pages715. Springer-Verlag,Apr.1993. \n[25]A.Stoughton.Aessfow:Aprotetionmodelwhih integratesaessontrolandinformationfow.In Proeedingsofthe-8IEEESymyosiumonSeurity \nandPrivay,pages91,191. [2]V.TrifonovandS.Smith.Subtypingonstrained types.InProeedingsoftheThirdInternationalStati \nAnalysisSymyosium,volume1145ofLNCS,pages 349 3 5.SV,Sept.199 . [27]D.VolpanoandG.Smith.Atype-basedapproahto \nprogramseurity.LetureNotesinComyuterSiene, 1214: 07 21,Apr.1997. [2]A..WrightandM.Felleisen.Asyntatiapproah \ntotypesoundness.InformationandComyutation, 115(1):394,Nov.1994.   \n\t\t\t", "proc_id": "351240", "abstract": "This paper shows how to systematically extend an arbitrary type system with dependency information, and how soundness and non-interference proofs for the new system may rely upon, rather than duplicate, the soundness proof of the original system. This allows enriching virtually any of the type systems known today with information flow analysis, while requiring only a minimal proof effort.Our approach is based on an untyped operational semantics for a labelled calculus akin to core ML. Thus, it is simple, and should be applicable to other computing paradigms, such as object or process calculi.The paper also discusses access control, and shows it may be viewed as entirely independent of information flow control. Letting the two mechanisms coexist, without interacting, yields a simple and expressive type system, which allows, in particular, \"selective\" declassification.", "authors": [{"name": "Fran&#231;ois Pottier", "author_profile_id": "81100490085", "affiliation": "INRIA, BP 105, 78153 Le Chesnay Cedex, France", "person_id": "PP39077387", "email_address": "", "orcid_id": ""}, {"name": "Sylvain Conchon", "author_profile_id": "81100604685", "affiliation": "INRIA, BP 105, 78153 Le Chesnay Cedex, France", "person_id": "PP37029504", "email_address": "", "orcid_id": ""}], "doi_number": "10.1145/351240.351245", "year": "2000", "article_id": "351245", "conference": "ICFP", "title": "Information flow inference for free", "url": "http://dl.acm.org/citation.cfm?id=351245"}