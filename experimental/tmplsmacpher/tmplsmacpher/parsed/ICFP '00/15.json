{"article_publication_date": "09-01-2000", "fulltext": "\n .P e r w lev e s b e of b e e he b eha h as e ev e ev P , b b eha o attwolevels:singlethreadtransitionsatoneleveland \nmultithreadrelationsattheotherlevel. Itapturesthethreadbehaviourandevaluationorder ofanexistingparallelfuntionallanguageimplemen\u00adtation,GpH. \n Theunderlyingideaoflabellingheapbindingswith theirativitystatusissu\u00c6ientlyfexibleandpowerful todesribeavarietyofothermodelsofparallellazy \nevaluation.See[19]forexample.  InSetions2.10wedesribetheframeworkofouropera\u00adtionalsemantitehniqueanddevelopaspeifationofthe \nomputationandoordinationbehaviourofGpH.InSe\u00adtion12werelateoursemantistoastandarddenotational semantisforsequentiallazyevaluationandproveadeter\u00adminayresult.Weexamineseveralalternativemodelsof \nparallellazyevaluationtodemonstratethefexibilityand generalityofourapproahinSetion13.InSetion14we defnesomestandardmetrisofparallelismintermsofour \nsemantis.WeonludebydisussingrelatedworkinSe\u00adtion15andourfutureplansinSetion16. 2. MODELLING PARALLELISM \nTheoperationalsemantiswepresentisatwo-leveltransi\u00adtionsemantis.Atthelowerlevel,therearesingle-thread \ntransitionsforperformingtheordinaryevaluationofexpres\u00adsions(,-redutionandthelike).Allandidatesingle-thread \nstepsarearriedoutsimultaneously(oneptuallyonsepa\u00adrateproessors)andinlokstep.Theyarethenombined intoaparallelomputationstepusingoordinationrelations \ndefnedattheupperlevel. WefollowLaunhbury'sseminalwork[21]byusingaheap toallowsharingandarestritedlanguagetoavoidtheom\u00adpliationsofreatinglosuresinthesemantis.There\u00adstritedlanguageensuresthateverylosureisprovidedwith \na'name'(avariable)bysomeorrespondinglet-binding. Oursemantisissetatalowerlevelofabstrationthan Launhbury'ssineweuseasmall-stepomputationalse\u00admantisratherthanabig-stepnaturalsemantis.Thisis \nthetypialapproahformodellingparallelism[18]sineit allowsustomorediretlyrepresenttheoordinationofmul\u00adtipleseparateations. \nNevertheless,oursemantisisatahigherlevelthananab\u00adstratmahine[4],thusavoidingtheneedforstaks,blok\u00adingqueuesandsuhlike. \n 3. THE LANGUAGE GpH-OREisasimplesubsetofthelanguageGpH.Iton\u00adsistsoftheuntypedA-alulusextendedwithnumbers,re\u00adursivelets,aformofsequentialompositionseqanda \nformofparallelompositionpar.Sine[21],ithasbeome ommonpratietonormalisethelanguagetoarestrited syntax.Thenormalisedtermsdiferfromtheirorrespond\u00adingtermsinGpHintwoways:allvariablesaredistint; \nandtheseondargumentofappliationandthefrstar\u00adgumentofparmustbevariables.Infat,thenormalised termsorrespondtotheinternalorelanguagethatisused \nintheimplementationofGpH.Theproessofnormalisa\u00adtionisstraightforwardbyintroduingnewlet-bindings;for example,analgorithmisgivenin[17]. \nx,Y,ZEVariable nENumber eEExpression e::=nIxIexIAx.eIlet{x;=e; ; 'line Ielseqe2Ixpare Numbersareunneessarybutareinludedtomakeexamples \neasiertofollow.Noextrarulesareneededinthesemantis todealwithnumbers.Inoursemantisonlylosedterms willbeonsidered,thatis,programsontainnofreevari\u00adables.Construtorsandaseexpressionsarealsoastandard \npartoftheGpHlanguagebutarenotinludedhere.They areunimportanttoourentralonernwithparallelism. 3.1 Parallel \nand sequential composition GpH-OREandGpHexpressparalleloordinationusingthe ombinatorspar(forparallelomposition)andseq(forse\u00adquentialomposition).Theseombinatorsaredefnedas \nfollows: .,ifel=. elseqe2= e2,otherwise elpare2=e2 Theoperationalbehaviourofseqistoredueeltoweak headnormalformbeforereturninge2,thusenforingan \nevaluationorder.Theterminationpropertiesofaprogram anthereforebehangedbyusingseq,inontrasttopar whihhasnoafetonterminationproperties.Theoper\u00adationalbehaviourofparistoproeedwiththeevaluation \nofe2andifaseparateproessorisavailable,toevaluateel simultaneously.Theideaoftheparombinatorisnotnew; itsinventionisattributedtoJohnHughes.l \nItisimportanttonotethatparwillevaluateeltowhnfand nofurther.Henetheneedforseqwhihisoftenusedto foretheevaluationofdatastruturestonormalform.For \nexample,ifxsandYsaretwoliststhenxsparYswillnot evaluatethetwolistsinparallelwithall-by-needevalua\u00adtionbeausetheyareinwhnf.Usingseq,however,afun\u00adtionseqListanbedefnedthatforestheevaluationofthe \nstrutureofalist.Hene,toreduethetwolistsinparallel andreturnthemweanuse(seqListxsparseqListYs)seq (xs,Ys).Trinderetal.[34]oferamuhmoredetailedex\u00adpositionoftheuseofparandseq. \n 4. HEAPS AND LABELLED BINDINGS Following[21]weuseaheapofbindingsofexpressionsto variables,butforourpurposeseahbindingalsoarriesa \nlabeltoindiateitsstateofativity.Thus,heapsarepartial funtionsfromvariablestoexpression/thread-statepairs: \n, EHeap=Variable\u00c6o(Expression,State) C,,EState C::=InativeIRunnableIAtiveIBloked Wewriteindividualbindingswiththethreadstateappear\u00adingasanannotationonthebindingarrow,thus: \nx Q oe l Personalommuniation:DaveSands. 4 4 ;I ; let{x; -o({x; : Z Zoe)(let) in o 4 o o =e; ee;, ;'l \n;'l o e,Z 4 o ):Z I -o ( v):Z (Zv )(var) ,xx 4 IRB x -o ((x x)(blokl) oooo ,xe 4 RAB B -o ( e ):Z \n(Zox)(blok2) oo ,xx o (AY.e) 4 o (Z B -o ZZ (Z Z)(blakhole) : 44 e[x/Y]) -o Z (subst) : oo x o \nex 4Q ') -o Z(,Z : o ee (app) oZo 44Q ' -o Z(,Zx) : o e o 4Q -o vseq (Z e)(seq-elim) : e o elseqe2 \n4 ' l) -o Z(,Z : o ele (seq) o RAB 4Q o ' l -o Z(,Ze2) : e seq 44 -o ():Z(Z e2)(par-elim) ooo ,xel \n xpare2 44 IR -o ():Z(x ,Z e2)(par) oooo ,xel xpare2 el Figure1:Singlethreadtransitionrules Thebindingstateisusuallyabbreviatedtothefrstletter,Theoperationalsemantisdesribesaredutionsequene \nI,R,A,orB.AbindingisAtiveifitisurrentlybeingfromaninitialglobalonfgurationtoafnalglobalonfg\u00adevaluated;itisBlokedifitiswaitingfortheevaluationuration: \nofanotherbindingbeforeitsevaluationanproeed;and itisRunnableiftherearenotenoughresouresurrently availabletoevaluateit.AllotherbindingsareInative,that \nis,theyhavenotyetbeeninitiatedortheyhavefnished beingevaluated.Aheapannotontainmultiplebindings forthesameidentifer. \nTheideaoflabellingbindingswithanindiationoftheir stateofativityissurprisinglypowerfulandgeneral,allow\u00adingustomodelavarietyofparallelevaluationstrategiesas \nwedemonstrateinSetion13.However,ourmaininterest isindesribingGpHsothatwillremainourprimaryfous fornow. \nBindingsorrespondtoheaplosuresandinoursemantis labelledbindingsorrespondtothreads.Intherun-time I 4 oo \nwheremainisalwaysusedastheprogramidentifer.Hene, aprogramterminatesassoonasmainreahesavaluev, irrespetiveofotherbindings.Valuesvarewhnfexpressions \ninGpH-ORE,thatis: v::=nIAx.e  5. SINGLE THREAD TRANSITIONS Thetransitionfuntion-odefnedinFigure1desribes \ntheomputationalsteptakenbyeahativebindinginthe heap.Thelefthandsideineahrulerepresentsaheapwith thepartiularativebindingdistinguished: \n' ?...=?( (,main ) ,main v)e = 4 o respondtothreads.GpHalsousesotherthreadstatessuh asfething,whihistheommuniationstate.ItisusefultoSeveraloftherulesdependonotherbindingsintheheap \nbeabletomodelommuniation,butitisnotasimportant(forexample,theblok;rules)sowealsousethenotation systemforGpH[35]onlylosuresthatarenotinativeor\u00ad \n:Z e QQ forGpHasitisformanyotherlanguages.Oursemantis ( e)topartitiontheheap,separating xe fromthe oo \n,x attributesnoosttoommuniation,soanidealisedarhi\u00adtetureismodelled.SomeproflingsimulatorsforGpH,for exampleHBC-PP[32]andGRANSIM-Light[22],alsomodel \nsuhanidealisedmahineandtheyhaveproventogiveuse\u00adfulinformation. Theomputationalsemantisisgivenasarelationonheaps \n' =?whihisinturndefnedintermsofanotionof singlethreadtransitions(Setion5)andashedulingrela\u00adtion(Setion7). \nRAB otherbindingsin.Multi-labelbindings,suhasxoe intheblok2rulemeanthatthestateisoneofR,AorB butnotI. \nTherighthandsidesoftherulesinFigure1isaheapin thesensethatitisasetoflabelledbindingsbutitonsists ofonlythosebindingsthatarehangedorreatedbythat \nomputationstep.Thehangesforallativebindingsare ombinedbytheparallelrule(Setion6)toreateafull heaptoheaptransition. \nLet:Theletrulepopulatestheheapwithnewbindings. Thesebindingsareinativesineunderall-by-needthey maynotneessarilybeevaluated. \nVariablesandbloking:Inthevarandblok;rulesthe 4 distinguishedbindingZoxrepresentsthesituationofeval\u00aduatingalosure(alledZ)whihonsistsofapointertoan\u00adotherlosure(alledx).Ifxhasalreadybeenevaluatedto \nwhnfasinthevarrule,thenZsimplyreeivesthatvalue. Thenotationv signifesarenamingofallboundvariables invtofreshvariablenames.Thevarruleistheonlyplae \nwherenamesaredupliated.AsLaunhburyproves[21], thisissu\u00c6ienttoavoidallunwantednamelashes.Anal\u00adternativesuggestedbySestoft[33]istorenameboundvari\u00adablesatthetimethatletbindingsareaddedtotheheap. \nSestoft'sapproahispreferredforabstratmahines[4]but Launhbury'snotationismoreparsimoniousandadequate forourpresentpurposes. \nIfxisinativeandhasnotyetbeenevaluated,asinthe bloklrule,thenZbloksatthispointandxjoinsthepoolof runnablebindings,possiblytobeativatedbytheshedul\u00adingrelation.Ifxisalreadyative,runnableorblokedas \ninblok2thenZbloksbutxisunafeted. Blakholes:Disussionoftheblakholeruleisdeferredto Setion10. Appliation:Non-stritevaluationofele2proeedsbyre\u00adduingeltoanabstration(apprule)andthensubstituting \ntheargumentxfortheboundvariableY(subst). Seq:Theseqruleproeedstoevaluateelintheexpression elseqe2butmakesnoprogressone2.Whenandifel \nreaheswhnfitsvalue(butnottheefetontheheap)is disardedbytheseq-elimruleandevaluationproeedsto e2. Par:InGpHtheonlywaytointrodueparallelismisby \nusingparandthisisrefetedinthesemantisbythepar rule.Notiethatitdoesnotreatemoreparallelismimme\u00addiatelybutinsteadsuggeststhatabindingshouldbemade \nativebyputtingitintoaRunnablestatewhihmaybepro\u00admotedtoAtivelater.Thispromotionanhappeninthe shedulingphase(Setion7)butonlyifsu\u00c6ientproess\u00adingresouresareavailable.ThisorrespondstoGpHwhere \nparisthoughtofasahintofwhattoparallelise,rather thanaommand.Ifthebindingisalreadyative,runnable orblokedthereisnomoretodo(par-elim). \n 6. MULTI-THREAD TRANSITIONS Ativebindingsaredelegatedforsinglethreadstepsbythe followingparallelomputationrule.Thisisthekeypointin \nthesemantiswhereredutionsarearriedoutinparallel. Therulealsomeldstogetherallthenewbindings,updating theheapaordingly(Figure2). \nWe w rite 4torepresentalltheativebindingsin . More preisely: 4 ={x 4 oeE 44 4; ; ={x;oe;;'l{:x;oe; -o;;'l \n. ; =?[;'l;] (parallel) Figure2:Combiningmultiplethreadtransitions HeneinFigure2thereareexatlynativebindingsin. \nThenotation[]updatestheheapwithallthenew orhangedbindingsgivenby.Morepreisely,itanbe defnedasfollows: \nQ []={xoeEIxE dom() Bytakingtheunionofallthe;intheparallelrulethere appearstobethepotentialforonfitstoarisebetween \nB4 ' bindings.WhatifxoeElandxoeE2,for example?Thefollowingpropositiondemonstratesthatfor thesinglethreadrulesdefnedinFigure1,nosuhonfit \nanarise. 44 PROpOSITION6.1.Given(l,Zloel)=(2,Z2oe2) whereZl =Z2. 44 Ifl:Zloel -oland2:Z2oe2 -o2then: \nIAB ifxoeElthenxE dom(2) RR ifxoeEltheneitherx Edom(2)orxoeE2 PROOF.Byindutiononelande2andthesyntatire\u00adstritionthatallvariablesaredistint(Setion3). \n 7. THE SCHEDULING RELATION Aswellastheomputationalstepsdefnedsofar,wealso needtodesribetheoordinationaspetsofthelanguage. \nInpartiularweneedtogivethesemantisofthesheduling phaseoftheevaluation.Theshedulingationsforindivid\u00adualthreadsaredefnedinFigure3asfollows: \n Anybindingthatisimmediatelyblokedonaom\u00adpletingthreadismaderunnable(unblok);  Anativeorrunnablebindingthatisinwhnfismade \ninativebeauseitsevaluationisdone(deativate);  Asmanyrunnablebindingsasresoureswillalloware promotedtobeingative(ativate). \n RAB .RAR (,xov,Zoe)-o(,xov,Zoe)(unblok) RA.I (,xov)-o(,xov)(deativate) I4I . (ativate) R.4 (,xoe)-o(,xoe) \nFigure3:Singlethreadshedulingrules Thenotationerepresentsanexpressionthatisimmediately blokedonx.Inourlanguagetheseanonlytakethree \nforms: ' e::=xIxYIxseqe IntheativateruleinFigure3,.isaparametertothe semantis,indiatingthetotalnumberofproessors.Hene \nwerequirethatnomorethan.bindingsareativated. Notethatnowhereintheserulesisitspeifedwhihbind\u00adingsareativated.Theativationphasepresentsanon\u00addeterministihoie.Nevertheless,thenon-deterministi \nhoieisattheoordinationlevelanddoesnothangethe valueomputed. TherulesinFigure3onlyafetsinglebindings.Weneedto \nunblokanddeativateallandidatethreadsandtoativate asmanyaspossible.Tothatendwemakethedefnitions - inFigure4.Inefet,therulesinFigure4defne=?tobe \n- thenormalformrelationsbuiltupon-o. -' =?if: -*' 1.-oand -'' ''' 2.thereisnosuhthat-o. (tisuordora.) \nFigure4:Componentshedulingrelations Notethat=?istheonly'true'relation;=?,=?,=?are allfuntions.Inotherwordstheonlynon-determinismthat \nexistsisinthehoieofwhihthreadsfromtherunnable poolareativated. Shedulingpromotesrunnablebindingsintoanativestate \niftherearesu\u00c6ientproessorsanddemotesativeevalu\u00adatedexpressionstoaninativestate.Toahievemaximum parallelismwithrespettothenumberofproessorsitis \nneessarythatallandidatethreadsareunblokedbefore deativationandthatdeativationtakesplaebeforeati\u00advationtofreeupasmanyproessorsaspossible.Thisse\u00adqueneofationsisapturedbythefullshedulingrelation \ndefnedinFigure5. =?==?\u00c6=?\u00c6=?(shedule) Figure5:Completeshedulingrelation 8. THE COMPUTATION RELATION \nFinallythefullomputationrelationofoursemantison\u00adsistsofaparalleltransition=?followedbyashedulingof bindings=?,asinFigure6.Thisorderingensuresthat \nheapsappearinginaredutionsequenearealwaysfully sheduled.AbriefexampleisgiveninSetion11. Sinethesemantisisparameterisedonthenumberofpro\u00adessors,wedeoratetheomputationrelationwiththenum\u00adberofproessorswhereneessary:=?.Inpartiularwewill \n. use=?toindiatethesingle-proessorase. =?==?\u00c6=?(ompute) Figure6:Computationrelation 9. PROMOTING THE \nMAIN THREAD Aonsequeneofthepresentdefnitionof=?isthatthe mainthreadmaybeleftrunnablebutneverprogress.Sup\u00adposemainbloksonsomevariableZbyoneofthebloking \nrulesinFigure1andZispromotedtoarunnablestate.If thepoolofrunnablethreadsislargerthanthenumberof availableproessorsthenthereisnoguaranteethatZwill \nbemadeativeunderthepresentshedulerelation.Itis possiblethatthemainthreadouldthusbedelayedorsus\u00adpendedindefnitely,ifthereisaonstantsupplyofunneeded \nspeulativethreadsbeinggeneratedandsheduledinplae ofthemainthread. Yet,aordingtothedesignersofGpH,theirimplementa\u00adtionmakesnoassuranethatabindingthatmainneeds \nhaspriorityoverotherbindingswhendeidingwhihones topromotetoanativestate.Whiletheirearlypaperswarn potentialusersthattherun-timesystemoferslittlesupport \nforspeulativeevaluation[35],itneverthelessseemsdesir\u00adableforbindingsrequiredbythemainthreadtoremain ativewheneverpossiblesinethatisthethreadthatdeliv\u00adersthefnalresult.Theremaybenoharminsuspendingthe \nmainthreadbuttheresurelyanbenoadvantageeither. Weanmodelasolutiontothis'defet'bymodifyingthe ativationrelation=?asinFigure7torequirethatany \nrunnablethreadonwhihmainisbloked,inatransitive sensemadepreisebythefuntionreq,isativatedinpref\u00aderenetoanyotherrunnablethread.Weanbesurethat \ntherewillalwaysbeafreeproessorinthisirumstane beausetheblokingationhasmadeoneavailable. . ' =?if: *' \n1.-o; '' ''' 2.thereisno suhthat-oand ' 3.req(main, ' )isativein. RA x,ifxoeE req(x,)= B Y req(Y,),ifxoeE \nFigure7:Strongerativationrelation 10. BLACK HOLES Blakholesareertaindetetableinfniteloops,suhas: letx=xinx \nletx=Y,Y=Z,Z=xinx InGpH,aswellassequentialHaskellimplementations,blak holesaredetetedandreognisedasworthlessomputation. \nItisatleastdesirablethatoursemantisshouldrefetthis treatment.Takingthesimplestaseofdiretself-referene, \n4 o letf=Ax.x,g=(leta=3infa)ingpar(fg) gpar(fg) fg a=3inffg 4 o4 o4 o {main = = ======= = = ??????????? \nI o I o f f { Ax.x,g 3 a,main (let) (par) letin a= I o R o f f { Ax.x,g 3 a,main letin a= I o4 oI \no f { Ax.x,g a,main let 3g I o f(Ax.x)g g(Ax.x)a,maing ga,main 4 o 4 o 4 o4 o4 o4 o f { Ax.x,a a,main \n(let,appevar)) (appevar),subst) , I oI o f { Ax.x,a 3 , I oI oB o f { Ax.x,a 3 g (subst,blok2) , I oI \noI o f { Ax.x,a 3, g3,main 3, 4 o3,maing 3, I og3,main g (var) I oI oR o f { Ax.x,a g I oI oR o f { \nAx.x,a g I oI oI o4 oI o f { Ax.x,a 3 3,main g 3 (var) g, I oI oI o f { Ax.x,a 3 3,main g, Figure8:Exampleredution \nwehave: sorsforthefollowingprogram: main=letf=Ax.x (,Z 4 o letx=xinx )= I o4 o ' ?( x,Z x),x g=leta=3infa \n4 oB o ' gpar(fg) =?( x,Z x) in ,x NotethatmoststepsinFigure8areexpressedinterms WithouttheblakholeruleofFigure1weangonofurther \nofthefullomputerelationbutinsomeinterestingases beausethereisnosinglethreadrulethatappliestoan weseparatetheparallelandshedulesteps.Underlinesare \nusedtoemphasisetheativebindings.Asintended,fandg ativethreadlike x 4 o x andtheparallelrulefailssineit \nrequiresallativebindingstoprogress.Ingeneralthatis notwhatwewantbeauseotherthreadsmaystillbedoing usefulworktowardsthefnalresult.Theblakholeruledeals \nevaluateinparallel.Notethatthisistheonlyredutionse\u00ad quene,providedthereareatleasttwoproessors.However, \ndiferentredutionsequenesanarisewhenthenumberof sparkedthreadsexeedsthenumberofavailableproessors. 12. \nPROPERTIES OF THE SEMANTICS withthissituationbyonverting x 4 o x tobloked x B o x andtherebyreleasesitsproessorforotherusefulevaluation. \nThisbehaviourorrespondstotheimplementationofGpH. Cylessuhasletx=Y,Y=xinxthatleadtoblakholesAbramsky'sdenotationalsemantisoflazyevaluation[1] \nalsobeomeblokedinoursemantis,butwithouttheneed modelsfuntionsbyaliftedfuntionspae,thusdistinguish\u00adforaspeialrule: \ningbetweenatermn(anon-terminatingomputation)and Ax.ntorefetthefatthatredutionistoweakheadnor\u00ad 4 o let \nmalformratherthanheadnormalform.Thisisawidely\u00ad (,ZY,Y=xinx)x= used,simpleandabstratsemantis.Thepropertiesand \nI oI o4 o ' =?( Y,Yx,Z x),x resultsdevelopedinthissetionareexpressedrelativeto thisdenotationalsemantis. \n 4 oI oB o ' =?( x,Y x,Z x),x ' B o4 oB o Launhbury[21]showsanumberofresultsrelatinghisnatu\u00ad=?( x,Y \nx,Z x),x ralsemantisoflazyevaluationtoAbramsky'sdenotational B oB oB o ' =?( x,Y x,Z x),x semantis.Weborrowmuhofhisnotationandseveralof \nourproofsareinspiredbyhis.Inearlierwork[5]weshowed Ifthemainthreaddependsonablakholeandwerequire thatthe1-proessoraseofoursemantisorrespondsto \nittoremainativeasdesribedinSetion9thenwewould Launhbury's. expettheomputationtohalt.Insuhaasereq(main,) \n. . =?)Therearethreemainpropertiesthatweexpetof ? = isemptyandhenesois(=?). mantis:soundness:theomputationrelationpreservesthe \nmeaningsofterms;adequay:evaluationsterminateifand onlyiftheirdenotationisnot.;determinay:thesame 11. \nAN EXAMPLE resultisalwaysobtained,irrespetiveofthenumberofpro\u00adTodemonstratetheoperationalsemantisinationweshowessorsandirrespetiveofwhihrunnablethreadsareho\u00adinFigure8theredutionsequenewithatleasttwoproes-senforativationduringtheomputation.Thedeterminay \nisundefnedsothestepfails.Inotherwords,( ourse\u00ad . resultwillonlyholdiftheshedulingphaseusesthe=?re\u00adlationwhihguaranteesthatthebindingonwhihthemain \nthreadisblokedremainsative,asdisussedinSetion9. ThedenotationalsemantisofourlanguageisgiveninFig\u00adure9.TheValdomainisassumedtoontainaliftedversion \nofitsownfuntionspae.Theliftinginjetionisliftandthe orrespondingprojetionisdrop. pEEnv=VaroVal [ Ax.e] \n=liftAE.[ e] pp[> cl [ ex] p =drop([[e] p)([[x] p) [ x] p =p(x) [ let{x; =e;;ine] =[[e] j ;'lpl l....>C. \n>C ] p .if[ el] =. p [ elseqe2] p = [ e2] otherwise p [ xpare] p =[[e] p Figure9:Denotationalsemantis \nThesemantifuntion: [ ...]]:ExpoEnvoVal naturallyextendstooperateonheaps,theoperationaloun\u00adterpartofenvironments: \n{ ...:HeapoEnvoEnv Thereursivenatureofheapsisrefetedbyareursively defnedenvironment: { xloel...x;oe;p= \n' lp.p[xlo...x [ el] p.;o[ e;] p.] Wealsorequireanorderingonenvironments:ifp:p ' then p ' maybindmorevariablesthanpbuttheyareotherwise \nequal.Thatis: ' Vx.p(x)=.?p(x)=p(x) Thearidenvironmentpotakesallvariablesto.. ' Soundness.Ouromputationalrelation=?an \nbeonsideredsoundwithrespettothethedenotational semantisinFigure9ifthedenotationsofallthebindings ' inareunhangedin.The:orderingonenvironments \nneatlyapturesthisnotion. PROpOSITION12.1.If=? ' thenforallp,{ p: ' { p. PROOF.Byindutiononthesizeofandonthestru\u00adtureofexpressions. \nAdequay.Wewishtoharaterisetheterminationprop\u00adertiesofoursemantisandPropositions12.2and12.3show anagreementwiththedenotationaldefnition.Theproofs \naremodelledontheorrespondingonesin[21]. 4I ' ?* [ ej] jH] p =.. PROpOSITION12.2.If(,Zoe)=(,Zov)then PROOF.Forallvaluesv,[=.sobyProp.12.1 \n[v] j H.] p [ e] j H] p =.. PROpOSITION12.3.If[ ej] jH] p =.,thereexists ' ,Z,v 4I ?* suhthat(,Zoe)=( \n' ,Zov). AproofofProposition12.3isoutlinedinaappendix.It isloselybasedontheorrespondingproofin[21],working \nwithavariantofthedenotationalsemantiswhihisexpliit aboutfniteapproximations. Determinay.Wenowturntothequestionofobtaining \nthesameresultirrespetiveofthenumberofproessorsand irrespetiveofwhihrunnablethreadsarehosenfora\u00adtivationduringtheomputation.Clearly,sinetheresults \naboveholdforanynumberofproessorsitfollowsthatifan evaluationwith.proessorsgivesmainavaluethen,de\u00adpendingonwhihthreadsareativated,anevaluationwith \n.proessorsangivethesameresultinthesenseofPropo\u00adsition12.1. WithoutthesideonditiondisussedinSetion9thatisthe \nbestthatanbeexpeted otherwiseingeneralitispos\u00adsibleformaintoremainblokedindefnitely.Withtheside ondition,wewanttodemonstratethatifanyevaluation \ngivesananswerformainthentheyalldo,irrespetiveofthe numberofproessors.Forthe1-proessorase,itislear . thatthedefnitionof=?inSetion9ensuresthatthere \nisalwaysexatlyoneativebindingandthatthebloked bindingsformahainfrommaintothatativebinding. Thefollowingpropositiondemonstratesthatallthelosures \nativatedintheoneproessorasewillalsobeativatedin themulti-proessorase.Reallthat=?istheomputation . relationassumingamaximumof.proessors. \nPROpOSITION12.4.Given.?1proessors,suppose 4 (,mainoe)=?l=?2...and ll 4 (,mainoe)=?l=?2... .. Ifxisativeinsome;thenthereisajsuhthatxis \nativeinj. . PROOF.SupposeZkisativeinsome;.By=?there BBB4 Zl Z2 Z3 isahainmainoe,Zloe,Z2oe,...Zkoein;. \nByindutiononthelengthkofthishainweanshowthat theremustbesomejwhereZkisativeinj. Finallyweanbringalltheseresultstobeartoprovethat \nevaluationisdeterministiinthesensethatwegetthesame answereverytime,foranynumberofproessors,assuming . \nthe=?ativationrelation. COROLLARY12.5.Foranynumberofproessors.?1,theapprule: I *' =?( if(,main e) ,mainv)and \noo 4 IQ ' l (,xov):Zoe-o(,Z ) o e (appl) ?l=? (,mainoe)then: = 4 IQ 2 ... ' (,xov):Zoex-o(,Zx) o e .. \nR 4 I ' ' 4 o (,xoe2):Zoelx-o(xoe2,Z x)(app2) I el 1.thereissomei?1suhthat(;,mainov); = ; RAB 4Q ' (,xoe2):Zoel \n-o(,Z l) o e ' .[ v] j K.=[[v] j H. .] po ] po (app ) RAB 4Q ' (,xoe2):Zoelx-o(,Zx) o e l PROOF.1.Ifthereisnosuhthenmainmustre-Thusifxisaninative,unevaluatedlosurethenitismade \n ; mainativeorblokedforever.Ineitherasethere runnable 4 (app2).Otherwisetheevaluationproeedsina mustbesomebindingZoethatremainsativeand \ndoesnotterminate.Inthatasethedenotationofe intheontextoftheorrespondingheapmustbe. byProp.12.3.ButbyProp.12.4atsomestageinthe \n1-proessorevaluationZwillbeativeandmainwill be(transitively)blokedonZ.ByProp.12.2ewillnot reahawhnfsomainwillremainbloked.(Unless \nmain=Zinwhihasetheresultfollowsimmedi\u00adately.) fashionentirelyanalogoustoFigure1. 13.3 Non-deterministic \nchoice Sofarwehaveonentratedonlanguagesthataredetermin\u00adistiinthesensethatthefnalresultwillalwaysbethesame \n(Corollary12.5)butourframeworkanalsodesribenon\u00addeterministihoieoperatorssuhasMCarthy'samb[23, 25].Ingeneralterms,toevaluateelambe2,evaluateeland \ne2inparallelandaeptthefrsttoterminateastheresult. Theonlyrealompliationforoursemantisisthatifel 4I ' \n{ {{ 2. main ,mainovpobyProp.12.1, oepo: , terminateswewishtodeativatee2andallthethreadsthat soinpartiular[ \nv] =[[e] . j H.] po j H] po ithasspawned(andvieversaif e2 terminatesfrst).The ' approahwetakeistomodifytheunblokingomponent \nSimilarly,[[v] j K.] po =[[e] j H] po . . oftheshedulingrelation.Firstwegivethesingle-thread transitionforamb: \n13. OTHER EVALUATION STRATEGIES 4 o semantisofapartiularparallellanguage,GpH,whihis Q.4. thefousofourbroaderurrentresearhprogram.However, \n(xoel,Yoe2,Z Q4 Sofarwehaveonentratedonadetailedtreatmentofthe ( Y ):Z ambY oo-o xele2x,, B ambY)(amb) \no x ourentralframeworkofaheapofbindingslabelledwithan indiationoftheirativitystatusismuhmoregeneralthan \nthat,allowingustodesribevariousothermodelsofparallel evaluation.Thereisinsu\u00c6ientspaeforafulltreatment \nherebutwehopetogiveenoughinformationthatthereader ouldfllinthedetails. 13.1 Sequential evaluation Ourfrstexampleisnotparallelatallbutsimplysequential \nlazyevaluation.Thisanbeahievedbyjustrestritingthe omputationrelationtotheaseofasingleproessor=? l where \n'RifC=I C= Cotherwise ' ,isdefnedsimilarly.Efetively,ZbloksandxandY beomerunnableunlesstheyarealreadyrunnable,ative \norbloked. Nowunblokinganambexpressionisspeialbeausewe wanttokilltheotherarm: butanumberofsimplifationsbeomepossible.FirstthereRA \n(,xov,Z isnoneedforthenotionofrunnablebindingsbeausethere B x ambY) -oo isalwaysexatlyoneativebinding:req(main,).Inthat \nRA ((killY),xov,Z B x)(unblokamb) o aseweaneliminatetheshedulingrelationaltogetherby havingthebloklrulediretlyativatetheinativebinding: \nRA ThereisasymmetrialruleforYov.ThekillYfuntion searhesoutallthreadsspawnedbyYandmakesthemina\u00ad (blok \n' l) I 44 B ( ,xe ):Z(Z e) o ox-o ox,xo tive.Wedonotgiveadefnitionherebutsimplynotethat ithassimilaritiestothefuntionreqdefnedinSetion9,inOfoursethereisalsononeedfortheparallelrule.Full \ndetailsaregivenin[5].Whilethereareothersmall-step semantisforlazyevaluation(e.g.[25])thisonemaybeof interestforthefatthatitdiretlyrepresentsthepassingof \nontrolbetweenlosuresastheyareevaluated. 13.2 Fully speculative evaluation Fullyspeulativeevaluationisaompletelyimpliitapproah \nwhereeveryappliationele2introduesparallelismbypro\u00adeedingtoevaluatebothelande2together[15].Thisan easilybeexpressedinourframeworkbyamodifationto \nthatitfollowshainsofblokedbindings. Thereisaslightompliationhowever:itwouldbeinorret tomakesuhabindinginativeintheasewhereanother, \npossiblymandatory,threadisalsoblokedonthesamebind\u00ading.Thereisalreadysu\u00c6ientstrutureandinformationin theheaptoorretlydefnekillbutitismuheasierifwe \nalsoreordatleastthenumberofthreadsblokedoneah binding(f.[4]wherewemaintainexpliitblokingqueues). Thenkillanhekthattherearenoothersblokingonthe \nbindingbeforemakingitinative. 13.4 Controlled speculative evaluation AsmentionedinSetion9,GpHdoesnotprovidemuhsup\u00adportforspeulativeevaluation.Hereweskethanextension \ntothelanguagetoputsomeontrolofspeulativeevaluation inthehandsoftheprogrammer. Theideaistohaveasyntativariantofpar,sayspar \nwiththesamedenotationalsemantisasparbuttherun\u00adtimesystem(i.e.ourshedulerelation)istogivepriorityto non-speulativebindings(reatedbypar)overspeulative \nbindings(reatedbyspar).Weanahievethisbyhaving anotherlabelonbindings:SpeulativeorNon-speulative (ontratedtoSandN)aswellastheativitylabels.There \nisnotspaeforallthedetailsherebuttheS,Nlabelsare introduedbysparandparrespetively.Forexample: I4 4R (,xoel):Zoxspare2 \n-o(Zoe2,xoel)(spar) ( (S whereaiseitherSorN.Thespeulationlabelsarepassed onwhenblokingoursbutwithNtakingpriorityoverS \ninlashingases. Duringativation,ifthereareinsu\u00c6ientproessorstoati\u00advateallrunnablebindings,enoughspeulativeativebind\u00adingsshouldbedemotedtorunnabletoallowasmanyas \npossiblenon-speulative,runnablethreadstobepromoted toative.Thedetailsarenotpartiularlydi\u00c6ult. Anaturalgeneralisationofthisnotionistoassoiateapri\u00adoritywitheahthreadreatedbyparandthesheduler \nseletswhihthreadstoativate,basedonthisvalue[22]. Theframeworkoutlinedhereanbemodifedtohandlethis approahbyreplaingtheSandNlabelswithanumeri \npriorityindiator. 14. METRICS OF PARALLELISM Oneofthehiefmotivatingfatorsfordevelopingourse\u00admantiswastoprovideameansforformallyomparingpro\u00adgramsintermsoftimeandparallelism.Itturnsouttobe \nstraightforwardtodefneommonmetrisforparallelism: workdone,e\u00c6ienyandspeedup(see[12]forthestandard defnitions)intermsofaredutionsequene.Howrealisti \nistheoperationalsemantisomparedwitharealompiler? Obviouslyoursemantisisfarremovedfromarealompiler, thatwillhaveahighlyoptimisedredutionengineandwe \nshouldnotexpetredutionsinthesemantistoompare preiselywithompiledode.Wedobelieve,however,that ourlevelofabstrationissuhthatweandrawonlu\u00adsionsaboutparallelismandmakereasonableomparisons \naboutrun-time.Infat,proflingsimulatorssuhasHBC\u00adPP[32]arebasedonountingsimilarredutionstothosein oursemantisandhaveproventogiveusefulperformane \nmeasurements. DEFINITION14.1(WORKANDRUN-TIME).Givenare\u00addutionsequeneo =?l=? =?t.foratermi\u00adnatingprogramwith.proessors,thetotalworkdonewith \nrespetto.proessorsisthetotalnumberofsinglethread transitions: t.  W(.)= ;4 ;'o Run-timeissimplygivenby: \nR(.)=t . DEFINITION14.2(AVERAGEpARALLELISM).Foranun\u00adboundednumberofproessors,theaverageparallelismis: \nW(o) Averageparallelism= R(o) Inpratieadefnitionparameterisedonthenumberofpro\u00adessorsanbemoreuseful: W(.)P(.)= \nt. DEFINITION14.3(MAXIMUMpARALLELISM).Givenan unboundednumberofproessors,themaximumparallelism isthemaximumnumberofativeproessorsduringevalua\u00adtion: \n 4 t. Maximumparallelism=max{ ; ;'o Oragainweantakeaountofthenumberofproessors: 4 t. M(.)=max{ ; ;'o \nFortheexampleinSetion11withtwoormoreproessors theworkdoneis10andtherun-timeis7givinganaverage parallelismof1..Usingthesameexamplewith1proessor \ntherun-timeinreasesto10,sousingextraproessorsan improvetheprogram'srun-time. 15. RELATED WORK Therehavebeenavarietyofsemantidesriptionsforall\u00adby-needandall-by-name,forexample[28,20,1,31,29,3, \n3,21,25].Thisontrastswitharelativesarityofsemanti desriptionsofparallelmodels.ParallelsemantisoftheA\u00adalulushavebeenexploredwithdenotationalsemantis; \nforexampleRoe[31]defnesadenotationalsemantissuh thatoperationalostsofparallelomputationsanbegiven. GreinerandBlelloh[15,14]developRoe'sideasfurther \ninasemantisthatdesribesafully-speulativeredution modelfortheA-alulus.Allofthesesemantisareusefulfor reasoningaboutdiferentredutionmodelsoftheA-alulus \nbutnonemodelarealparallelfuntionallanguage.Aunique featureofoursemantisisthatitmodelsthebehaviourof threadsduringaparallelredutionsequeneofarealparallel \nfuntionallanguage,namelyGpH. Otherparalleloronurrentfuntionallanguagesthathave adefnedsemantisinludeNESL[8],Eden[10],pH[2], \nConurrentML[30,6],Go\u00c6n[11]andSheme[27].Allof theselanguagesarebasedontheA-alulusbutinludea diferentsetoflanguagefeaturestoGpH.EdenandCon\u00adurrentMLhaveexpliitonstrutsforonurreny.NESL \nprovidesparallelismimpliitlybyimplementingseverallan\u00adguageprimitivesusingnesteddata-parallelism.pHhassyn\u00adhronisation,barriersandside-efets,allofwhihrequire \nspeialareinanoperationalsemantis.Go\u00c6nisbuilt onHaskellbyaddingonurrentonstraintombinatorsto expressoordination.TheformofparallelisminGpHis \nmostlyimpliit,whihmakesiteasierfortheusertowrite parallelprogramsthanmoreexpliitlanguages.GpHis moreexpressivethanpurelyimpliitlanguageslikeNESL, \nbeauseinGpHontrolparallelismaswellasdataparal\u00adlelismanbeexpressed.Thereisnoonsensusonthebest wayofintroduingparallelismtofuntionalprogramming \nlanguagesbutthemodeldesribedinthispaperisusedby apopularHaskellompiler(GHC)and,aswehavedemon\u00adstrated,ourframeworkextendstootherparallelevaluation \nstrategies.Infat,anewoperationalsemantisforEden [19]isbasedonoursemantiframework. 16. FURTHER WORK Therearemanyavenuestodevelopthiswork,beyondthe \nonsiderationofothermodelsofparallelismthatwesur-veyedinSetion13. 16.1 Extending the semantics Addingase,onstrutorsandprimitivesissimpleandleft \noutofthispaperbeausetheyarenotrelevanttothedis\u00adussionofparallelism.Therearethreemainextensionsto thesemantisthatweareurrentlyonsidering:modelling \nspae,ommuniationandasynhronousredution. Spae.Currentlywehaveasimplemodelthatessentially usesamonolithiheapforallthestoragespae.Thisdoes \nnotorrelateverywellwithtypialparallelompilersthat distributedataarossproessors.Forinstane,GpHusesa separateheaponeahproessorandommuniatesthreads \nbetweenheaps.Othershaveworkedonmodellingspaee\u00c6\u00adientlyinludingBlumofeandLeiserson[9]andBlellohet al.[7]. \nCommuniation.Anotherdesirableextensionistomodel ommuniation,whihagainrequiresamoredetailedtreat\u00admentofheapspae,sinetheesseneofommuniationisto \ntransferbindingsbetweenheapsondiferentproessors.The semantisurrentlyallowsustoreasonaboutfourthread states(ative,inative,runnableandbloked)butwewould \nalsoliketoreasonaboutotherthreadstatessuhasfeth\u00ading,whihistheommuniationstate.Thisisimportant formodellingthebehaviourofaprogramonarealparallel \narhiteturewhoseproessortopologymayhaveanimpat onaprogram'srun-time.Wehaveonsideredonstrut\u00adingmodelswhereommuniationlateniesaremodelledby \nusing'loks'(ounters)onomputesteps. Asynhronousredution.Wewouldliketoextendour semantistomodeltheasynhronousredutionthatisar\u00adriedoutbytheGpHrun-timesystem.Thelokingmeha\u00adnismmentionedaboveformodellingommuniationseems \ntoprovideasimplemehanismformodellingasynhronous behaviourwithoutadverselyafetingthesimpliityofthe presentsemantis. \n16.2 Reasoning about parallel coordination Funtionallanguagesarepromotedasforbeinggoodfor equationalreasoning,sothatpropertiesofprogramsareeas\u00adilydemonstratedbyusingfamiliartehniques.Thereisan \nabundaneofworkonequationalreasoningaboutompu\u00adtationbutverylittleonequationalreasoningforparallel oordinationandomputation,perhapsbeauseitismuh \nmoredi\u00c6ulttoreasonaboutparallelprograms.InSetion 14wedesribedhowprogramsanbeomparedintermsof timeandparallelism.Thisanbeusedtodevelopafam\u00adilyofequivalenesandostorderingsthathaveaknown \nbehaviour,shownformallyusingthesemantis.Forexam\u00adple,thefollowingtwoexpressionsareequivalentintermsof \nresoureusage: xseq(YparZ)(xseqY)par(xseqZ). Whilewehaveusedthesemantistodemonstratesomesim\u00adpleresults,muhworkremainstodevelopafamilyofax\u00adiomsforparandseqaswellashigher-orderombinators. \nReentworkbySands,MoranandGustavsson[24,16]on operationaltehniquesforall-by-needseemstoholdsome promise. \n16.3 Abstract machines Workisinprogress,usingthissemantisfordevelopingan abstratmahineforlazyparallelgraphredution[4]just \nasSestoft[33]didforLaunhbury'ssequentialall-by-need semantisandMoreaudidforShemewithfutures[26].We havealsowritteninterpretersforoursemantis[5]thatallow \nustoanalysethebehaviourofanexpressionautomatially. Theabstratmahineallowsustostudymoreloselythebe\u00adhaviourofarealompilerandlow-levelfeaturessuhasthe \nmanagementofblokingqueues[15]andgarbage-olletion [36].Itshouldalsobepossibletousethesemantisatthis leveltoformallyjustifythebehaviourofparallelsimulators \nsuhasHBC-PP[32]andGRANSIM[22]. 17. CONCLUSION Wehavedevelopedanoperationalsemantisforparallellazy evaluationthatmodelsthelanguageGpH.Thesemantis \nusesthemehanismofaheapofbindingslabelledwithan indiationoftheirativitystatus,tomodelsharingandpar\u00adallelthreadbehaviour.Theresultissimplerthanmany \notherattemptsataparallelsemantis.Wewerealsoable toshowtheorretnessofoursemantiswithrespetto standardsequentialall-by-needsemantis. \nThetehniquesdevelopedherearesu\u00c6ientlypowerfuland fexibletodesribeawidevarietyofapproahestoparallel evaluation,aswedemonstratedwithfully-speulativeevalu\u00adation,non-deterministihoieandprogrammer-ontrolled \nspeulation.Thefexibilityarriesovertoalassofparallel lazyabstratmahineswehavederivedfromoursemanti framework. \nDevelopingthesemantishasbeensuessfulinunovering subtletiesintherealimplementation.Itisfareasierto reasonaboutbehaviourssuhasprioritisingmainthread \nbindings,blakholes,unblokingtehniquesandsoon,at thislevelofabstrationratherthaninarealompiler. Acknowledgments \nWewouldliketothankJonHallforhisontributionsinthe earlystagesofthisprojet.Wehavealsobeneftedfrom disussionswithDaveSands. \n 18. REFERENCES [1]S.Abramsky.Thelazylambdaalulus.InResearh TopisinFuntionalProgramming,pages65.117. \nAddisonWesley,1990. [2]S.Aditya,Arvind,L.Augustsson,J.-W.Maessen,and R.S.Nikhil.SemantisofpH:Aparalleldialetof \nHaskell.InProeedingsoftheHaskellWorkshop,pages 35.49,LaJolla,California,1995. [3]Z.Ariola,M.Felleisen,J.Maraist,M.Odersky,and \nP.Wadler.Aall-by-needlambdaalulus.InThe ndSymposiumonPriniplesofProgramming Languages(POPL'95),pages233.246,SanFraniso, \nCalifornia,1995. [4]C.Baker-Finh.Anabstratmahineforparallellazy evaluation.InTrendsinFuntionalProgramming, \nhapter17.Intellet,2000. [5]C.Baker-Finh,D.J.King,J.G.Hall,and P.Trinder.Anoperationalsemantisforparallel \nall-by-need.TehnialReportNo.99/1,Department ofComputing,TheOpenUniversity,MiltonKeynes, 1999. [6]D.Berry,R.Milner,andD.N.Turner.Asemantis \nforMLonurrenyprimitives.InThe19th SymposiumonPriniplesofProgrammingLanguages (POPL'9 ),pages119.129,1992. \n[7]G.E.Blelloh,P.B.Gibbons,Y.Matias,andG.J. Narlikar.Spae-e\u00c6ientshedulingofparallelismwith synhronizationvariables.InProeedingsof9thACM \nSymposiumonParallelAlgorithmsandArhitetures (SPAA'97),pages12.23,Newport,RI,1997. [8]G.E.BlellohandJ.Greiner.Aprovabletimeand \nspaee\u00c6ientimplementationofNESL.In InternationalConfereneonFuntionalProgramming (ICFP'96),pages213.225,1996. \n[9]R.D.BlumofeandC.E.Leiserson.Spae-e\u00c6ient shedulingofmultithreadedomputations.SIAM JournalofComputing,27(1):202.229,1998. \n [10]S.Breitinger,R.Loogen,Y.Ortega-Malleen,and R.PiEden:LanguageDefnitionandOperational ena. Semantis.FahbereihMathematikundInformatik, \nPhilippsUniversitaatMarburg,1998.TehnialReport 96-10. [11]M.Chakravarty,Y.Guo,M.Kaohler,andH.Lok. Go\u00c6n:Higher-orderfuntionsmeetonurrent \nonstraints.SieneofComputerProgramming, 30(1.2):157.199,1998. [12]D.L.Eager,J.Zahorhan,andE.D.Lazowska. \nSpeedupversuse\u00c6ienyinparallelsystems.IEEE TransationsonComputers,38(3):408.423,1989. [13]C.FlanaganandM.Felleisen.Thesemantisoffuture \nanditsuseinprogramoptimization.InThend SymposiumonPriniplesofProgrammingLanguages (POPL'95),pages209.220,SanFraniso,California, \n1995. [14]J.Greiner.Semantis-basedparallelostmodelsand theiruseinprovablye\u00c6ientimplementations.PhD thesis,ShoolofComputerSiene,CarnegieMellon \nUniversity,Pittsburgh,1997. [15]J.GreinerandG.E.Blelloh.Aprovably time-e\u00c6ientparallelimplementationoffull \nspeulation.ACMTransationsonProgramming LanguagesandSystems,21(2):240.285,1999. [16]J.GustavssonandD.Sands.Afoundationfor \nspae-safetransformationsofall-by-needprograms. InTheThirdInternationalWorkshoponHigherOrder OperationalTehniquesinSemantis,volume26of \nEletroniNotesinTheoretialComputerSiene. Elsevier,1999. [17]J.G.Hall,C.Baker-Finh,P.Trinder,andD.J. King.Towardsanoperationalsemantisforaparallel \nnon-stritfuntionallanguage.InProeedingsofthe InternationalWorkshopontheImplementationof FuntionalLanguages(IFL'9S),LNCS1595,pages \n55.72,London,1998. [18]M.Hennessy.TheSemantisofProgramming Languages.Wiley,1990. [19]M.Hidalgo-HerreroandY.Ortega-Malleen.A \ndistributedoperationalsemantisforaparallel funtionallanguage.SubmittedtoSottishFuntional ProgrammingWorkshop,St.Andrews,2000. \n[20]M.B.Josephs.Thesemantisoflazyfuntional languages.TheoretialComputerSiene,68:105.111, 1989. [21]J.Launhbury.Anaturalsemantisforlazy \nevaluation.InThe0thSymposiumonPriniplesof ProgrammingLanguages(POPL'93),pages144.154, Charleston,SouthCarolina,1993. \n[22]H.-W.Loidl.GranularityinLarge-SaleParallel FuntionalProgramming.PhDthesis,Departmentof ComputingSiene,UniversityofGlasgow,1998. \n[23]J.MCarthy.Abasisforamathematialtheoryof omputation.InPro.WesternJointComputer Conferene,pages225.238,1961. \n[24]A.MoranandD.Sands.Improvementinalazy ontext:Anoperationaltheoryforall-by-need.In The6thSymposiumonPriniplesofProgramming \nLanguages(POPL'99),pages45.56,SanAntonio, Texas,1999. [25]A.K.Moran.Call-by-name,Call-by-need,and MCarthy'sAmb.PhDthesis,ComputingSiene \nDepartment,ChalmersUniversity,1998. [26]L.Moreau.ThePCKS-mahine:anabstratmahine forsoundevaluationofparallelfuntionalprograms \nwithfrst-lassontinuations.InEuropeanSymposium onProgramming(ESOP'94),LNCS788,pages 424.438,Edinburgh,1994. \n[27]L.Moreau.ThesemantisofShemewithfuture.In InternationalConfereneonFuntionalProgramming (ICFP'96),pages146.156,1996. \n[28]G.D.Plotkin.Call-by-name,all-by-valueandthe A-alulus.TheoretialComputerSiene, 1(2):125.159,1975. \n[29]S.PurushothamanandJ.Seaman.Anadequate operationalsemantisofsharinginlazyevaluation.In The4thEuropeanSymposiumonProgramming \n(ESOP'9 ),LNCS582,pages435.450,Rennes,1992. [30]J.H.Reppy.Anoperationalsemantisoffrst-lass synhronousoperations.Tehnialreport,Department \nofComputerSiene,CornellUniversity,1991. [31]P.Roe.Parallelprogrammingusingfuntional languages.PhDthesis,DepartmentofComputing \nSiene,UniversityofGlasgow,Glasgow,Sotland, 1991. [32]C.RunimanandD.Wakeling.Proflingparallel funtionalomputations(withoutparallelmahines). \nInProeedingsofthe1993GlasgowWorkshopon FuntionalProgramming,pages236.251,Ayr, Sotland,1994. [33]P.Sestoft.Derivingalazyabstratmahine.Journal \nofFuntionalProgramming,7(3):231.264,1997. [34]P.Trinder,K.Hammond,H.-W.Loidl,andS.Peyton Jones.Algorithm+Strategy=Parallelism.Journal \nofFuntionalProgramming,8(1):23.60,1998. [35]P.Trinder,K.Hammond,J.Mattson,A.Partridge, andS.PeytonJones.GUM:Aportable \nimplementationofHaskell.InProeedingsof ProgrammingLanguageDesignandImplementation (PLDI'96),pages79.88,Philadelphia,USA,1996. \n[36]C.Walton.Anabstratmahineformemory management.InTrendsinFuntionalProgramming, hapter10.Intellet,2000. \n  APPENDIX Thisappendixpresentsamoredetailedoutlineofourproof ofProposition12.3.ItisderiveddiretlyfromLaunhbury's \norrespondingproof[21]. Webeginwithavariantofthedenotationalsemantisas showninFigure10,thatallowsustoexpliitlydealwith \nfniteapproximations.Thenewsemantifuntiontakesan extraargumentrepresentinga'resoure'.Thedomainof resouresistheleastsolutionofC=C-andwewritethe \nliftinginjetionasSsotheelementsofCare.,S.,SS.... withlimitelementw. ThesemantifuntionNtakesaresoureasanextraar\u00adgumentandenvironmentsa:VaroCoValnowbind \nvariablestofuntionswhihtakearesoureandreturna value. TheoriginalsemantisisequivalenttoN,assumingunlim\u00aditedresoures: \nIfVx.px=axwthen[ e] p =N[ e] (w BytheontinuityofN,wehavethefollowinglemma: LEMMA.1.If[ e] p =.thenthereisanaturalnumberm \nsuhthatN[ e] ((Smk)=.whereVx.px=axw. N[ e] .=. ( N[ Ax.e] (Sk)=liftAT.N[ e] (([>Tl N[ ex] ((Sk)=drop(N[ \ne] (k)(N[ x] (k) N[ x] ((Sk)=axk N[ let{x; =e;;ine] (Sk)=N[ e] k ;'l(I(..([.>N[ C.l ..l. .=l .ifN[ el] \n(k=. N[ elseqe2] ((Sk)= N[ e2] (kotherwise N[ xpare] ( =N[ e] ( Figure10:Resoureddenotationalsemantis \nTheoreresultrelatingtheresouredsemantistoourop\u00aderationalisthefollowing: LEMMA.2.If: m N[ e] (S.)=. I(. \n.el>N[ Cll ..,....>N[ C.l ..) thenthereisavaluev,avariableZandaheapwhere: ' la.(xloN[ el] (.,...x;oN[ \ne;] (.):{{po suhthat: II4 4 ? * (xloel,...x;oe;,Zoe)=(,Zov) PROOF.Byindutiononm.Asanexampleofhowthe proofgoes,onsidertheasee=x;. \nLeta=la ' .(xloN[ el] (.,...x;oN[ e;] (.). IfN[ x;] ((Sk)=.thenN[ e;] (k=..Bytheindutive hypothesiswehave: \nI4II (xloel,...x;oe;,...x;oe;,Zox;) I4 ? * =(,Zox;,x;ov) Usingthisfat,weanonstrutthefollowingrelationby \napplyingrulesbloklandvar: III4 (xloel,...x;oe;,...x;oe;,Zox;) I4IB =?(xloel,...x;oe;,...x;oe;,Zox;) B4 \n? * =(,Zox;,x;ov) '4 =?(,Zov ) Finally,theproofofProposition12.3isasfollows: PROOF.ByLemma.1,if[ e] =.,there \nj l>Cl....>C.] po isanmsuhthatN[ e] (Smk)=.. I(. .e.=l .>N[ C.l ..). Thusbylemma.2wehave: 4I ? * (xloel...x;oe;,Zoe)=(,Zov) \nasrequired. \n\t\t\t", "proc_id": "351240", "abstract": "We present an operational semantics for <i>parallel lazy evaluation</i> that accurately models the parallel behaviour of the non-strict parallel functional language GpH. Parallelism is modelled synchronously, that is, single reductions are carried out separately then combined before proceeding to the next set of reductions. Consequently the semantics has two levels, with transition rules for individual threads at one level and combining rules at the other. Each parallel thread is modelled by a binding labelled with an indication of its activity status. To the best of our knowledge this is the first semantics that models such thread states. A set of labelled bindings corresponds to a heap and is used to model sharing.The semantics is set at a higher level of abstraction than an abstract machine and is therefore more manageable for proofs about programs rather than implementations. At the same time, it is sufficiently low level to allow us to reason about programs in terms of <i>parallelism</i> (i.e. the number of processors used) as well as <i>work</i> and <i>run-time</i> with different numbers of processors.The framework used by the semantics is sufficiently flexible and general that it can easily be adapted to express other evaluation models such as sequential call-by-need, speculative evaluation, non-deterministic choice and others.", "authors": [{"name": "Clem Baker-Finch", "author_profile_id": "81100012945", "affiliation": "University of Canberra, ACT, Australia", "person_id": "P49298", "email_address": "", "orcid_id": ""}, {"name": "David J. King", "author_profile_id": "81100194254", "affiliation": "Motorola Labs, Basingstoke, England", "person_id": "PP14077306", "email_address": "", "orcid_id": ""}, {"name": "Phil Trinder", "author_profile_id": "81100457538", "affiliation": "Heriot-Watt University, Edinburgh, Scotland", "person_id": "PP39068387", "email_address": "", "orcid_id": ""}], "doi_number": "10.1145/351240.351256", "year": "2000", "article_id": "351256", "conference": "ICFP", "title": "An operational semantics for parallel lazy evaluation", "url": "http://dl.acm.org/citation.cfm?id=351256"}