bisimulation for quantum processes centre for quantum computation and systems university of technology state key laboratory of technology and systems department of computer science and technology university centre for quantum computation and systems university of technology state key laboratory of technology and systems department of computer science and technology university abstract quantum cryptographic systems have been available with a advantage over classical systems that their security and ability to detect the presence of are provable based on the principles of quantum on the other hand quantum protocol designers may commit much more than classical protocol designers since human intuition is much better adapted to the classical world than the quantum world to offer formal techniques for modeling and verification of quantum protocols several quantum extensions of process algebra have been proposed one of the most serious issues in quantum process algebra is to discover a quantum generalization of the notion of bisimulation which lies in a central position in process algebra preserved by parallel composition in the presence of quantum which has no counterpart in classical computation quite a few versions of bisimulation have been defined for quantum processes in the literature but in the best case they are only proved to be preserved by parallel composition of purely quantum processes where no classical communications are involved many quantum cryptographic protocols however employ the local operations and classical communications scheme where classical communications must be explicitly specified so a notion of bisimulation preserved by parallel composition in the of both classical and quantum communications is crucial for process algebra approach to verification of quantum cryptographic protocols in this paper we introduce a novel notion of bisimulation for quantum processes and prove that it is congruent with respect to various process algebra combinators including parallel composition even when both classical and quantum communications are present we also establish some basic algebraic laws for this bisimulation in particular we prove uniqueness of the solutions to recursive equations of quantum processes which provides partially supported by arc grant dp national natural science foundation of grant and grant permission to make digital or hard copies of all or part of this work for personal or classroom use is granted without fee provided that copies are not made or distributed for profit or commercial advantage and that copies bear this notice and the full citation on the first page to copy otherwise to republish to post on servers or to redistribute to lists requires prior specific permission andor a fee popl january Г austin texas usa copyright c acm a powerful proof technique for verifying complex quantum protocols categories and subject descriptors d programming languages formal definitions and theory f logics and meanings of programs specifying and verifying and reasoning about programs general terms languages theory verification keywords quantum communication quantum computing quantum process algebra bisimulation congruence introduction quantum computing offers the potential of considerable speedup over classical computing for some important problems such as prime factoring and database search however functional quantum computers which can this potential in dealing with practical applications are extremely difficult to implement on the other hand quantum cryptography of which the security and ability to detect the presence of are provable based on the principles of quantum has been developed so that quantum cryptographic systems are already available by a number of such as id and as is well known it is very difficult to guarantee correctness of classical communication protocols at the design stage and some simple protocols were finally found to have fundamental since human intuition is much worse adapted to the quantum world than the classical world quantum protocol designers may commit much more than classical protocol designers especially when more and more complicated quantum protocols can be implemented by future physical technology with the purpose of the success classical process algebras achieve in analyzing and verifying classical communication protocols and even distributed computing various quantum process algebras have been proposed independently by several research groups and defined a language quantum process algebra by extending a classical process algebra a branching bisimulation which identifies quantum processes associated with graphs having the same branching structure was also presented the bisimulation is however not congruent it is not preserved by parallel composition and defined a language communicating quantum processes which combines the communication primitives of picalculus with primitives for unitary transformations and measurements one feature of is a type system which guarantees the physical realizability of quantum processes however no notion of equivalence between processes was presented authors of the current paper proposed a model named for quantum communicating systems by adding quantum inputoutput and quantum primitives to classical ccs the semantics of quantum input and output was carefully designed to describe the communication of quantum systems which have been with other systems a bisimulation was defined for finite processes and a simplified version of congruence property was proved in which parallel composition is only permitted when the processes are free of quantum input or free of quantum operations and measurement in the same authors studied a purely quantum version of where no classical data is explicitly involved at providing us a suitable framework to observe the interaction of computation and communication in quantum systems a bisimulation was defined for this purely quantum and shown to be fully preserved by parallel composition it is worth noting that however the bisimulation proposed in cannot be directly extended to general where classical data as well as probabilistic behaviors are included in this paper we combine the two models proposed in and together to involve both classical data and quantum data this general model which we still call for coherence all classical process constructors especially recursive definitions as well as quantum primitives as a consequence both sequential and distributed quantum computing quantum communication protocols and quantum cryptographic systems can be formally modeled and analyzed in the framework of we also design a bisimulation for processes in and an equivalence relation based on it which turns out to be a congruence this bisimulation has several features compared with those proposed in the literature it takes local quantum operations into account in a weak manner but at the same time well with recursive definitions bisimulation cannot distinguish different operations on a quantum system which will never be output quantum states are only compared when they are input or output bisimulation defined in works well only for finite processes since quantum states are required to be compared after all the actions have been performed note that no state comparison is needed in since all local quantum operations are regarded as visible actions and the bisimulation is a very strong one Г it distinguishes two different sequences of local operations even when they have the same effect as a whole secondly between the inputoutput system and the remaining systems is fully considered in our definition bisimulation presented in totally ignores this by only considering the reduced state of the inputoutput system in this consideration is implicitly made by the state comparison after the processes terminating again it does not work for infinite processes finally but most importantly the bisimulation presented here is preserved by parallel composition and the equivalence derived by the bisimulation is a congruence making them suitable for equational reasoning in verifying quantum communication and cryptographic systems bisimulation is not preserved by parallel composition the bisimulation in is not preserved by restriction and whether it is preserved by parallel composition still remains open although the positive answer is in two special cases the bisimulation proposed in is indeed a congruence however since no classical data is involved in that model many important quantum communication protocols such as coding and cannot be described this restricts the scope of its application the paper is organized as follows in section we review some basic notions from linear algebra and quantum the syn and operational semantics of are presented in section to illustrate the expressiveness of we describe with it the wellknown quantum coding and protocols we also show how to encode quantum unitary and measurement which are two basic elements of quantum circuits by section defines the notion of bisimulations for configurations as well as quantum processes equivalence relation based on is also defined and proved to be fully preserved by all process constructors of the validity of examples in section is proved by using the notion of bisimilarity defined in this section various properties such as monoid laws static laws the expansion law as well as uniqueness of solutions of process equations are also examined we outline the main results in section and point out some problems for further study for convenience of the reader we briefly recall some basic notions from linear algebra and quantum theory which are needed in this paper for more details we refer to basic linear algebra a space h is a complete vector space equipped with an inner product ии h О h c such that for any h with equality if and only if pp i ii i i i where c is the set of complex numbers and for each c stands for the complex for any vector h its length is defined to be and it is said to be normalized if two vectors and are orthogonal if an basis of a space h is a basis i where each i is normalized and any pair of them are orthogonal let lh be the set of linear operators on h for any a lh a is if a a where a is the adjoint operator of a such that a a for any h the fundamental theorem states that the set of all normalized of a operator in lh contains an basis for h that is there exists a socalled decomposition for each a such that xx a ii i i where the set i constitute an basis of h denotes the set of of a and ei is the to the corresponding of i a linear operator a lh is unitary if aa aa ih where ih is the identity operator on h in this paper we will use some wellknown unitary operators listed as follows the quantum operator performed on two qubits with the matrix representation cn b ac under the computational basis and the qubit operator h and operators defined respectively as Ф Ф h i Ф Ф Ф i i p the trace of a lh is defined as i for some given basis i of h it is worth noting that trace function is actually independent of the basis selected it is also easy to check that trace function is linear and for any operators a b lh let h and h be two spaces their tensor product h h is defined as a vector space consisting of linear com of the vectors with h and h here the tensor product of two vectors is defined by a new vector such that x xx ii j j ij i j i j ij then h h is also a space where the inner product is defined as the following for any h and h h h where ии hi is the inner product of hi for any a lh and a lh a a is defined as a linear operator in lh h such that for each h and h a a a a the partial trace of a p lh h with to h is defined as a i where i is an basis of h similarly we can define the partial trace of a with to h partial trace functions are also independent of the basis selected a linear operator e on lh is completely positive if it maps positive operators in lh to positive operators in lh and for any auxiliary space h the trivially extended operator ih e also maps positive operators in lh h to positive operators in lh h here ih is the identity operator on lh the elegant and powerful representation theorem of completely positive operators states that a linear operator e is completely positive if and only if there are some set of operators ei with appropriate dimension such that x ea i for any a lh the operators ei are called operators of e a linear operator is said to be a if it is completely positive and here an operator e is if for any positive a lh and it is said to be if the equality al ways holds then a resp a super operator is a ei satisfying operators basic quantum according to von formalism of quantum an isolated physical system is associated with a space which is called the state space of the system a pure state of a quantum system is a normalized vector in its state space and a mixed state is represented by a density operator on the state space here a density operator on space h is a positive linear operator such that tr another equivalent representation of density operator is probabilistic of pure in particular given an pi i p where pi i pi and i are pure states then i is a density operator here i denotes the abbreviation of i i conversely each density operator can be generated by an of pure states in this way it is convenient to allow the trace of a density operator to be less than which makes it possible to represent both the actual state by the normalized density operator and the probability with which the state is reached by its trace in a single expression then the set of partial density operators on h can be defined as lh is positive and tr the state space of a composite system for example a quantum system consisting of many qubits is the tensor product of the state spaces of its components for a mixed state on h h partial traces of have explicit physical meanings the density operators and are exactly the reduced quantum states of on the second and the first component system respectively note that in general the state of a composite system cannot be decomposed into tensor product of the reduced states on its component systems a wellknown example is the qubit state which appears repeatedly in our examples of this paper this kind of state is called state to see the of suppose a measurement m is applied on the first qubit of see the following for the definition of quantum measurements then after the measurement the second qubit will definitely into state or depending on whether the outcome or is observed in other words the measurement on the first qubit changes the state of the second qubit in some way this is an feature of quantum which has no counterpart in classical world and is the key to many quantum in formation processing tasks such as and coding the evolution of a closed quantum system is described by a unitary operator on its state space if the states of the system at times t and t are and respectively then u u for some unitary operator u which depends only on t and t in contrast the general dynamics which can occur in a physical system is described by a on its state space note that the unitary transformation u u u is a a quantum measurement is described by a collection mm of measurement operators where the indices m refer to the mm in state then the probability that measurement result m occurs is given by pm mm and the state of the system is pm a particular case of measurement is measurement which is usually represented by a operator let m be a operator and x m mem its decomposition obviously the em m form a quantum measurement if the state of a system is then the probability that result m occurs when m on the system is pm and the state of the system is note that for each outcome m the map em is again a by theorem it is not in general basic definitions of in this section we give the basic definitions of which is a combination of those proposed in and involving classical data as well as quantum data all classical process constructors especially the recursive definition as well as quantum primitives the reader is referred to and for further examples and of the language syntax for simplicity only two types of data are considered in real numbers real for classical data and qubits for quantum data let cv ar ranged over by x y be the set of classical variables and qv ar ranged over by q r the set of quantum variables it is assumed that cv ar and qv ar are both infinite let exp ranged over by e be the set of expressions with the value domain real let be the set of classical channel names ranged over by c d and the set of quantum channel names ranged over by c d let chan a function f is a one to one function from chan to chan such that f and f we often abbreviate the indexed set q qn to qe when q qn are distinct quantum variables and the dimension n is understood sometimes we also use qe to denote the string q qn we assume a set of process constant schemes ranged over by a b assigned to each process constant scheme a there is a nonnegative integer if qe is a tuple of distinct quantum variables with qe then is called a process constant based on these notations we now propose the syntax of as follows definition quantum process the set of quantum processes qp and the free quantum variable function qv qp qv ar are defined inductively by the following formation rules nil qp and qp and qe p qp and qp and qp and qp and q if q then qp and q qp and qe m qe xp qp and qe xp qe p q qp and q if then p q qp and q p f qp and f p l qp and l if b then p qp and b then p where p q qp c x cv ar c q qv ar qe qv ar e exp is the action is a process constant f is a function l chan b is a expression e and m are respectively a and a operator applying on the space associated with the systems qe furthermore for each process constant there is a defining equation def p where p qp with qe when qe we simply denote as a the notion of free classical variables in quantum processes can be defined in the usual way with a unique modification that quantum measurement m qe x has binding power on x a quantum process p is closed if it contains no free classical variables ie f vp operational semantics to present the operational semantics of some further notations are necessary for each quantum variable q qv ar we assume a dimensional space to be the state space of the for any s qv ar we denote o hs qs in particular h ar is the state space of the whole environment consisting of all the quantum variables note that h is a space suppose p is a closed quantum process a pair of the form p is called a configuration where is a density operator on h the set of configurations is denoted by con we sometimes let c d range over con to ease notations let be the set of probability distributions over con that is con c for finitely x many c and c c for any we denote by the support set of ie the set of configurations c such that c when is a simple distribution such that c for some c we the notation slightly to denote by c sometimes we find it convenient to denote a distribution by an explicit form ii pi и ci or pi и ci when the index set i is understood where ci are distinct configurations ci i i and ci pi for each i i p given n and p pn we define the combined distribution by p n i i pi to be a new distribution such i and for any d d i it is worth out the difference between the two notations ii pi и ci and ii the former is the explicit form of a distribution so it is required that pi for each i i and ci cj for i j while the latter is a combined distribution of the simple distributions ci with the probability weights pi so pi may be zero for some i i and ci are not necessarily distinct let ii pi и pi i denote by qv the free of that is qv ii we write tr ii and e ii pi и pi ei when e is a let act cv cv c v real cr cr c r qv ar for each act we define the bound quantum variable bv of as r and bv if is not a quantum input the channel name used in action is denoted by cn that is c c and cn the semantics of is given by the probabilistic labeled transition system con act where con О act О is the smallest relation satisfying the rules defined in and for brevity we write p instead of p the symmetric forms for rules and sum are omitted p p cv p vx v real v e cv p p cv p p cv p p p p p r cr p rq cq p p cr p p cr p p p p p p m re xp p ii pi p ix pi figure inference rules for part the transition relation can be lifted to О act О by writing p if for any c c c for some c and cc for any s qv ar we denote by s the complement set of s in qv ar the following lemmas can be easily observed from the inference rules defined above lemma if p then qv bv lemma if p then tr tr there exist a set of ei i i on such that for any p ii qi и pi where qi for any e on p e e examples to illustrate the expressiveness of we give some examples example coding is a quantum protocol using which two bits of classical information can be transmitted by sending only one qubit provided that a state is shared a priori between the sender and the receiver the protocol goes as follows let be the state shared between the sender alice and the receiver bob alice applies a operator on her qubit of according to which information among the four possibilities she to sum rel res def p cr p r p p cr p p p ii pi и pi i cr p p ii pi и pi p i p p q p pi и pi i p f f pi и i p pi и pi i cn l p l pi и i p b true if b then p p def p are figure inference rules for part transmit and sends her qubit to bob with the two qubits in hand bob performs a perfect among the possible states they are actually the four bell states i i i where i are defined in section and the information alice has sent we now show how to describe the protocol of m be a i is the qubit measurement binary expansion of i such that let cn m be the operator and h operator then the processes in coding protocol can be defined as follows x cx if x i then i q q q for any and v we have the transitions qq cv x if v i then e i qq qv nil cn q q q qv nil q q qv nil m q q ve qq nil ve qq dv nil ve qq here eq is calculated as follows qv c nq q c nq q if v if v c nq q c nq q if v if v example quantum is one of the most im protocols in quantum information theory which can make use of a state shared between the sender and the receiver to an unknown quantum state by send ing only classical information it serves as a key in many other communication protocols the protocol goes as follows let qq be the state shared between the sender alice and the receiver bob with alice holding q and bob holding q let q be the quantum system whose state alice want to transmit to bob alice first applies a quantum operations on q and q with q the control qubit and q the target followed by a operator h on q she then measures q and q according to the computational basis and sends the measurement outcome to bob upon receiving the classical bits from alice bob applies a corresponding operator on his qubit q to recover the original state of q let m cn h and i i be as defined in example then the quantum processes in protocol can be defined as follows q x q h qm q q ex if x i then i t el for any we have t el qq cr cn r r q qq r q qq m r q x ej rq qj j и cnil rq и cnil rq q и cnil rq q и cnil rq q and for j b x ej rq qj nil if j i then i ej rq qj nil ej rq nil ej rq here eq is calculated as notice that any can be decomposed as i i where and then it is easy to derive that qq rq rq q rq q rq q example encode quantum circuits with quantum circuits consist of two different types of unitary and quantum measurements we now show how to encode them using to ease the notations we allow quantum channels to input and output multiple qubits we write the quantum channel c as cn if n qubits can be through c simultaneously in other words the quantum of cn is n qubits и unitary gate suppose u is a unitary operator on n qubits then the unitary gate which implements u can be defined as a process constant u u u with the defining equation u u def u we denote u n и measurement gate suppose m is a quantum measurement act ing on n qubits then the measurement gate which implements m can be defined as mm def qe we denote n for any we have u u u u u u u and mm m re ii pi и pi where m p ii and pi tr now for each i i pi ei pi mm pi suppose g and g are two unitary or measurement with arg arg n the sequential composition of g and g can be defined as g g def ls rs c en fn gn where ls def and rs def if arg m and arg n then the parallel composition of g and g is defined as g g def lp rpc em fm en fn where lp def rp def denotes the prefix of qe with length m while the of qe with length n and is the concatenation of re and re weak bisimulation between quantum processes to present the notion of bisimulation which abstracts the internal actions caused by local quantum operations and classical or quantum communications we first extend the transition relation defined in section definition we define the relation con О as the smallest relation satisfying the following conditions c c if c p ii pi и ci and ci i for each i i then c similar to we can also lift to О by writing p if for each c c c for some c such that cc for any and s n act we say that can into by a weak denoted by s if there exist n n such that n and for each i n i i i and i i lemma let ii pi и ci and s act then s and only for each i i ci s i for some i such that ii note that and are different since in the former the last action of every execution branch from to must be while in the latter the action appeared in each branch is not necessarily the last one with these notations we can extend lemma to the weak transition case lemma if p s then tr tr there exist a set of ei i i on where bv n bv и и и such that for any p s ii qi и pi where qi for any e on we have p e s e bisimulation to present the notion of bisimulation we need a definition from definition let r con О con and a weight function for wrt r is a function О which satisfies for all c d con x c d c x c d d if c d then c d r we write r if there exists a weight function for wrt r let p then r if and only if ii and ii such that for each i i in particular if cr then for each d p note that when we write ii then ci denotes a simple distribution as a consequence the are not necessarily distinct definition a relation r con О con is called a bisimulation if for any p q con p r q implies that and whenever p cq then q cq for some such that for any e on e re whenever p where is not a quantum input then there exists such that q b and r whenever q cq then p cq for some such that for any e on e re whenever q where is not a quantum input then there exists such that p b and r here for any s act sb is the string obtained from s by deleting all the occurrences of definition two quantum configurations p and q are bisimilar denoted by p q if there exists a bisimulation r such that p r q two quantum processes p and q are bisimilar denoted by p q if for any quantum state and any indexed set ve of classical values p here xe is the set of free classical variables contained in p and q some design decisions made in definition justification and explanation и recall that in the definition of bisimulations proposed in a clause if p and q then is presented to guarantee that the quantum operations applied by p and q which give rise only to actions are the same that definition however does not fit well with recursive definitions since recursively defined processes will generally never reach a terminating process in definition we solve this problem by requiring instead that obviously when p and q and p and q do not hold any quantum variables and are equivalent however eq can deal with processes which have infinite behaviors for example let a def and b def x x if x i then i where set is the which sets the target qubit to and m is the measurement according to the computational basis that is m intuitively b can be regarded as an implementation of a specifying how to set the input qubit to we now show a b indeed holds under our definition of bisimulation let con a b aq aq j j where aq aq x mq x if x i then i x if j i then i and j j q let r con О con such that p r q if and only if there exist q qv ar and such that p and q are simultaneously included in con or then it is not difficult to prove that r is a bisimulation thus a b и furthermore by replacing eq with eq the derived bisimilarity will be preserved by restriction take the exam ple in let u u v v be unitary operators such that uu vv but u v let p q then p and q are bisimilar but p c and qc are not if eq is required in the definition however in our definition presented here p c and qc are also bisimilar since in eq we only need to consider the reduced states on the sys the quantum operations which are blocked by the restriction are not taken into account when comparing the quantum states и another question one may ask is that why we require in the definition which the pair p and q nil to be bisimilar the reason is although p and q have the same effect they both do nothing at all on the environment they are indeed different under parallel composition for example if q then the process q r is valid while p r is not и in clause we require for any e on the reason for this rather requirement is as follows to check whether two configurations are bisimilar we have to them with all possible inputs in classical process algebra this is realized by requiring that the input value is arbitrarily chosen in quantum process algebra however since the state of all systems is fixed for a given configuration only requiring the of the input system is not sufficient note that the operation and the swap operation are both special our definition actually includes the possibility of an arbitrary system which lies in an arbitrary state furthermore this requirement is also essential in proving the congruence property of the derived bisimilarity see theorem example coding this example is to proving that the protocol presented in example indeed sends two bits of classical information from alice to bob by a qubit with the help of a state let be the specification of coding protocol where x if x i then i and i is the qubit which sets the target qubits to ei that is for any ei qq we have q in the specification simply for technical reasons to make and to set q q to the required final states for any and v qq cv qq ve qq dv nil ve qq we can easily prove qq qq by checking that r p v cv p and nil ve ve v nil ve nil ve v is a bisimulation where qq note that does not hold in general since coding protocol needs the of a state to realize the intended task example this example is to proving that the protocol presented in example indeed any unknown quantum state from alice to bob again with the help of a state to employ our notion of bisimulation we need to modify the original definition of protocol in example as follows q q q and t el where set is similar to setx in the previous example let t q be the specification of protocol where sw ap is a qubit unitary operator which the states of the first and the third qubits keeping the second qubit again we involve qubit q here just for technique reason to make el then for any and r q q t qq cr sw q qq qr nil qr we can now prove t el qq t qq by checking that r t el qq t qq p sw q qq t el qq cr p r q q and r q q p qr t el qq cr with p q and r q q nil qr nil qr is a bisimulation where qq qq again t el t does not hold in general since protocol is valid only when a state is provided and consumed the following example shows the between quantum processes example encode quantum circuits by using the notion presented in example we can prove the following properties considering the sequential composition and parallel composition of quantum u u uv uv u u u gm m u u u u u u v uv v the proof is straightforward and we only take as an example let r uu uv uv u p q u u u v p and u v u q where re qv ar and p q u u u v p and u v u q where re qv ar and it is easy to check that r is a bisimulation so we have uu uv uv u for all and then u u u v uv u to conclude this section we prove some properties of bisimilarity which are useful in the rest of this paper lemma if p q then for any e on we have in particular tr tr theorem is a bisimulation on con and it is an equivalence relation theorem for any configurations p and q p q if and only if and whenever p cq then q cq for some such that for any e on e e whenever p where is not a quantum input then there exists such that q b and and the symmetric conditions of and bisimilarity congruence we now turn to prove the congruence properties of bisimulation first we show that the bisimulation for configurations is preserved by all static constructors theorem if p q then p r q r p f qf p l ql if b then p if b then q proof let us prove other cases are simpler let r p r e q r e p q and e is a on it suffices to show that r is a bisimulation suppose c d r where c p r e and d q r e for some p q and e is a on then and by theorem thus r r and re re let p r e for some and there are three cases to consider i the transition is caused by p solely we need to further consider two i cq is a quantum input then there exists a transition p cq p and p r e by the assumption that p q we have q ii pi и qi i cq ii pi и qi i such that for any f on q p f qi f i holds for any i i then q e ii pi и qi ei by lemma from which we further derive q e cq ii pi и qi ei and q r e cq ii pi и qi r ei for any f on rq we obtain from lemma that the composite map f e is a on q now using eq we have p f e qi f ei and thus p r f e r qi r f ei that is f rf as required ii is not a quantum input then there exists a transition p ii pi и pi i and ii pi и pi r ei by lemma from the assumption that p q we have q b jj qj и qj j and by theorem noting that e is a on we have q e b jj qj и qj ej by lemma so it holds that q r e b jj qj и qj r ej now for each i i and j j pi i qj j implies pi r ei r qj r ej since from lemma e is also a on thus we have r by lemma by noting that ii the transition is caused by r solely we also need to further consider two i cq is a quantum input where q then we have r e cq r e for some r and p r e thus r e cq r e by inference rule we have q r e cq q r e since q now for any f on r q the composite map f e is a on from the fact that r q q thus p r fe r q r fe from the definition of r ii is not a quantum input then by lemma there exists a transition r e pi и ri where ei is a on pi and pi и p ri then we derive r e qi и ri where qi again by lemma thus q r e qi и q ri notice that for any i we have pi qi by lemma and p ri q ri r since the composite map ei e is a on by the validity of p r then it follows that r from lemma iii the transition is caused by a communication between p and r without loss of generality we assume that p cq p r cq r and p r e other cases are simpler then q by the validity of p r and r cq r for any from the assumption that p q we have q ii pi и qi i cq ii pi и qi i such that for any i i and any f on q it holds that p f qi f i in particular we have p e qi ei since q noting that e is a on we have q e ii pi и qi ei by lemma from which we derive further q e cq ii pi и qi ei and q r e ii pi и qi r ei furthermore for any i i we have p r e qi r ei r by eq that is r as required the symmetric form when q r e can be similarly proved so r is a bisimulation on con the result follows by noting that the identity transformation is also a on from theorem the coding protocol and protocol presented in section is still valid in any quantum process context which consists only of parallel composition restriction and conditional the configuration bisimulation is not preserved however by dynamic constructors such as prefix and a counterexample is as follows let p mq where m is the qubit measurement according to the computational basis q and q where then p q but where h is the operator nevertheless similar to standard classical ccs the bisimulation for quantum processes is preserved by all the combinators of except for theorem if p q then ap aq a cx ce cq cq m qe x p r q r p f qf p l ql if b then p if b then q congruent equivalence of quantum processes as in classical process algebra the bisimilarity is not preserved by combinator to deal with this problem we introduce the notion of equality between quantum processes based on definition two configurations p and q are said to be equal denoted by p q if and whenever p cq then q cq for some such that for any e on e e whenever p where is not a quantum input then there exists such that q and and the symmetric conditions of and the only difference between the definitions of and is that in the latter the b transition in clause is replaced by that is the matching action for a move has to be at least one move furthermore we lift the definition of equality to quantum processes as follows for p q qp p q if and only if for any quantum state and any indexed set ve of classical values p where xe f vp f it is worth noting that all the bisimulation relations proved in the examples of previous are also valid when is replaced by now we prove that the equality relation is preserved by various process constructors of theorem if p q then ap aq a cx ce cq cq m qe x p r q r p r q r p f qf p l ql if b then p if b then q the monoid laws and the static laws in classical ccs can also be generalized to theorem for any p q r qp k l chan any functions f f and any action prefix a we have p nil p p p p p q q p p q r p q r p nil p p q q p p q r jp q r ap l nil if l ap l otherwise ap f f ap f p ql p l ql p qf p f qf p l p if l where is the set of free channel names used in p p kl p k l p ql p l ql if l p f l p f lf p id p where id is the identity function p f p f if the restrictions of f and f on coincide p f f p f f p qf p f qf if the restriction of f on is in the following theorem we simply write p p if for any p p theorem expansion law let p pf и и и then p x и и и pi fi и и и o pi pi and l x и и и pi fi и и и o pi cv pi vx for any v and l x и и и pi fi и и и o pi pi for any x m qe и и и pi fi и и и pi jj pj и pi j x x for any and m x jj pf и и и pi fi и и и pj fj и и и pi pi pj pj i j and among and there is exactly one input and one output we now turn to examine the properties of the congruence relation under recursive definitions to this end we assume a set of process variable schemes ranged over by x y assigned to each process variable scheme x there is a nonnegative integer if qe is an indexed set of distinct quantum variables with qe then is called a process variable process expressions may be defined by adding the following clause into definition and replacing the word process by the phrase process expression and by and qe where is a process variable we use metavariables e f to range over process expressions suppose that e is a process expression and i i is a family of process variables if pi i i is a family of processes such that for all i then we write i i for the process obtained by replacing simultaneously in e with pi for all i i definition let e and f be process expressions containing at most process variables i i then e and f are equal denoted by e f if for all family pi i i of quantum processes with we have i i f i i the next theorem shows that is also preserved by recursive definitions theorem if def p then p let ei i i and fi i i be two families of process expressions containing at most process variables i i and ei fi for each i i if i i and i i be two families of process constants such that def xj j i def xj j i then for all i i finally the uniqueness of solutions of equations can be proved for process expressions in definition given a process variable and a process expression e we call и is sequential in e if every subexpression of e contains itself is of the form af ii fi or if b then f и is guarded in e if each occurrence of is within some subexpression af of e where a is a classical or quantum input or output theorem let ei i i be a family of process expressions containing at most process variables i i and each is sequential and guarded in each ei let pi i i and qi i i be two families of quantum processes such that for each i and pi xj j i qi xj j i then pi qi for all i i to illustrate the power of the theorems proved in this section let us example we will provide another proof for uu u v u v u using the expansion law and the uniqueness of solutions of equations for simplicity we only consider the special case where u and v are both qubit unitary operators recall the definition of u u uv in example u u u v def ls u u ec fd u v fc gd where l c e f g then from theorem and repeatedly using theorems and we have u u uv qv u v where the first action is caused by interaction between ls and u u ec fd the second one between uu ec fd and u v fc gd the third one between u v fc gd and rs while the last one between rs and ls on the other hand by theorem we have u v u u u now let x be a quantum process variable with and e qv f u be two quantum process expressions then e and f are both sequential and guarded and e f so we have uu u v u v u from theorem conclusions and further work in this paper we propose a formal model which is a quantum extension of classical ccs to model and analyze the behaviors of quantum distributed computing and quantum communication protocols we define a notion of equivalence based on bisimulation for quantum processes in and prove that it is preserved by all process constructors including parallel composition restriction and recursive definitions this is the first congruence relation for process algebras proposed so far at modeling quantum communicating systems various examples are fully examined to show the expressiveness as well as the proof techniques of we conclude this paper by pointing out some topics for further study in the present paper only exact bisimulation is presented where two quantum processes are either bisimilar or obviously such a bisimulation cannot capture the idea that a quantum process approximately implements its specification note that this approximation or is especially essential for quantum process algebra since quantum operations constitute a and exact bisimulation is not always practically suitable for their physical implementation to provide techniques and tools for approximate reasoning a quantified version of bisimulation which defines for each pair of quantum processes a distance characterizing the extent to which they are bisimilar has already been proposed for purely quantum processes in we plan to extend it to defined in this paper another interesting direction of being is to expand the application scope of to model and analyze the security properties of quantum cryptographic systems by introducing cryptographic primitives such as constructors for encryption and decryption into picalculus the calculus has been very successful in cryptographic protocol analysis we believe that a similar extension of our will provide tools for analyzing quantum cryptographic protocols such as bb quantum key distribution protocol references m abadi and a gordon a calculus for cryptographic protocols the calculus c and m domain equations for probabilistic processes mathematical structure in computer science c h and s j communication via one and operators on states physical review letters Г c h g c r a and w an unknown quantum state via dual classical and channels physical review letters Г y r z ji and m probabilistic bisimulations for quantum processes information and computation Г s j and r communicating quantum processes in j palsberg and m abadi editors proceedings of the nd acm sigplansigact symposium on principles of programming languages popl pages Г l k quantum helps in searching for a in a physical review letters m hennessy a proof system for communicating processes with formal aspects of computer science Г m hennessy and a a theory of communicating processes information and computation Г p and m toward a quantum process algebra in p editor proceedings of the nd international workshop on quantum programming languages page k states effects and operations fundamental notions of quantum theory springer berlin m relations among quantum processes bisimilarity and congruence mathematical structures in computer science Г r milner j and d walker a calculus of mobile processes parts i and ii information and computation Г m and i quantum computation and quantum information cambridge university press p towards a quantum programming language mathematical structures in computer science Г p w algorithms for quantum computation discrete log and factoring in proceedings of the th ieee pages Г j von mathematical foundations of quantum princeton university press princeton nj m y r and z ji an algebra of quantum processes acm transactions on computational logic Г 