modes values expressions and cornell university o introduction several modern programming languages eg algol pascal el require each variable to have a declared mode or type which limits the class of values it may assume in each of these languages a value may con a reference or pointer to z value of the same type lists in this case it is natural to define the mode of the value recursively that is in terms of itself for example if list describes values which are structures con two fields one being an integer and the other a pointer to another value of type list then we can summarize these facts e list list what is a mode one point of view is that it is a set of values the report takes the slightly different view that a mode is a possibly infinite object that is associated with a set of values for example list is the infinite tree list i i building on these ideas lewis and rosen using methods of scott built a formal model seq in which every meaningful definition like denotes a unique element of seq the question of which mode definitions should be equivalent cf is by saying that two definitions are if and only if they denote the same member of seq lewis and rosen were interested in the question of equivalence of modes in type systems which allow unions we extend their work in a different direction by constructing a model for values the con is similar to the model for modes but involves certain new tions we investigate the relationship between modes and their sets of values as an application of our technique we consider certain mode definitions which are from algol for example mode mode mode ml ml m m ref m mode ml is also by lewis and it fails to denote a unique object in their system in fact any object satisfies the de property they give a syntactic characterization of those definitions which do have unique solutions mode m does have a unique solution but we wi show that the corresponding set of values is empty we give a syntactic method of detecting such definitions and it seems reasonable to them mode m is for still more subtle by considering the allowed expressions in algol and their effect on values we show that it is possible to construct a value of mode m which has in a sense made more precise below which cannot be accessed these useless values can be eliminated by preventing definitions like that of m again we show how to detect such tions removal of these modes entails no essential loss of expressivity from the language alternatively a new operator may be added to the so that such values are no longer useless the syntactic tests mentioned above are similar to the declaration condition however our con are less ad hoc following from general may be ap to other programming languages as they are developed moreover our seman tic approach points out an in the algol definition mode m m is legal but mode m ref m is not despite our considerations mode the obvious similarity would allow m as a modes syntax we use the following definitional facility as a concrete example i def z int i declare k k we will denote terminal productions of by words for tional simplicity we use integers as field selectors rather than arbitrary character strings as in algol this has no essential effect on the theory we will assume that every definition contains exactly one declaration for each appearing in it semantics the model m we build for modes is in by and closely the one presented in cf as mentioned above modes are of as possibly infinite trees the nodes of these trees are labeled by the symbols we allow only those following by trees sense which are in the define the rank of a rank o rank k k if s labels a node of a tree then that node has precisely sons for example int only at leaves we could specify our intended set of modes by saying that it consists of all trees built from the set of symbols given by but for the sake of other definitions it is to have infinite modes built up inductively from finite pieces rather than build for the we show how model for any our model set of symbols to construct such set no u a appendix a contains the details case qo int k for k we write to with this particular choice in this and m for of q elements of m are called modes briefly the facts about type of ordered m are as follows miss set called a in which certain limits tion which preserves are defined these limits a said to be continuous a guarantees the theorem of that such a function f has fixed points and shows how to compute a particular fixed point fixed point of f yf called the least now consider the may be thought of where the more specifically a definition such as as ng a list list is a free variable t m let fm struct int re f im then may be thought that list is any element m fm ie a fixed of as saying of m such that point of f more formally let d be the definition mode mode m dl d m dn for each di fd m as follows define a function if d int then fd int if d then fd xi then fd if d dk then fd where xx xn m n let fn d i by fd fd n fd is built up from operators in q so that by lemmas a and a is continuous hence yields as a corollary in appendix a fn theorem satisfied of m e element theorem each declaration by at least one m mn mn satisfying d is a cpo of this cpo is d is the set the least ll unique modes k o we have seen that each definition identifies at least one element of mn however some definitions are satisfied more than one for example the definition by mo de m is satisfied stated on m so the by any mode f is the identity function of fixed points of fd is all of m we can show that any definition with multiple fixed points is essentially a variation on to characterize those good definitions which define unique fixed points consider the following directed graph gd constructed from a definition d the nodes of gd are the of d there to g if and only if the mode m n appears in d is an arc declaration from from lewis and rosen if gd contains no directed cycles ie if g is a directed acyclic graph then the least fixed point of f is maximal in ie there is nd mn such that n m conversely gd contains a directed cycle then no if fd has a fixed point of which is at least one com proof outline and let kl by theorem a is given by let fi l rr j if mn kl the least fixed point yf r ml i ko suppose g is acyclic for each m s m let be the length of the shortest branch which terminates in j if any such exists and otherwise thus m is com defined up to level the idea is to show that as k increases increases without bound this is because each iteration of fd adds something to the root of mi for those mi which depend the other or not at all d on in d each other on such an m in such a way that the value of grows as fast as for the converse have a path suppose in g we m m m m k the n for all k o and all j im j corollary if gd is acyclic fd has a unique fixed point hence associates a unique i in d mode mi e m with then d each proof let i yf and let be any other is the least so m n but is fixed point in m so e for the remainder of this will assume that all definitions have acyclic graphs and hence tions we will consistently tation mi for the element of paper we mentioned unique the associated with the i by a definition regular modes we have seen that every associated with some element whether the converse answer is negative definition of m holds is we may the ed with satisfying only if b theorem a mode m m is some by some definition the property of if and m is a regular tree see appendix proof my let d be a definition d to form a grammar and s o g as follows the nonterminal symbols of g are the in of d the terminal symbols are where n g k for some s occurring in d for each declaration mode m e in d include the g if s occurs at l productions node of e and then include g e in in g if n occurs at node n of e and include g now for each clear that if symbol of g ls m since it should be m is taken to be the start ten g produces exactly g is right linear is a regular set conversely let sk let m be a regular mode be the symbols in m and let ai be the finite automaton let a be the parallel composition a ie a qf where ls m o the of f is delete those reachable ql qk states of a which are un now for each remaining state there is exactly one k such that qk fk this is because the reach ability of q implies that for some x l k ql x qi e fi implies that the node whose address is x is labeled s clearly this is true for exactly by one i now introduce an state q of a and give mode q q for the each q qk and si the unique symbol such that qi fi it that the mode corresponding q is the given mode modes and values may be to the m the central contribution of this work is the construction of a model for the set of possible values of an algol like language which provides a meaning for the until now purely formal notion of mode in particular each mode is with a set of values in such a way that distinct modes are associated with distinct sets of values a value such as the one shown in figure may be to be an infinite tree by unrolling it as shown in or it may be defined by a recursive equation such as v v both of these descriptions suggest a model va similar to the model but m the case of values an additional arises whereas figure indicates that some infinite trees should be allowed as values we dont want infinite values such as v since ture thus this would imply that v is one of whose fields contains a more involved construction a is re the model v in appendix a we have all the ma to produce a cpo tq from an ar set q of operators our approach will be to produce an appropriate set z of operators and let v tz in an operator o e e will be a storage cell having exactly n pointer fields and possibly some integer fields already initialized formally we make the inductive definition z the set of integers ref z if ui zn for i i rk then uk z let v tz intuitively v con all finite and infinite trees with labels in q cf perhaps with leaves and satisfying the ad property that on each infinite branch ref appears infinitely often the map value let v denote the collection of all sets of values order v by letting st if and only if t c s the change f direction it i readily verified that v becomes a cpo function value on by value with finite v l v modes define a inductively value m ref v value iv e ml mk vi vk e value mi and vi il lk this finite denote then completely specifies modes in fact the restriction the set value for all if we let cf value to vi n ci satisfies all the hypotheses of theorem a as may easily be checked thus we have a unique extension of value to modes by the proof of theorem a v is given explicitly by n o for example consider the mode m defined by the first few approximations to m and the value sets associated with them are shown in figure each mk g more information about m than l and so eliminates some values as possible values of m now for some modes m m for example consider the definition mode m this tions specifies a mode m m whose are mi im struct l v v v each v has the property that v r some operator u of depth at least i an operator is defined by the depth of o if u ref or u z depth ol uk l k suppose v fi value io since vv vl or v vk for some ue z vl vk v theorem a f so v if v then for each value mi u i it follows that is greater a than any integer the generalization the following theorem d we define a graph of this proof is given a definition gd similar to the graph constructed in but now z if and only if d contains the declaration mode m e where e is an expression con ig an of n not contained the operand of any of in theorem if gd is acyclic then every mode defined by d ie made to correspond to some in d has a nonempty value set conversely if gd has a cycle then d defines some m m such that proof suppose gd i acyclic an appearing in g and let its declaration sion e be mode m e for perform the following tion on e some step replace all occurrences of nt in e by o and all occurrences e for some expression e by al step if e has an occurrence of n for some n replace occurrence by e here the ation of n is mode n e and go back to otherwise stop e contains no this procedure halts after a finite number of steps because gd is acyclic it is readily verified is produced such that that a value v v v the proof of the to the above example tedious exercise values converse is and is left similar as a m because of the of structures such as circular lists whose versions are infinite we have allowed infinite elements in v but some elements of v are actually infinite in that they require an infinite amount of storage in fact we have the following see the remarks about notation of appendix a at the theorem for any value v v v to some finite list structure if and only if v is a regular value cf b notice that the occurrence lan guages ls are defined in terms of the operators s x not the symbols of proof it may help the reader to look at the example while reading this proof given a finite list structure s we construct a finite automaton whose states correspond to the cells of s there is a transition from state ql to q under the symbol kth pointer out to ql points to k if and only if of he cell corresponding the cell corresponding the to qz for each state is made the automaton cell c if the corresponding to be the unique final stat will recognize the occurrence or more unrolling language precisely a regular of c in s corresponds value thus s is to under the converse modes construction is similar and expressions suppose x is a variable with mode m and current value v let ex be an ex containing an occurrence of x what values may occur as values of such expressions v as a tree we say w is a of v if w is the tree com of some node of v and all its des now for any value of x it would be desirable that there is some expression e for each of v otherwise this is and may as well be eliminated from v this the definition let be a mode v a value n x a variable of mode m a w of v is accessible to m if and only lf there ex such that if x v then ex w v is connected with respect to m if and only if every of v ls with respect to m m is connect ed if and only if connected with every respect to m of course what expressions the following example this are subset definition allowed of algol depends choose as an on expression selection variable coercion expression of expression k of e is defined of begins with if and only if the mode for some k k then the value is of mode ref of e must be of the form and the value of k of m for some k e in this case the value of e is either for some v or for k k the former case de in the in de l in case the mode of e ref m for more than one value of k choose the least such k mode m is not connected as figure clearly any expression involving only a variable x of mode m cannot contain any coercions can be combined so any expression is equivalent to one the form dx if the mode of x is ref m for some then m m so the mode of x is m and the mod of d is m thus the val of the expression is of x if the value of x is v then w is let d be a definition again we con struct a graph gd as in here we have an arc from m to n if the declaration of there is an oi not contained in any struct k and only if m e where e which is of any theorem every mode definition d is connected gd is acyclic m defined by a if and only if proof by suppose gd is let m be a mode defined by d x a ble of mode m v a value of x and of v since gd is acyclic acyclic each branch of m and hence of v consists of alternating finite nonempty sequences of and the situation is given figure then the value w may be described by the expression notice that each m is a mode which can be described by built up from the appearing in d thus becomes a valid expression if each mi is replaced by the corresponding conversely if gd contains a cycle then one of the modes m defined by d satisfies the equation m for k the unique to this in m is the mode ref ref ref which as we saw above is not connected from one point of view such a mode is simply because there are not enough expressions if for example we allow an operator deref then m becomes connected in fact all be come connected on the other hand m may be replaced by m using m of to access the node x of x is of mode ref m which is not equal to m so the desired has its conclusion we have given a model for modes and values and used it to classify three types of declarations those which do not define unique modes those which define modes and those which define modes we criteria for detecting each kind of in terms of an easily checked pro of a graph which can be constructed directly from the definition also consider regular trees and show that they correspond exactly to the definable modes and the representable values but we feel that the most important aspect of this paper is that it shows that the purely syntactic approach to always the best that a description in terms of in meaning can be at the same time equally rigorous and more clear than the syntactic approach if the semantics is properly formalized references van a report on the algorithmic language algol n the programming language pascal acts informatica language programmer massachusetts b studies in extensible languages phd thesis university reynolds jc ap to the concept of type ar national morris types are not sets acm symposium on principles of ro gramming languages boston mass lewis c and fk rosen recursively defined data types part acm sym on principles of boston mass scott d continuous lattices pro of the conference lecture notes in mathematics springer verlag berlin scott d the lattice of flow grams in semantics of algorithmic e d lecture notes in springer verlag on infinite modes a in sigplan notices j the equivalence of modes and the equivalence of finite automata algol march i a a fix point theorem and its applications journal of mathematics mo automata on infinite ob problem conference series in mathematics mail ri foundation of formal language theory phd thesis mit project mac report tr mass j and jd unman formal languages and their relation to au reading mass s automata languages and machines academic press new york j note on infinite trees information proc letters december k sys and churchrosser theorems jacm january aj s for the work ing new york appendix a in this appendix we show how to con struct the cpo tq of all finite or infinite partially or completely de trees over an al q and derive some of its properties suppose q is any set of symbols without loss of gen assume the are disjoint otherwise replace s fin by ns in a new symbol i j fi and define a definition l i dn s all dk e dn u here we to make a remark about tation the elements of dn are to be thought of as trees tree given by d k is in the case s s where s is a tree s we will often refer to such a tree by the label on its node for exam ple in definition a both occurrences of denote trees throughout the paper we tree and the term or terminology for example each symbol in di in the example is in the ith subtree of s and m the ith operand of s a definition introduce on d nl as follows a partial order xy if and only if x or x y d for some k some seq all dk dn such k and some all that di di in dn rk q a definition let c be a set and a on c a subset of c x c is a cpo complete st if if i partially transitive orders reflexive c ie is and symmetric ii there is an element l c such that iii each x xl x of elements of c has a least upper bound x ie an element the pro a xi x i b if x notice that if c is finite holds trivially then iii a lemma each dn defined is a cpo by a and a m a definition let a b be cpos then f is monotone if and only if for each a with x y fx fy fa b f is continuous and if and only if f s or in notice that the monotone that property of f in so the definition of continuity makes sense no also that in a finite cpo or more generally in one in all finite every monotone function chains are is a theorem modified from let c be a cpo and fc c continuous let b fx x fixed points of f then the set of ib ii b is a cpo iii the least element of b is de noted yf and may be computed yf n by a we list several and continuous easy properties functions of cpos a lemma let a b c be cpos gb c continuous fa b i cx gf x is continuous ii ax x is continuous iii if a b then continuous iv a x b is a cpo ordering ga x is under if and only if xl y and x z y v x b x and na x el y are continuous vi similar to iv arbitrary products vii if s ok then and v but for sd is continuous u a definition the projection is defined by p x l vx dk dn pn dk a lemma dn dn l r pn is continuous for all n moreover x in y x and if y d the intuitive idea of all this is as follows let d be the set of all finite or in finite trees over o u where i has rank o if t t d define tl t if and only by replacing trees it trees defined in tree if t can be obtained from t occurrences of j by other may be verified that for fi this is exactly the ordering a now if t d is an define the sequence j as follows ti comes from t by off all branches after and replacing removed may be readily verified the first i levels subtrees by it that ti di and ti for all i but it may be shown that corresponds we define the to t to sequence thus constructed a unique tree t d thus b e the sequence t tl ao definition of all sequences such that dn let d d tq be the set e ox order d by di di each n let if and only if dn dn dn for all theorem d is a cpo dn is continuous and satisfies if e is a cpo and i is a set of continuous then there fn functions such that fn is a unique for all n fe d such that n theorem all may be summarized by say ing that d is the inverse limit of d d is also the of di as we show below a definition dx let di where x x x if ib di in n if q a theorem each d is continuous and in i if t is a cpo and functions such that qn then there n in is a unique gd e such that proof we may show that the property that each d d n o from this it follows defined by gd we conclude with of d and continuous easily that g may be a recursive two lemmas functions d a theorem d l u d a lemma or continuous s e k k d d s proof using sd is continuous by a all and a s can be extended to a continuous function d our last lemma inductive structure in to build a to the one in a uses the of the q continuous particular constructed map similar a each then lemma let k and suppose that for n n k fn xf xx k in k there is a unique function dk d that dl dk if d for any i and sl dd k appendix b in this appendix we introduce the no tion of regular tree this idea has ap in many place in the literature under many see for example the notion of ty is reasonably robust in that different definitions yield essentially equivalent results we present only the version that seems particularly convenient for our purposes we wish to give a notation for the nodes of d cf informally if u is a node of d then there is a unique path from the root of may be described by giving the sequence of choices made in passing from the root to rl if the k sons of a node are labeled to k this assigns to each node a finite string of tive see figure b then for s q let the occurrence language of s in d be the set in is labeled by s more formally b definition and ti define as for a mapping each s zy p dk s c il s z is the set of finite strings positive integers of where denotes the result of pre number each string i in by the d z is a cpo of ls is continuous under the subset ordering the ordering in and and satisfies the of a thus can extend ls to a function from d to the verify that this formal definition to the informal definition reader may above we are particularly interested case where is a regular set in the sup pose only finitely many s q appear in d then there is an n such that any s appear ing in d may be found in some qk for kn hence n for each s in b definition only lf d d is regular if u for all but finitely many s and is a regular subset n for all s where n s ok and of figure a value v the value figure of figure l ri m o l struct j j struct refl m struct ref struct struct int value some typical figure members of the cpo v of values t ll t d q z a list structure dz o figure and its w finite automaton w i k pa ks xn ref ref ref t w p levels figure a connected mode n a value mode m and a w of v of mode n l a value figure v which is not connected w at inj m addresses shown in are m and an figure b the address function and on symbols on modes figure b a mode which is not regular 