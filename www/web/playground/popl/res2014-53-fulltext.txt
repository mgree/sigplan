a nonstandard standardization theorem carnegie mellon university states univ de and univ france univ de and univ de univ and france abstract standardization is a fundamental notion for connecting programming languages and rewriting calculi since both programming languages and calculi rely on substitution for defining their dynamics explicit substitutions es help further close the gap between theory and practice this paper focuses on standardization for the linear substitution calculus a calculus with es capable of reduction in calculus and linear logic for the latter can be formalized by means of a simple equational theory over the linear substitution calculus contrary to other calculi with es our system can be equipped with a residual theory in the sense of which is used to prove a lefttoright standardization theorem for the calculus with es but without the equational theory such a theorem however does not lift from the calculus with es to because the notion of lefttoright derivation is not preserved by the equational theory we then relax the notion of lefttoright standard derivation based on a total order on redexes to a more notion of standard derivation based on partial orders our proofs rely on and axiomatic theory for standardization however we go beyond merely applying their framework some of its key concepts we obtain uniqueness modulo of standard derivations in an abstract way and we provide a coinductive characterization of their key abstract notion of external redex this last point is then used to give a simple proof that linear head nondeterministic strategy having a central role in the theory of linear standard categories and subject descriptors f logics and meanings of programs semantics of programming languages operational semantics f mathematical logic and formal languages mathematical logic lambda calculus and related systems i permission to make digital or hard copies of all or part of this work for personal or classroom use is granted without fee provided that copies are not made or distributed for profit or commercial advantage and that copies bear this notice and the full citation on the first page for components of this work owned by others than the authors must be abstracting with credit is permitted to copy otherwise or republish to post on servers or to redistribute to lists requires prior specific permission andor a fee request permissions from popl january ­ san diego ca usa copyright is held by the publication to acm acm symbolic and algebraic manipulation languages and systems evaluation strategies general terms theory languages keywords lambdacalculus standardization residuals explicit substitutions linear logic introduction in his paper plotkin introduced the idea of relating a calculus given by means of an equational theory induced by a rewriting relation and a programming language specified as an abstract machine via a standardization theorem the programming language implements the standard strategy associated to the calculus let us recall what standardization is about the idea is to identify a class of derivations called standard that is complete whenever t u then there is a standard derivation from t to u often it is possible to describe a reduction strategy that produces standard derivations only the strategy in the calculus and for which the normalization property holds as a corollary of the standardization theorem if t has a normal form then the standard strategy will reach this normal form completeness and normalization are the for approach another approach to close the gap between calculi and programming languages is to to explicit substitutions es that are refinements of calculus where evaluation is decomposed into small steps and that can be thought as a framework in which to specify abstract machines as strategies it would be natural to expect calculi with es to standardization theorems whose induced standard strategies justify abstract machines surprisingly the literature does not present any such relationship this is due to some inherent difficulties calculi with es are complex and rewriting systems for which already studying normalization is technically confluence and termination is simply out of scope in particular es calculi present critical pairs and thus lack a basic syntactic property by the calculus and on which most standardization techniques rely on this paper makes significant progress on standardization for es the starting point is a recent advance in the field of es a new generation of calculi with es at a distance having very simple and as equivalent copies of graphical languages such as linear logic have recently been introduced by and in see also traditional calculi with es implement the ordinary substitution by es through the term structure until they reach variable occurrences on which they finally substitute or get garbage collected the key feature of distance calculi is that the process is out from the computational process indeed es at a distance do not move their dynamics is defined using contexts ie terms with holes that allows them to act directly on single variable occurrences via a context the occurrence without any need to commute with the other constructors in between the framework in this paper we focus on a specific calculus at a distance the linear substitution calculus lsub that is both a slight generalization of a calculus by robin milner related to bigraphs from which it inherits the substitution rules at a distance and a slight modification of the structural calculus by and related to proof nets such a calculus has some relevant features linear logic and concurrency it is connected with the translations of calculus into linear logic and the calculus in particular reduction rules for es act as exponential rules in linear logic resp replication in the calculus linear head reduction given the deep connection between lsub and our calculus naturally expresses linear head reduction a notion of evaluation for proof nets that is connected with other fundamental models notably is a strategy for lsub while it cannot be expressed as a strategy in calculus simplicity and expressiveness the calculus is simple only rewriting rules and it numerous desirable properties including a tight correspondence with the lambda calculus simulating reduction confluence on terms and preservation of strong we will show a theory of residuals the linear substitution do all other calculi with critical pairs and so standardization is nontrivial however lsub a unique property that we call orthogonal first and higherorder term rewriting systems are defined as systems without critical pairs they are the most studied class of rewriting systems including in particular the calculus this notion of syntactic is and simple but it has the of being too restrictive fortunately can be defined in a more abstract way as the fact that standard concept in rewriting theory see section are sufficient to close local confluence diagrams this form of is a particular property of syntactic but it is of a behavioral nature and more general the crucial point is that lsub is not syntactically orthogonal contrast to any other calculus with semantically orthogonal as we prove in this paper in this sense lsub is the first calculus with es that conservatively refines calculus preserving its unfortunately most techniques for standardization rely on an exception is the abstract theory of standardization developed by and and later refined by such a theory can even with non semantically orthogonal calculi as the calculus but it takes a much simpler form in presence of lefttoright standardization and beyond two first contributions of this paper are a theory of residuals for lsub and a proof of the axioms of theory these technical results allow us to obtain a lefttoright standardization theorem generalizing the wellknown standardization theorem for calculus and capturing the deterministic weak ie not reducing under abstractions variant of is the variant that actually matches evaluation in the abstract machine and the a standard strategy it is that the properties of lefttoright derivations extend naturally to lsub however such a standardization theorem is not fully satisfying a first reason is that without the weak restriction is a nondeterministic strategy whose sequences are not necessarily lefttoright standard however the nondeterminism of does not affect the final result nor the length of evaluation sequences technically the property it is then that is not lefttoright standard because is a crucial notion in the theory of linear logic a second reason for not being satisfied with the lefttoright standardization theorem concerns the close relationship between the linear substitution calculus and linear logic the model behind its terms and are equivalent in a strong sense every term t maps to a pt and every evaluation step on t or pt maps to an evaluation step on the other additionally the redexes are in bijection and so concepts such as residuals transfer from terms to and the interest of is that they provide a of terms this can be explicitly characterized by a simple equational theory in the style of and here generated by equations only the behavioral equivalence with linear logic into a true isomorphism for every p there is a class containing all and only the terms equivalent to p consequently any notion or result that is stable by equivalence immediately to unfortunately lefttoright derivations in the linear substitution calculus are not stable by because some constructors the relative position of some redexes thus our lefttoright standardization theorem does not hold for this is quite because proof nets provide an operational model and one would like to have a notion of standard derivation that can be freely from the language to the model and we then refine our lefttoright standardization theorem partial standardization orders standard derivations are defined as those reductions that respect a certain order on redexes for instance the lefttoright order in theory such a total order is replaced by a partial order providing a more general but also setting to achieve a notion of standard derivation that is stable by we are forced to relax the total lefttoright order into a partial order in the setting of total orders given a derivation t u there is a unique standard derivation to which and moreover a deterministic and normalizing standard strategy can be easily obtained by selecting the minimum redex according to the order when the order is partial instead there can be many standard derivations to which a derivation ie uniqueness is lost a standard derivation is an ordered derivation but only up to of disjoint steps moreover although theory does support partial orders it requires a number of axioms to hold some of which are not by lsub modulo so we shall switch to the of phd thesis which is more general and allows us to prove existence of standard derivations for a suitable partial order however lsub modulo does not even satisfy the axioms of required to obtain uniqueness of we distinguish between the leftmost strategy that repeatedly reduces the leftmost redex from lefttoright standardization that redexes not necessarily involving the leftmost redex from left to right we also use leftmost considering terms as strings of symbols for what is sometimes called that is relative to terms seen as trees derivations nor does it supply us with the guarantee that reducing external generalization to partial orders of the notion of minimum redexes in the setting of total to normal forms we these of the axiomatic framework by exploiting the embedding of a partial order into a total order thus proving uniqueness modulo of standard derivations and the normalization of a specific external strategy main contributions a summary of our results follows the standardization theorem we identify a partial order b that is related to the concept of exponential box in linear logic and that is stable by we show that axioms for existence of a standard derivation hold for b obtaining a standardization theorem for lsub modulo uniqueness modulo for partial orders theory has some additional axioms that ensures uniqueness modulo independent see section but one of these axioms does not hold for lsub nonetheless we prove uniqueness in an abstract way relying on the embedding of the partial box order into the total lefttoright order coinductive external redexes in theory external redexes are defined somewhat indirectly via an extraction process we this concept by providing a direct and simple coinductive characterization an external redex is a minimal redex that is minimal ie whose unique residual after any other redex is still external applications we use the coinductive characterization of external redexes to obtain a normalization theorem for the leftmost strategy and to give a concise proof by coinduction of the fact that is a standard strategy the nonstandard character of our standardization result comes at least from the following facts of the first orthogonal calculus with es being isomorphic to linear logic and standardization use of a partial vs total order on redexes being stable by equivalence classes proof of uniqueness modulo of standard derivations by means of simple arguments and an original application of theory to a orthogonal case abstract machines as mentioned before we will show that weak is a standard strategy in parallel and studied the relationship between abstract machines and calculi at a distance obtaining that weak is the strategy implemented by the abstract machine up to a certain notion of structural equivalence this result refines a similar one by and and completes the lifting of approach relating the machine with a standard strategy in the callbyvalue calculus to the of explicit substitutions moreover contains similar between machines for callbyvalue the and and callbyneed machine and some variations over weak we are that the new understanding of standardization for es provided by our work will lead to analogous standardization theorems for callbyvalue and callbyneed variant of the linear substitution calculus the picture related work a brief history of standardization may be found in standardization was introduced in by curry and for the lambda calculus this result by defining the notion of permutation equivalence and showing that every derivation has a unique standard derivation in each equivalence class huet and extend these ideas to firstorder term rewriting without critical pairs and also show that one must the lefttoright order for more general orders in these systems gives the first abstract proof of standardization and applies these ideas to higherorder rewriting extends huet and work to term rewriting systems with critical pairs and and and and xi provide further along various and introduce an axiomatic approach to standardization later refined by that has turned out to be convenient to deal with our case due to its abstract nature indeed simple techniques such as inductive reasoning in or the proof terms technique by van and de extended to the higherorder case by are not easily to our equational setting technique does not apply either there is no relationship between our results and standardization by levels for linear logic both approaches use partial orders but such orders are incomparable this is a further reason to consider our result as nonstandard plan of the paper the next section introduces the linear substitution calculus section defines residuals and section shows that residuals are compatible with the equivalence in a very strong sense section explains the ideas behind the abstract approach to standardization and section proves the lefttoright standardization theorem section explains how the lefttoright order can be relaxed to with the equational theory and section proves our equational standardization theorem section provides uniqueness of standard derivations section presents a coinductive characterization of external redexes and section proves the normalization theorem and the fact that weak linear head reduction is standard the linear substitution calculus the set of terms of the linear substitution calculus denoted by t is generated by the following grammar t x tt xt a term x is called a variable tu an application xt an abstraction and an explicit substitution the notions of free and bound variables are defined as usual plus x we work with the standard notion of conversion ie renaming of bound variables for abstractions and substitutions we use c to denote a context wrt the previous grammar ie a term with a unique occurrence of a designated symbol called the hole we write ct for the term obtained by replacing the hole of c by the term t we write cu when the free variables of u are not captured by the context c ie there are no abstractions or explicit substitutions in c that bind the variables of the is given by the set of terms t and by the reduction relation lsub defined as the union of db ls and gc which are the closure by contexts c of the following rewriting rules where l denotes a possibly empty list of substitutions xt db ls gc c t if x the names db ls and gc stand for beta linear substitution and garbage collection respectively rule db resp ls comes from the structural calculus resp milners calculus while gc belongs to both calculi in db we may assume that sk i xi and x sk i note that the l xt can also be seen as a context xt this fact together with such a standardization theorem is in the linear logic community see for details the use of a context c in the second rule and the global side condition in the third rule justify the idea of rewriting rules at a distance the substitution context in rule db is motivated by its encoding in where explicit substitutions are partially free to float ie to traverse some term constructors such freedom is formalized by the graphical equivalence and by the study of its properties in section the linear substitution calculus all the properties required of calculi with es including simulation of reduction preservation of strong confluence on terms and and full composition whose proofs are simple and omitted as they are minor variations over those for milners calculus or those of the structural calculus in order to study residuals we need to fix a precise terminology about redexes a redex occurrence in a term t is either a tuple d r where t dr and r a or a tuple d r c where t dr and r a or a tuple d r where t dr r and x a for example the term t has two different redex occurrences namely d r c x and d r c x the pattern of a redex is r the second component of the tuple the box of the redex is the subterm of the pattern noted u and the context of the redex is d the first component of the tuple we use a b for redexes occurrences and for the set of all redex occurrences of t given a redex occurrence a we write s a t for the reduction step obtained by a in s the graphical equivalence is given by the contextual transitive symmetric and reflexive closure of conversion ie renaming of bound variables and the following axioms cs x y y x this equivalence characterizes exactly the representation of terms as in the sense that t u iff t and u map to the same the is given by the set of terms t and by the reduction relation lsub defined by the rewriting rules db gc ls modulo the equations cs ie t lsub u iff t t lsub u u thus in particular t lsub t implies t lsub t given any reduction relation r an is a possibly empty sequence of reduction steps having the form s t r t r an is finite iff the associated sequence is finite we write d e for derivations and d s r t when we the source s and target t of the finite derivation we write for the empty derivation and a d s t for the derivation composing s a u to the left of d u t a reduction relation r is said to be terminating iff every is finite an element t is said to be in form iff there is no u such that t r u residuals the residuals of a redex a after a reduction step t b u are the traces of the redex a that appear in the target term u the crucial property that residuals need to satisfy is that any local confluence diagram u a t a u can be closed by reducing in u resp u all and only the residuals of the redex a after a resp of a after a when this happens for every possible local confluence diagram we say that the system is semantically when terms are represented as linear logic what we call box corresponds exactly to the exponential box orthogonal the in the study of residuals is that redexes may be duplicated or erased along the way and duplication may even nest two residuals of the same redex for further references the reader may another simpler notion of is and happens when the system is and has no critical pairs implies semantic but the converse does not hold in particular the is not syntactically orthogonal but as we will show in section it turns out to be semantically orthogonal a property that no other calculus with es in order to give an intuition on such a let us consider a calculus with es such as or x containing at least the following reduction rules b the following critical pair arises b however the step has no residual after the the also has no residual note how it would have a residual if the rule were at a distance the diagram can be closed but only reducing created redexes and so the calculus is not semantically orthogonal the formal development of residuals is based on a notion of term to be introduced next note that since lsub is not syntactically orthogonal the technique of the redex pattern cannot be applied eg in the does not distinguish between the two occurrences of the ls redexes labels in order to follow redexes along a derivation we mark them with special symbols called labels denoted the obtained set of labeled terms denoted by tl is generated by the following grammar t x x tt xt xt the notations x xt and mean that x may or may not be labeled we write to denote the set of all the labels of t and t to denote the term obtained from t by removing all its labels thus for example z we extend the l to lists of possibly labeled substitutions and c to possibly labeled contexts similarly the notions of free and bound variables are extended to labeled terms as expected together with their corresponding notion of conversion we use to denote the subset of having at least one labeled occurrence eg x labeled reduction on labeled terms is defined as the con textual closure of the following rewriting rules db ls gc t x definition of redexes for terms naturally extends to labeled ones a labeled redex a is a redex having a pattern of the form or and is called the label of the redex a the of a redex labeled or not is the variable possibly carrying its label we will usually associate the labels and to the redex names a b and c respectively we will write a to emphasize that is the label of the redex a we write for all the redexes of t labeled with in order to show some key properties required by the axiomatic approach section we will work with a subset of labeled terms written called terms and defined by · x and x · if t and x then xt · if t u then tu · if u then · if t u then · if t u and x then note that xx xx and are not in note also that subterms of terms are not necessarily eg the abstraction of a labeled terms are stable by reduction and graphical equivalence lemma let t if t u or t u then u residuals here we define residuals for the reduction relation lsub in section we will extend them to the lsub a term t can be labeled in different ways leading to different variants of t more precisely we say that t is a variant of u iff t u thus in particular t is a variant of itself if t is a variant of u then we will consider the obvious bijection between the sets of redexes of t and u sometimes we will even identify some particular redexes of them which are related by this bijection to define the residuals of a redex a after a step t b u we consider the lift of t wrt a by written a which is a particular variant of t obtained as follows let be a fresh symbol ie if the redex a is already labeled in t then change the label of a to otherwise if a is not already labeled assign to a let us write a b u for the induced associated reduction step then the set of residuals of a after b is given by a b a b u it is clear that this definition is completely independent from the variant used to lift the term t we write a b a for a a b and a b for s aa a b for example taking v b v x x so that v b v and a b we have a b b b where b v yx and b v xy creation given a reduction step t lsub u the set of redexes in u that are not residuals of redexes in t are said to be created while there are only possible ways to create redexes in calculus in the redexes may be created in one of possible ways we just show below one example for each case where the reduced redex has label and the created redex is db creates db v db db creates ls db db creates gc db ls creates db ls ls creates gc ls gc creates gc gc note that can create every kind of redex can create db and can only create other note also that whenever a labeled redex creates a redex a then a is not labeled developments labels are particularly useful to study develop ments ie derivations in which only residuals of an initial set of redexes are for that we first extend the concept of residual to finite derivations as follows a a a b d a b d given a a possibly infinite derivation t t a t a t is a development of a iff ai a a ai for all i for example in the t is a development of the set containing the two of t in the sequel a an denotes any derivation d dn such that di is a development of the set of redexes ai for all i the finite developments fd property states that given a term t and a set of redexes a any development of a starting at t terminates this property proved in section is one of the key requirements for the axiomatic theory of that we are going to apply the residual of a derivation over a set of redexes a is defined as follows a and b d a b e d a b where e is any development of a working with equivalence classes in this section we first define the notion of residual of a redex along an equation so that we will be able to trace redexes along we then show that the notion of residual defined in section is welldefined wrt equivalence classes ie the residual relation yields a unique bijection between two redexes in the same equivalence class and residuals of rewriting steps lift to equivalence classes the labeled graphical equivalence on labeled terms is given by the contextual transitive symmetric and reflexive closure of conversion and the following axioms cs x y y x the axioms are to be understood in such a way that each label occurs either in both sides of the axiom or in none of them an equational proof of t u is a derivation tree ending in t u which uses conversion the axioms cs and and the standard inference schemes expressing compatibility of wrt all term constructors and transitivity symmetry and of residuals along equations we now propose a notion of trace of a redex along an equational proof which is similar to that used for derivations although the intuitive idea is quite natural one needs to guarantee that this notion is independent from the particular syntactic proof used to show that a term t is equivalent to another term u a property that we call given t u a and we consider the la equation a u the set of residuals of a after t u is given by a t u a u again this definition is independent from the variant used to lift the term t we write a t u a iff a a t u and we extend this notion to sets of redexes as expected in which case we write a t u a where a and a for example given v y zx y v and b x y x we have b v v v x y z despite the simplicity of the equivalence relation the result of is not as straightforward as it may seem in principle it could be shown by introducing and showing that the proof nets corresponding to two equivalent terms s and t are identical thus there is a bijection between redexes in s and redexes in t since there is a bijection between redexes in s resp t and redexes in their representation we prefer however to avoid introducing here on one hand because they are only simpler than terms on the other hand to to a unique formalism namely terms to develop our ideas note that our equations do not labels so that any redex has a unique residual along the equivalence then can be stated as the fact that every equational proof of t u induces the same bijection of redexes the proof by of notation we use the same symbol both for the equivalence relation on labeled and terms of this property is based on the identification of three structural invariants of labeled redexes with respect to the equivalence it is omitted for lack of space lemma let t u st t u then there is unique bijection st a a iff a tu a note that uniqueness guarantees that if t d u and t d u are two derivation trees of t u then a t d u a iff a t d u a the last result concerns preservation of residuals by means of equivalence classes where below we write t u to emphasize that is the unique bijection given by lemma lemma let t u consider a b if t a t then simulation u st u a u and same equivalence target t u ie st t u and preservation of residuals if b a b then b a b abstract standardization a standard derivation is a canonical element of a class of derivations where is expressed by means of completeness whenever t u then there is a standard derivation from t to u in calculus a derivation is standard if redexes are selected from lefttoright it is easy to see that the order instead does not provide completeness consider the derivation t iii it reduces both redexes in t but it can only be obtained by reducing these redexes according to a lefttoright order as the order would instead give ii the lefttoright is specific to the calculus and may not be appropriate for other term rewriting systems as for example the firstorder containing the unique rewriting rule f x a x the abstract theory of standardization then replaces the lefttoright order with an abstract order capturing what we call the action principle the action principle let us introduce two crucial concepts reduction of a redex a may directly act on another redex b ie it for example in calculus if t then reduction of the leftmost redex a in t the redex b ii secondly reduction of a redex a may indirectly act on a redex b by creating a new redex c that may directly or indirectly act on a residual of b or changing the set of redexes that can act on b or on which b can act an example of the first case if t m ii where m then reduction of the leftmost redex a in t indirectly acts on the redex b ii by creating the redex m ii which can duplicate the residual of b an example of the second case will be given at the end of section standard derivations are defined abstractly according to the action principle for every redex a reduction of a future reductions of redexes which may have directly or indirectly on a before the nesting order essentially has to induce this principle by capturing as much action as possible we will see that has to capture direct action while in general it might capture only some cases of indirect action the abstract theory of standardization derivations according to the action principle relying on some axioms about the interaction between the nesting order and residuals then whenever the axioms are satisfied the standardization theorem follows an abstract reasoning proves that ordered derivations are complete total and partial orders the lefttoright order has a fundamental property it is a total order ie given two different re a and b then either a b or b a in such a case the abstract theory is quite simple total orders have a limited power though consider a form t the lefttoright order forces the redexes in u to be reduced before those in v however it is clear that u and v cannot interact in any way and consequently they could be reduced in parallel even if this parallelism is not captured by the lefttoright order in other words the lefttoright order captures more than the action principle standardization can then be refined by switching to a partial order for instance the partial tree order tree where a tree b if b is a subterm of a so that a and b are if b is to the right of a captures the parallelism of redexes in t and admits a standardization theorem the abstract theory of standardization for partial orders is more sophisticated so for the moment we with total orders and shall return to partial orders in section in the rest of this section we introduce the necessary notions to deal with the abstract standardization theorem for total orders in section we will adapt the lefttoright order to the and obtain a lefttoright standardization theorem from section to the end of the paper we will and study a relaxed variant of this order introducing the framework for partial orders and prove a more general standardization theorem for the the abstract theory in this paper we to the abstract framework developed by and in but we adopt the more general formulation given by in his phd thesis as the axioms in will not work when we shall later relax the lefttoright order the framework is based on abstract rewrite systems a general formalism first and higherorder rewriting plus a residual relation and a partial order on redexes verifying some axioms the axioms are divided into two groups the basic axioms which guarantee a wellbehaved theory of residuals and the standardization axioms which concern the interaction of the order with the residual relation to formally define the axioms we introduce the following notion an abstract rewrite system is a tuple of the form o r src tgt where o is called the set of objects r is called the set of redexes src and tgt are functions from redexes to objects that we call source and target functions resp is a family of binary relations indexed by the set of redexes that we call the residual relation and is a partial order on redexes we say that two redexes a and b are if t for some term t note that the may be seen as an where o is the set of terms t defined in section whereas the is an where o is the set of equivalence classes generated by t modulo the graphical equivalence the basic axioms are · ae for any redex a a a · finite residuals fr let a b be redexes then the set c a b c is finite · uniqueness of ancestors ua let a b c be redexes then b a b and c a c and b c imply b c · finite developments fd let a be a set of redexes then any development of a terminates · semantic so let a b be redexes then a b and the relations a b a and b a b are exactly the same where a b a in is called a finite residuals is called b uniqueness of ancestors is called d and semantic is called is the derivation that contracts a and then b a likewise for b a b cf end of sec we consider two standardization axioms · linearity let a and b be redexes st a b then b st b a b · let a b c be redexes st b a b and c a c if a c then b c b c the linearity axiom captures direct action if a does not nest b then it cannot directly act ie on b and so b has exactly one residual after a the axiom a form of indirect action of the second kind whenever a cannot act on c ie a c then it cannot grant or remove the power to act on c to any other redex a derivation d t u is said to be obtained from a derivation e t u by a permutation written e d noted de in if d is obtained from e by two consecutive redexes which form an inversion wrt in d more precisely e d if e f b a g and d f a h g and a b where a b a and h b a we also say that d is more standard than e the classic notion of permutation equivalence on derivations adapted to total orders can be seen as the equivalence generated by standardization indeed d t u is permutation equivalent to e t u written d e iff d e in the sequel we write when we wish to emphasize the underlying order a derivation d is standard if it is a normal form the standardization theorem then follows by thm in to total orders theorem abstract total standardization consider any equipped with a total order and satisfying the basic and the standardization axioms then for any derivation d t u there exists a standard derivation e t u such that d e the lefttoright standardization theorem in this section we prove a standardization theorem for the relative to a total order this result is an extension of the lefttoright standardization theorem for calculus the lefttoright order given two redexes a and b in t we say that a is lefttoright nesting or on the left of b written a l b if the of a is to the left of the of b looking at t as a string of symbols clearly l is a total order so that a l b and a b imply b l a in order to prove standardization for the by means of theorem we need to verify the basic and the axioms basic axioms the first three basic axioms are trivially true by using terms to trace residuals we can prove the finite development axiom proposition fd let t t and let a then any of a terminates proof consider any t t and lift every redex in a with a different label belonging to some arbitrary set l it is clear that the resulting term is a term now let us consider the labeled reduction relation l s l to prove the fd property it is sufficient to show that the reduction relation l terminates on terms termination is proved by means of a measure that strictly decreases with every reduction step similar to that one used in the proof of lemma in the next proposition proves the property for lsub that is expressed as a form of local confluence for the labeled system again we to terms proposition so the with the lefttoright order satisfies semantic proof the proof uses terms to trace residuals in such a way that axiom so can be as follows the reduction relations and locally commute ie if t u u t u and t u then there exists v st u v and u v this alternative statement can be proved by induction on the relations and standardization axioms totality of the order l provides very simple proofs of these axioms proposition the with the lefttoright order satisfies linearity and proof linearity by totality of l we have to show that if b l a in t then b st b a b now if a is a this is obvious as no redex is by a if a is a gc then it can only act on redexes whose is in its box ie on redexes on its right and thus not on b if a l c then c l a assume b l c and so b l c l a then a is on the right of both b and c it is easily seen that a can only change the order between redexes on its right consequently b l c the other direction is by assume b l c that is c l b we have to prove that b l c ie c l b there are two cases if c l b l a then we reason as in the previous direction getting c l b otherwise we have c l a l b now the only case that is not immediate is when a is a it is enough to observe that a can only move the redexes in its box at most where the step itself was hence b can at most be where a was while the position of c is left unchanged and so c l b we can then conclude with our first standardization theorem corollary lefttoright standardization for lsub if t lsub u then there is a from t to u proof it follows from theorem whose hypothesis are given by propositions and the first three basic axioms are immediately seen to hold towards equational standardization the linear substitution calculus has been designed to the representation of calculus in linear logic where reduction is decomposed into small steps the relationship between the two occurs at the static and the dynamic levels every term can be mapped to a and every can be mapped to an equivalence class of terms as defined in section moreover there is a bijection between the redexes of a term t and the redexes of its corresponding p nt which induces a strong bisimulation between terms and if t lsub u by reducing a redex a then p nt p n p nu by reducing a and if p nt p n r then there exists a term u st t u and r p nu the graphical equivalence introduced in section then inherits a strong property it is a strong bisimulation between lsub and itself ie t u v implies that r st t r v the proof is similar to that of the structural calculus it moreover induces a bijection of redexes and so it is possible to derivations via as follows given a derivation d t n u and a term t t we can refer to the projection d t n u with u u of d on t since d and d essentially reduce the same redexes at each step one expects any reasonable notion of standardization to apply without distinction to both derivations in the sense that either both are standard or none of them is this would imply in particular that our standardization theorem for lsub corollary also applies to unfortunately the lefttoright order does not meet this requirement indeed a lefttoright derivation for where y does not project to a lefttoright derivation for obtained by applying the equation cs the order we are therefore going to relax the total lefttoright order l to a partial order b that will be stable by the definition of b shall be by the action principle because of the linearity axiom it is that b captures direct action between redexes for that a simple intuition due to and then explored by turns out to be extremely helpful the idea relies on the analysis of local confluence diagrams whenever a redex is duplicated resp erased then the standard derivation should be the longest resp shortest side of the diagram consider for example the diagram in the standard way to get from the source to the sink of the diagram is the longest ie side because the acts on ie the redexes in s the standard derivation associated to the diagram in which is an case is instead the shortest side because the redex acts on the redexes in s the previous two cases are just of similar cases in calculus and amount to what can be described as nesting as subterms the of lsub is that direct action and then nesting of redexes can also happen at a distance consider now the example of the diagram in the duplicated on y is not syntactically contained in the on x worse the same diagram applies to terms like where xy and yz are no longer next to each other according to the action principle our order has to impose that the on x the on y so that the standard side of the diagram is the longest one diagram in is the version at a distance of the diagram requiring the same notion of nesting at a distance all these lead to the partial order of the next section that will be used in section to show standardization of the the box standardization theorem we now generalize the notions introduced in section to the partial box order and then prove the standardization theorem for the with respect to this order the box order let a b then · a immediately boxes b noted a b b if the of b ie the variable possibly carrying a label is in the box of a ie if the pattern of a is any of or then the of b appears in u · a boxes b noted a b b if we use a b b for · a and b are disjoint noted a b if a b b and b b a remark that otherwise one would lose completeness as there would not be any standard derivation from to the term cs xs which is the intermediate term in the sequence cs xs note that a b b implies a l b additionally note the transitive closure in the definition of for on the proofs of the standardization axioms for b the key property of the box order is that it is stable by the equivalence for example for with y the redexes in u and the redexes in v are not related by b so that b is stable by the axiom cs where y x more precisely given s t the bijection between and defined in section is to show this property it is sufficient to remark that symbols inside boxes never go these boxes by means of the equivalence relation thus we get lemma preservation of the box order by equivalence let t u t st t u where is the bijection specified in lemma then with b ie a b b iff a b b several remarks on b are in order disjoint redexes may a b does not necessarily imply that a and b are syntactically disjoint examples the redexes a and b are disjoint but syntactically in x and syntactically nested in however disjoint redexes always strongly locally commute in the following sense if t t and t t then there exists t st t t and t t note that this is just a particular case of axiom so where the diagram can be closed by using just one reduction step from ti to t indirect action the box order fails to capture indirect action in the sense that a b implies that a cannot directly act on b but it can still indirectly act on it and for example in the following derivation a b and a creates a redex that can act on b ls this odd is not specific to the box order will not the standardization theorem its consequences and an easy way to deal with them will be discussed in section note that by definition the box order is the minimum standardization order in the sense that it is the transitive closure of the relation capturing direct action only the order on terms in pp considers three orders on terms the lefttoright order plus two refinements called the tree and the argument order when restricted to terms our order coincides with the argument order linear logic interpretation we explained that there are two kinds of nesting in lsub namely subterm nesting and nesting at a distance in the definition of the box order they are both captured by the notion of immediately boxes in terms of however they have different interpretations despite they are both related to the concept of exponential box standardization up to square equivalence a consequence of switching to partial orders is that the notion of standard derivation has to be refined in fact partial orders force to work modulo the of disjoint redexes even to simply define what is an ordered ie standard sequence this is why abstract standardization is a form of rewriting modulo permutations are defined as in section however to deal with disjoint redexes and represent their a subterm b when b is contained in the box of a while a b at a distance when the cut corresponding to b an auxiliary conclusion of the box of a c a c cs xs b t c xx d xyz xx figure some standardization diagrams parallelism induced by the partial order a new concept is necessary a derivation d is said to be obtained from a derivation e by square permutation written de if d f a b g and e f b a g and a b where a b a and b a b we write for the relation generated by and call it square equivalence we use for the relation modulo and we generalize the permutation equivalence relation as a derivation d is standard if it is a normal form modulo the standardization theorem thm in then follows theorem abstract partial standardization consider any equipped with a partial order that the basic and the standardization axioms then for every derivation d there exists a standard derivation e st d e results our goal is to prove a standardization theorem for lsub relative to b the proof consists in first obtaining the theorem for lsub and then lifting it to lsub the basic axioms do not mention the order and thus they still hold for lsub the standardization axioms are proved by the fol proposition proposition the with the box order b satisfies linearity and proof linearity is easy by just that a redex b can be duplicated or erased by a only if its is in the box of a case in which a b b requires a detailed study of the interaction between the box order b and the reduction relation in particular the proof is involved due to the transitive clause defining the box order and it is omitted for lack of space then the previous proposition and theorem give corollary box standardization for lsub if t then there exists a from t to u in order to lift the previous result to lsub we use the results on equivalence classes developed in section proposition the with the box order b satisfies the basic and the standardization axioms proof by lemma and lemma the notion of residual and the box order lift to equivalence classes preserving their properties moreover the fd axiom can be shown exactly as done for lsub in proposition by means of a measure that strictly decreases with every reduction step and remains equal for every pair of equivalent pairs therefore all axioms hold for lsub and we can conclude proposition allows to apply theorem again and finally obtain our nonstandard equational standardization theorem corollary box standardization for lsub if t then there is a from t to u the next section will the result by showing uniqueness modulo of the obtained standard derivation we conclude this section with a remark lsub lsub lsub redex order total lefttoright sec partial box sec partial box sec existence thm cor cor uniqueness thm thm thm figure summary of results on standardization variation on the axiom we use in this paper as it appears in thesis in theory however the axiom appears in a stronger symmetric form which does not hold for lsub indeed · strong let a b c be redexes st b a b and c a c if a c then b c b c and c b c b consider t xy where a c c b and a b b the reduction step of the redex a yields the term y where c b b the strong form of the axiom but not the weaker one we use and providing an example of the second kind of indirect action as a changes who can act on the residual of b uniqueness the standardization results obtained up to now concern the existence of a standard derivation in this section the theorems are by proving uniqueness of such derivations we first discuss the simple case of the lefttoright order and then provide an original proof of uniqueness modulo for the box order the axiomatic theory in thesis provides uniqueness of standard derivations when two further axioms and stability hold theorem in axiom has two parts let a b b be redexes st b a b creation if b a and a creates a redex c then b c nesting let c c be redexes if b a c and c a c then b c in terms of the action principle yet another form of indirect action if b can directly act on a then a cannot indirectly act on b consider the creation part if c b or c b then c may act on b and so a would indirectly act on b similarly for the nesting part proposition the with the lefttoright order l satisfies proof creation a simple inspection of the cases of creation section shows that a redex a can create a redex c only on its right or at most where it was so that c cannot nest any redex that was on the left of a nesting similarly it is easily seen that a can only move redexes on its right and at most where it was in the case of a total standardization order the axiom stability because its statement see assumes two disjoint redexes thus by applying theorem we obtain theorem uniqueness for lsub if t lsub u then there exists a unique from t to u switching to partial orders uniqueness is necessarily relaxed to uniqueness modulo as standard derivations are defined up to interestingly for the partial box order both points of fail for lsub for creation consider the step s z u u t let us call a and b the two labeled redexes in s and b resp c the residual of b resp the created on z in t we have b b a but b b c for nesting it is enough to consider a redex c inside u in the counterexample for creation so the box order does not capture the indirect action expressed by and cannot provide uniqueness modulo for lsub however we can obtain it via another argument in particular our alternative proof shows that together with stability is a sufficient but by no means necessary condition for uniqueness we first show uniqueness modulo for lsub and then lift this result to lsub theorem uniqueness modulo for lsub if t lsub u then there exists a from t to u that is unique modulo proof sketch let e be the given by corollary and f be the unique derivation given by corollary we prove that ef from which the statement follows consider the leftmost redex c in e b bn ie the leftmost redex in a a b bi bi i n and let e be c e e where e b bi c and c b bi bi and e bi bn it is not difficult to prove given that e is that e e e i and so e e e where e denotes the number of steps in e by induction hypothesis we obtain a derivation f st f e e therefore c f is also and moreover c f c e ee thm implies c f f note that the proof does not depend concretely on lsub but only on the fact that b can be embedded in a total order a standardization theorem which is a fully abstract argument by exploiting again the results on equivalence classes we obtain the strongest result of the paper theorem uniqueness modulo for lsub if t there exists a from t lsub to u u then that is unique modulo proof by lemma and theorem using the stability of the by the equivalence given by lemma external redexes when the nesting order is total standardization is relatively easy because a derivation d t u may be by simply selecting the minimum redex a among the redexes in t that are reduced in d and then the process for the residual of this derivation after a however when the order is our box order and more generally in approach there may be many minimal redexes among the redexes in t that are reduced in d and randomly selecting one of them does not necessarily produce a standard derivation this is due to the fact that the partial box it is usually the case with partial to properly capture indirect action indeed even if two minimal redexes a and b are necessarily disjoint a may create a redex which will nest a residual of b we illustrate this situation in the simpler setting of the calculus using the box order called argument order by in let i stand for xx and a for i i and similarly for b consider the derivation i i i i i i i i i i note that both a and b are minimal in the initial term and the derivation at every step a minimal redex however the derivation d is not standard this can be seen by a and b which yields the following equivalent derivation where the two last steps form an inversion for the box order i i i i i i i i i i a permutation them produces the following standard derivation i i i i i i i i i i this example shows that selecting redexes does not necessarily give standard derivations when the order is partial a similar example in lsub is obtained by considering the derivations of x the solution to this problem is to select an external redex ie a minimal one on which no other redex can indirectly act the definition of external redex for a derivation in theory is given via an extraction process in particular the definition the nesting order only indirectly alternatively external redexes can be defined as minimal redexes as in ie the minimal redexes whose unique residual after any other redex is still minimal we first recall the definition of external redex from that requires two preliminary definitions a redex a traverses a derivation d b written a d b iff · for d a b iff b a · for d c e a ce b iff c a c a a and a e b where a redex a in t can be extracted from a derivation d t u written a d if there exist d d st d d a d and a d a a redex a in t is external for d t u if a b e d b e the following result corresponds to lemma in lemma external gives standard consider any equipped with a partial order that the basic and the standardization axioms if d a an and ai an i n then d is standard external redexes generalize leftmost redexes in calculus whose key properties are no other redex can act on it and its unique residual after any other redex is still the leftmost redex this suggests to define external redexes as follows let d t u be a derivation the set of starting redexes of d is d b e st d b e a redex a in t is external for d if d is not empty and a is minimal in d and whenever d b e and a b a a is unique by then a is external in e the next two technical lemmas are used to relate the two notions of their proofs are easy lemma let a be external for d then a d and if e d then e d and a is external for e lemma let a d ie d e a f and a e a then there exists g st d a g if d b d with b a then b a d a and if a b a then we conclude the section with the equivalence of the two notions of external redex proposition a is external for d iff a proof let e d lemma implies that a is external for e and lemma gives a e ie a by coinduction on the definition of external a implies a d so that lemma gives a d let b d so that d b e and a b e if b a then lemma gives b a that implies a minimal in d and a e if a b a thus a by the coinductive hypothesis a is external for e and thus a is external for d applications in this section we apply the new characterization of external redexes to obtain a normalization theorem and to prove that weak linear head reduction is standard a normalizing strategy for lsub and lsub using the coinductive of external redexes we can now provide an easy proof that the leftmost strategy which always reduces the leftmost redex is normalizing for lsub and lsub ie it reaches a normal form if any let us say that a redex a is universally external ie external with respect to any reduction step and thus wrt any derivation when the following holds universal a is minimal in universal for any b if a b a then a is universally external theorem normalization the leftmost redex is universally lsub the leftmost strategy is normalizing for lsub and lsub proof by coinduction lefttoright order the leftmost redex is and by the axiom for l proposition its residual after any other redex is still minimum and thus leftmost we conclude using the coinductive hypothesis for lsub it follows by theorem in thesis p abstractly an argument by huet and stating that any strategy reducing redexes is normalizing for lsub let t be a term having an form since can be lemma and it is the identity on normal forms then t has also a normal form in lsub the leftmost strategy lsub t since t lsub lsub then the leftmost strategy also weak linear head reduction is standard the leftmost strategy captures a relevant strategy in the theory of linear logic the weak ie not under abstractions variant of linear head reduction to introduce such a notion let us first define weak head contexts by the grammar w w t w xt weak linear head reduction w is defined as the closure under weak head contexts of the rewriting rules db where is the following variation on ls w w alternatively w can be defined as the rewriting relation reducing only the db whose is in a weak head context this notion of reduction is deterministic and related to the calculus and abstract machine proposition weak linear head reduction is standard every term t t has at most one w redex and if it does then it is the leftmost redex of t w derivations are and thus also proof by induction on t by lemma and theorem linear head reduction is standard the head strategy for lsub as a special strategy given the behavioral equivalence between lsub and it can be easily expressed in our setting for that let us introduce the set of head contexts that are generated by the grammar h h t linear head reduction h is defined as the closure under head contexts of the rewriting rules db where is the following variation of the rewriting rule ls alternatively h can be defined as the rewriting relation reducing only the db whose is inside a head context linear head reduction has been defined on ordinary terms ie without explicit substitutions by using a notion of virtual redex equivalent to a up to equivalence the alternative approach used here already in use in improves the original presentation in several aspects there is no need to work with virtual redexes there is a correspondence between in and in lsub and can be seen as a strategy of lsub although it is not a strategy of reduction moreover this presentation of admits a theorem and can be easily generalized to take place inside arguments of terms linear head reduction is another motivation for considering the partial box order on redexes as we now explain a crucial point of our definition is that that h in contrast to w is nondeterministic for instance we have both h and h this fact is not a rather a plus as it the parallelism of in a simple case analysis shows that the property ie any two steps commute and no is involved therefore the nondeterminism is in particular all maximal derivations if any have the same length concerning standardization however not all derivations are standard with respect to the lefttoright order l consider h h this fact is because the nondeterminism of is only apparent and so one would like to consider sequences as standard without having to them the box order turns into a standard strategy giving to the presentation of with explicit substitutions a status theorem linear head reduction is standard linear head redexes are universally linear head reduction is proof by coinduction on the definition of universally external universal the of h redexes is out of all boxes so they can never be nested by another redex universal it is easily seen that no redex can move the of a h redex inside a box so the residual of a h redex is a h redex and we conclude by the coinductive hypothesis a the one reducing only out of all boxes that do not involve the auxiliary conclusion of any box universally external redex is easily seen to be external for every derivation then we conclude applying lemma conclusions we study standardization for the linear substitution calculus a calculus with explicit substitutions that is not syntactically orthogonal and that it is equipped with an equational theory that makes it isomorphic to linear logic our main result is a standardization theorem nonstandard because it is based on a partial rather than a total order it to equivalence classes ie and it provides a notion of standard derivation which from the one by levels in the linear logic literature along the way we provided other results a theory of residuals lifting to equivalence classes a simple lefttoright standardization theorem a coinductive characterization of the notion of external redex a normalization theorem a simple proof that weak linear head reduction is standard last we believe that a further contribution of this paper is the fine analysis of and axiomatic framework which gives new on their complex notions acknowledgments we are to for discussions this work was partially by the laboratory in computer science and by the national research under grant references m abadi l cardelli p l curien and jj explicit substitutions journal of functional programming ­ b an abstract theorem for explicit substitutions in pages ­ b evaluating functions as processes in pages ­ b around the box graphical and operational studies on calculus and linear logic phd thesis la university of february b and u on the invariance of the unitary cost model for head reduction in pages ­ b and d the structural calculus in csl pages ­ b p and d abstract machines submitted h p barendregt r j w and m r sleep needed reduction and spine strategies for the lambda calculus information and computation ­ r and k preservation of strong normalization in named lambda calculi with explicit substitution and garbage collection in computing science in the pages ­ computer science research foundation g computational semantics of term rewriting systems in algebraic methods in semantics pages ­ cambridge university press h s equivalence of reductions in higherorder rewriting phd thesis university d and r some properties of term graph rewriting systems in volume of pages ­ h curry and r combinatory logic number vol in studies in logic and the foundations of mathematics northholland v and l head linear reduction http v h and l game semantics abstract machines in lics pages ­ d de m and l de a semantic measure of the execution time in linear logic theor comput sci ­ t and l trees machine and the taylor expansion of in pages ­ jy girard linear logic theoretical computer science ­ g jj and pa an abstract theorem in lics pages ­ g huet residual theory in calculus a formal development journal of functional programming ­ g huet and jj computations in orthogonal rewriting systems i and ii in computational logic in of alan pages ­ g huet and jj call by need computations in linear term rewriting systems technical report inria d and s resource operators for lambdacalculus information and computation ­ d and s milners lambda calculus with partial substitutions z and j r w discrete normalization and standardization in deterministic residual structures in pages ­ j w combinatory reduction systems phd thesis university jj et le univ paris vii france l optimal derivations in weak and in orthogonal terms rewriting systems in popl pages ­ g and m head linear reduction and pure proof net extraction theoretical computer science ­ pa axiomatic rewriting theory i a standardization theorem in processes terms and cycles steps on the to volume of lncs pages ­ springer pa axiomatic rewriting theory vi residual theory in pages ­ pa description de de phd thesis paris university r milner local bigraphs and confluence two ­ l and s parametric parameter passing lambdacalculus information and computation ­ g d plotkin callbyname callbyvalue and the lambdacalculus theoretical computer science ­ l theoretical computer science ­ m parallel reductions in calculus inf comput ­ term rewriting systems volume of cambridge in theoretical computer science cambridge university press v van in weakly orthogonal rewriting in pages ­ v van and r c de four equivalent equivalences of reductions ­ h xi upper bounds for and an application journal of symbolic logic ­ 